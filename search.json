[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Patrones filogen√©ticos: macroevoluci√≥n y adaptaci√≥n",
    "section": "",
    "text": "Presentaci√≥n del Curso: Patrones Filogen√©ticos, Macroevoluci√≥n y Adaptaci√≥n\nHaz clic en la imagen para ver el PDF de la presentaci√≥n del curso",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "index.html#unidad-1-patrones-de-diversificaci√≥n",
    "href": "index.html#unidad-1-patrones-de-diversificaci√≥n",
    "title": "Patrones filogen√©ticos: macroevoluci√≥n y adaptaci√≥n",
    "section": "Unidad 1: Patrones de diversificaci√≥n",
    "text": "Unidad 1: Patrones de diversificaci√≥n\n\nIntroducci√≥n al proceso de diversificaci√≥n parte 1\nIntroducci√≥n al proceso de diversificaci√≥n parte 2",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "chapters/install.html",
    "href": "chapters/install.html",
    "title": "Instalaci√≥n de Software",
    "section": "",
    "text": "Introducci√≥n\nEste es el manual para la instalaci√≥n de los programas que se utilizar√°n durante el curso Patrones filogen√©ticos: macroevoluci√≥n y adaptaci√≥n. Los programas seleccionados son herramientas esenciales para el desarrollo de an√°lisis y actividades dentro del curso.\nLos programas a instalar incluyen:\nA continuaci√≥n, se presentan las instrucciones detalladas para instalar y configurar cada uno de estos programas, asegurando que los participantes cuenten con todas las herramientas necesarias para aprovechar al m√°ximo el curso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n",
    "href": "chapters/install.html#descripci√≥n",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nVisual Studio Code (VS Code) es un editor de c√≥digo fuente ligero pero potente, desarrollado por Microsoft. Es compatible con varios lenguajes de programaci√≥n y ofrece caracter√≠sticas como autocompletado de c√≥digo, depuraci√≥n integrada, control de versiones con Git y una amplia variedad de extensiones que permiten personalizar y ampliar su funcionalidad.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalaci√≥n",
    "href": "chapters/install.html#pasos-de-instalaci√≥n",
    "title": "Instalaci√≥n de Software",
    "section": "Pasos de instalaci√≥n",
    "text": "Pasos de instalaci√≥n\n\nDescargar el instalador:\n\nVe al sitio oficial de Visual Studio Code: https://code.visualstudio.com/.\nHaz clic en el bot√≥n para descargar el archivo ejecutable.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado (por lo general, estar√° en la carpeta Descargas).\nHaz doble clic en el archivo para iniciar el asistente de instalaci√≥n.\n\nConfigurar las opciones de instalaci√≥n:\n\nAcepta los t√©rminos y condiciones.\nElige una carpeta de instalaci√≥n o deja la predeterminada.\nSelecciona las opciones adicionales como:\n\nCrear un √≠cono en el escritorio.\nAgregar ‚ÄúCode‚Äù al men√∫ contextual para abrir archivos y carpetas.\nRegistrar el programa como editor por defecto de ciertos archivos.\n\n\nCompletar la instalaci√≥n:\n\nHaz clic en ‚ÄúInstalar‚Äù.\nEspera a que el proceso finalice y haz clic en ‚ÄúFinalizar‚Äù para abrir Visual Studio Code.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n-1",
    "href": "chapters/install.html#descripci√≥n-1",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nR es un lenguaje de programaci√≥n y software para el an√°lisis estad√≠stico y la visualizaci√≥n de datos. RStudio es un entorno de desarrollo integrado (IDE) que facilita trabajar con R gracias a su interfaz amigable y herramientas adicionales como depuraci√≥n de c√≥digo, manejo de proyectos y soporte para Markdown.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalaci√≥n-1",
    "href": "chapters/install.html#pasos-de-instalaci√≥n-1",
    "title": "Instalaci√≥n de Software",
    "section": "Pasos de instalaci√≥n",
    "text": "Pasos de instalaci√≥n\n\nInstalaci√≥n de R\n\nDescargar el instalador:\n\nVe al sitio oficial de CRAN: https://cran.r-project.org/.\nSelecciona ‚ÄúDownload R for Windows‚Äù y luego ‚Äúbase‚Äù.\nHaz clic en el enlace para descargar el instalador m√°s reciente.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente, aceptando los valores predeterminados a menos que necesites personalizar la instalaci√≥n.\n\nCompletar la instalaci√≥n:\n\nHaz clic en ‚ÄúFinalizar‚Äù al terminar el proceso.\n\n\n\n\nInstalaci√≥n de RStudio\n\nDescargar el instalador:\n\nVe al sitio oficial de RStudio: https://posit.co/download/rstudio-desktop/.\nDescarga la versi√≥n gratuita de RStudio Desktop.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente de instalaci√≥n.\n\nCompletar la instalaci√≥n:\n\nHaz clic en ‚ÄúFinalizar‚Äù al terminar el proceso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n-2",
    "href": "chapters/install.html#descripci√≥n-2",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nRevBayes es un software dise√±ado para realizar an√°lisis filogen√©ticos avanzados utilizando m√©todos bayesianos. Ofrece flexibilidad para modelar procesos evolutivos complejos y es ampliamente utilizado en investigaciones de filogen√©tica y macroevoluci√≥n.\nPara instalar RevBayes en Windows, utilizaremos Ubuntu mediante Windows Subsystem for Linux (WSL).",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-la-virtualizaci√≥n-est√°-habilitada",
    "href": "chapters/install.html#verificar-si-la-virtualizaci√≥n-est√°-habilitada",
    "title": "Instalaci√≥n de Software",
    "section": "1. Verificar si la virtualizaci√≥n est√° habilitada",
    "text": "1. Verificar si la virtualizaci√≥n est√° habilitada\n\nAbrir el Administrador de Tareas:\n\nPresiona Ctrl + Shift + Esc para abrir el Administrador de Tareas.\nVe a la pesta√±a Rendimiento y selecciona CPU.\nEn la esquina inferior derecha, verifica si la opci√≥n ‚ÄúVirtualizaci√≥n‚Äù est√° habilitada.\n\n\n\n\n\n\nHabilitar la virtualizaci√≥n (si est√° deshabilitada):\n\nReinicia tu computadora y accede al BIOS/UEFI.\nPara procesadores Intel, busca una opci√≥n como ‚ÄúIntel Virtualization Technology‚Äù o ‚ÄúVT-x‚Äù y act√≠vala.\nPara procesadores AMD, busca ‚ÄúSVM Mode‚Äù o una opci√≥n similar y act√≠vala.\nGuarda los cambios y reinicia.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-wsl-est√°-instalado-y-actualizado",
    "href": "chapters/install.html#verificar-si-wsl-est√°-instalado-y-actualizado",
    "title": "Instalaci√≥n de Software",
    "section": "2. Verificar si WSL est√° instalado y actualizado",
    "text": "2. Verificar si WSL est√° instalado y actualizado\n\nAbrir PowerShell como administrador\n\nPresiona Win + X y selecciona ‚ÄúWindows PowerShell (Admin)‚Äù.\nEjecuta el siguiente comando para verificar si WSL est√° instalado y funcionando:\nwsl --status\nSi el comando muestra un error o indica que WSL no est√° disponible, sigue el Paso 3 para instalarlo desde cero.\nSi WSL ya est√° habilitado, pasa al Paso 4 para actualizarlo y asegurarte de que est√© en la versi√≥n 2.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-wsl-desde-cero-si-no-est√°-disponible",
    "href": "chapters/install.html#instalar-wsl-desde-cero-si-no-est√°-disponible",
    "title": "Instalaci√≥n de Software",
    "section": "3. Instalar WSL desde cero (si no est√° disponible)",
    "text": "3. Instalar WSL desde cero (si no est√° disponible)\nSi wsl --status muestra un error, sigue estos pasos para habilitar WSL desde cero:\n\nAbrir PowerShell como administrador y ejecutar los siguientes comandos:\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\nReiniciar la computadora para aplicar los cambios.\nVerificar la instalaci√≥n:\n\nEjecuta nuevamente:\nwsl --status\nSi el comando muestra que WSL est√° instalado correctamente puedes proceder con el paso 4.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#actualizar-wsl-y-establecer-la-versi√≥n-por-defecto",
    "href": "chapters/install.html#actualizar-wsl-y-establecer-la-versi√≥n-por-defecto",
    "title": "Instalaci√≥n de Software",
    "section": "4. Actualizar WSL y establecer la versi√≥n por defecto",
    "text": "4. Actualizar WSL y establecer la versi√≥n por defecto\nSi WSL ya estaba habilitado, sigue estos pasos para actualizarlo y asegurarte de que est√© en la versi√≥n 2:\n\nActualizar el kernel de WSL 2 (en caso de que se necesite)\n\nDescarga la actualizaci√≥n oficial desde Microsoft: Descargar actualizaci√≥n de WSL-2\nGuarda el archivo wsl_update_x64.msi en tu computadora.\nEjecuta el archivo descargado y sigue las instrucciones de instalaci√≥n.\nUna vez instalado, reinicia tu computadora.\n\nConfigurar WSL para usar la versi√≥n 2\n\nAbre PowerShell como administrador y ejecuta:\nwsl --set-default-version 2\nEsto asegurar√° que todas las distribuciones nuevas de Linux usen WSL 2 por defecto.\n\nInstalaci√≥n de Ubuntu:\n\nUna vez reiniciado el equipo, abre PowerShell como administrador y ejecuta:\nwsl --install -d Ubuntu\nEsto instalar√° autom√°ticamente WSL2 y descargar√° la distribuci√≥n de Ubuntu m√°s reciente,\nEn caso de que no se instale, descarga Ubuntu (se recomienda la versi√≥n 22.04) desde la aplicaci√≥n de Microsoft Store e inst√°lala manualmente.\n\nEstablecer el usuario por defecto en WSL\n\nAseg√∫rate de que WSL est√© configurado para que siempre uses tu usuario por defecto y no root:\nwsl -d Ubuntu --user tu_usuario\nSi no recuerdas que verion de Ubuntu tines instalada, usa:\nwsl -l -v\nSi no recuerdas tu usuario en WSL, usa:\nwhoami\n\nConfigurar Ubuntu:\n\nAbre Ubuntu desde el men√∫ de inicio.\nCrea un nombre de usuario y contrase√±a cuando se te solicite.\n\n\n\n\n\n\nAcceder a la carpeta de usuario de Windows:\n\nVerifica si la ruta existe:\n\nls \"/mnt/c/Users/\"\n\nVerifica tu nombre de usuario:\n\nls \"/mnt/c/Users/mi_usuario\"\n\nCrear un alias en ~/.bashrc:\n\nnano ~/.bashrc\n\nAgrega esta l√≠nea al final del archivo:\n\nalias homepatron='cd \"/mnt/c/Users/mi_usuario\"'\n\nGuarda (CTRL + X, luego Y y Enter) y actualiza:\n\nsource ~/.bashrc\n\nAhora podr√°s ejecutar:\n\nhomepatron",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "href": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "title": "Instalaci√≥n de Software",
    "section": "Instalar RevBayes en Ubuntu",
    "text": "Instalar RevBayes en Ubuntu\n\nActualizar paquetes:\n\nEjecuta:\nsudo apt update && sudo apt upgrade -y\n\nDescargar RevBayes:\n\nUsa el siguiente comando para descargar la versi√≥n 1.2.5:\nwget https://github.com/revbayes/revbayes/releases/download/v1.2.5/revbayes-v1.2.5-linux64.tar.gz\n\nInstalar RevBayes:\n\nExtrae el archivo descargado y navega a la carpeta:\ntar -xzf revbayes-v1.2.5-linux64.tar.gz\ncd revbayes-v1.2.5/bin\nHaz que el ejecutable sea ejecutable:\nchmod +x rb\n\nAgregar RevBayes al PATH:\n\nPara que rb est√© disponible en cualquier sesi√≥n de Ubuntu, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/revbayes-v1.2.5/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto permitir√° ejecutar rb desde cualquier directorio en futuras sesiones de terminal.\n\nVerificar la instalaci√≥n:\n\nEjecuta el programa:\nrb\nDeber√≠as ver la interfaz de l√≠nea de comandos de RevBayes.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n-3",
    "href": "chapters/install.html#descripci√≥n-3",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nBAMM es un software dise√±ado para analizar tasas de diversificaci√≥n y evoluci√≥n de rasgos en filogenias de gran tama√±o. Utiliza m√©todos bayesianos para estimar patrones heterog√©neos de evoluci√≥n y es ampliamente utilizado en estudios de macroevoluci√≥n.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalaci√≥n-de-bamm-en-ubuntu-wsl-o-nativo",
    "href": "chapters/install.html#instalaci√≥n-de-bamm-en-ubuntu-wsl-o-nativo",
    "title": "Instalaci√≥n de Software",
    "section": "Instalaci√≥n de BAMM en Ubuntu (WSL o nativo)",
    "text": "Instalaci√≥n de BAMM en Ubuntu (WSL o nativo)\n\nActualizar el sistema y dependencias:\n\nEjecuta los siguientes comandos para asegurarte de que el sistema est√© actualizado y las dependencias necesarias est√©n instaladas:\nsudo apt update && sudo apt upgrade -y\nsudo apt install git build-essential cmake libgsl-dev -y\n\nClonar el repositorio de BAMM:\n\nClona el repositorio oficial de BAMM desde GitHub:\ngit clone https://github.com/macroevolution/bamm.git\n\nCrear el directorio de compilaci√≥n:\n\nNavega al directorio ra√≠z del proyecto, crea un directorio llamado build y accede a √©l:\ncd bamm\nmkdir build\ncd build\n\nCompilar BAMM:\n\nEjecuta los siguientes comandos para compilar BAMM:\ncmake ..\nmake -j\nEl ejecutable final se generar√° con el nombre bamm dentro del directorio build.\n\nAgregar BAMM al PATH:\n\nPara que el ejecutable bamm est√© disponible desde cualquier directorio, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/bamm/build:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto asegurar√° que puedas ejecutar bamm desde cualquier lugar en futuras sesiones.\n\nVerificar la instalaci√≥n:\n\nAseg√∫rate de que BAMM est√© correctamente instalado ejecutando:\nbamm -h\nDeber√≠as ver la pantalla de ayuda de BAMM.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html",
    "href": "chapters/commandline.html",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "",
    "text": "Comandos b√°sicos en Bash",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#navegaci√≥n-en-el-sistema-de-archivos",
    "href": "chapters/commandline.html#navegaci√≥n-en-el-sistema-de-archivos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "1. Navegaci√≥n en el sistema de archivos",
    "text": "1. Navegaci√≥n en el sistema de archivos\n\n\n\n\n\n\npwd ‚Üí Muestra el directorio actual.\npwd\nls ‚Üí Lista los archivos y carpetas en el directorio actual.\nls -l     # Muestra detalles (permisos, due√±o, tama√±o, fecha)\nls -a     # Muestra archivos ocultos\nls -h     # Muestra tama√±os en formato legible \ncd ‚Üí Cambia de directorio.\ncd /   # Ir a la raiz\ncd /home/usuario/proyecto/data # ir a la carpeta data ruta absoluta\ncd data/ # ir a la carpeta data ruta relativa\ncd ..      # Subir un nivel",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#manipulaci√≥n-de-archivos-y-directorios",
    "href": "chapters/commandline.html#manipulaci√≥n-de-archivos-y-directorios",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "2. Manipulaci√≥n de archivos y directorios",
    "text": "2. Manipulaci√≥n de archivos y directorios\n\nmkdir ‚Üí Crea un directorio.\nmkdir nueva_carpeta\nrm ‚Üí Borra archivos y carpetas.\nrm archivo.txt        # Borra un archivo\nrm -r carpeta         # Borra una carpeta y su contenido\nrm -i archivo.txt     # Pregunta antes de borrar\ncp ‚Üí Copia archivos o carpetas.\ncp archivo.txt copia.txt   # Copia un archivo\ncp -r carpeta destino/     # Copia una carpeta\nmv ‚Üí Mueve o renombra archivos y carpetas.\nmv archivo.txt nueva_ubicacion/\nmv archivo.txt nuevo_nombre.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#visualizaci√≥n-y-edici√≥n-de-archivos",
    "href": "chapters/commandline.html#visualizaci√≥n-y-edici√≥n-de-archivos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "3. Visualizaci√≥n y edici√≥n de archivos",
    "text": "3. Visualizaci√≥n y edici√≥n de archivos\n\ncat ‚Üí Muestra el contenido de un archivo.\ncat archivo.txt\nless ‚Üí Permite visualizar archivos grandes de manera interactiva.\nless archivo.txt   # Usa las teclas ‚Üë ‚Üì para moverte, \"q\" para salir\nnano ‚Üí Editor de texto en terminal.\nnano archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#limpiar-la-terminal",
    "href": "chapters/commandline.html#limpiar-la-terminal",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "4. Limpiar la terminal",
    "text": "4. Limpiar la terminal\n\nclear ‚Üí Borra la pantalla de la terminal, pero no elimina procesos ni historial.\nclear\nCtrl + L ‚Üí Hace lo mismo que clear, pero sin ejecutar un comando expl√≠cito.\n\nEn macOS: Cmd + K tambi√©n limpia la terminal.",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#historial-de-comandos",
    "href": "chapters/commandline.html#historial-de-comandos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "5. Historial de comandos",
    "text": "5. Historial de comandos\n\nC√≥mo moverse en el historial\n\n‚Üë (Flecha arriba) ‚Üí Muestra el √∫ltimo comando ejecutado.\n‚Üì (Flecha abajo) ‚Üí Avanza en la lista de comandos previos.\nCtrl + R ‚Üí B√∫squeda r√°pida en el historial. Escribe parte del comando y pulsa Enter cuando encuentres el que necesitas.\n\nEjemplo: Presiona Ctrl + R y escribe nano, mostrar√° el √∫ltimo comando que usaste con nano.\n\n\nhistory ‚Üí Muestra los √∫ltimos comandos ejecutados.\nhistory\nBuscar en el historial r√°pidamente con grep\nhistory | grep ls   # Filtra los comandos que contienen \"ls\"\nhistory | grep nano # Filtra los comandos con \"nano\"",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "href": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "6. Permisos y propiedades de archivos",
    "text": "6. Permisos y propiedades de archivos\n\nchmod ‚Üí Cambia permisos de ejecucion.\nchmod +x script.Rev  # Permisos de ejecuci√≥n\nchown ‚Üí Cambia el due√±o de un archivo.\nsudo chown usuario archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "href": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "Iniciar Ubuntu en la terminal de VS Code.",
    "text": "Iniciar Ubuntu en la terminal de VS Code.\n\nAbre VS Code y ve a Extensions (Ctrl + Shift + X)\n\n\n\n\n\nBusca WSL e instala la extensi√≥n oficial de Microsoft.\n\n\n\n\n\nTeclea el comando Ctrl + Shift + P y selecciona WSL: Connect to WSL\n\n\n\n\n\nSe abrir√° una nueva ventana, ve a **Terminal** y selecciona una nueva **Terminal**\n\n\n\n\n\nEn la parte inferior se abrir√° la terminal de Ubuntu",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html",
    "href": "chapters/Rstudio.html",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "¬øQu√© es R y qu√© es RStudio?",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#qu√©-es-r-y-qu√©-es-rstudio",
    "href": "chapters/Rstudio.html#qu√©-es-r-y-qu√©-es-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "R es un lenguaje de programaci√≥n enfocado en el an√°lisis de datos y estad√≠sticas.\nRStudio es un entorno de desarrollo integrado (IDE) que facilita el trabajo con R y permite organiza los proyectos y facilita la ejecuci√≥n de c√≥digo, la visualizaci√≥n de gr√°ficos y la gesti√≥n de paquetes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#partes-de-rstudio",
    "href": "chapters/Rstudio.html#partes-de-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Partes de RStudio",
    "text": "Partes de RStudio\nRStudio tiene cuatro paneles principales:\n\nConsole: Donde se ejecuta el c√≥digo en tiempo real.\n\n\n\n\n\nEditor de scripts: Para escribir y guardar c√≥digo en archivos .r, .R o .Rmd.\n\n\n\n\n\nEnvironment/History: Muestra variables y comandos previos.\n\n\n\n\n\nFiles/Plots/Packages/Help: Para manejar archivos, visualizar gr√°ficos, instalar programas y acceder a documentaci√≥n.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#creaci√≥n-de-un-proyecto-en-rstudio",
    "href": "chapters/Rstudio.html#creaci√≥n-de-un-proyecto-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Creaci√≥n de un Proyecto en RStudio",
    "text": "Creaci√≥n de un Proyecto en RStudio\nBeneficios de trabajar con proyectos:\n\nOrganizaci√≥n de archivos y c√≥digo.\nFacilita la reproducibilidad.\nEvita problemas con rutas de archivos.\n\nPara crear un proyecto:\n\nEn RStudio, ir a File &gt; New Project.\n\n\n\n\n\nElegir un directorio nuevo o existente.\n\n\n\n\n\nTrabajar siempre dentro del proyecto para evitar problemas de rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#organizaci√≥n-de-proyectos-en-rstudio",
    "href": "chapters/Rstudio.html#organizaci√≥n-de-proyectos-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Organizaci√≥n de Proyectos en RStudio",
    "text": "Organizaci√≥n de Proyectos en RStudio\nMantener una estructura organizada en los proyectos es clave para la reproducibilidad y eficiencia. Se recomienda la siguiente estructura de carpetas:\nproyecto/\n‚îÇ‚îÄ‚îÄ data/         # Datos crudos y procesados\n‚îÇ‚îÄ‚îÄ scripts/      # C√≥digo fuente en R\n‚îÇ‚îÄ‚îÄ output/       # Resultados y gr√°ficos\n‚îÇ‚îÄ‚îÄ reports/      # Documentaci√≥n y reportes\n‚îÇ‚îÄ‚îÄ README.md     # Descripci√≥n del proyecto\nAdem√°s, para lograr una nomenclatura eficiente y consistente en archivos, se pueden seguir algunas pautas:\n\nConsistencia: Usar un esquema de nombres consistente en todo el proyecto.\nEvitar Espacios: Usar guiones bajos (_) o guiones (-) en lugar de espacios.\nPrefijos y Sufijos: Usar prefijos y sufijos estandarizados para identificar el estado o versi√≥n del archivo.\nEvitar Acentos y Caracteres Especiales: No utilizar acentos, e√±es ni caracteres especiales que puedan causar problemas de compatibilidad en diferentes sistemas operativos o herramientas de software.\n\nEjemplos:\nbears_cytb.nex\ntree_BD.Rev\nmultifig.R\nqw_feature2.csv",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "href": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Rutas Absolutas y Relativas",
    "text": "Rutas Absolutas y Relativas\nLas rutas de archivos en R pueden ser absolutas o relativas:\n\nRuta absoluta: Define la ubicaci√≥n exacta de un archivo, por ejemplo:\nread.csv(\"C:/Users/TuUsuario/Documents/data/datos.csv\")\nRuta relativa: Se basa en la ubicaci√≥n del proyecto:\nread.csv(\"data/datos.csv\")\n\nSiempre es recomendable usar proyectos para evitar errores con rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#principales-objetos-en-r",
    "href": "chapters/Rstudio.html#principales-objetos-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Principales Objetos en R",
    "text": "Principales Objetos en R\n\nVectores\nx &lt;- c(1, 2, 3, 4, 5)\nprint(x)\n\n\nMatrices\nm &lt;- matrix(1:9, nrow=3)\nprint(m)\n\n\nData Frames\ndf &lt;- data.frame(Nombre=c(\"A\", \"B\", \"C\"), Edad=c(25, 30, 22))\nprint(df)\n\n\nListas\nlista &lt;- list(Nombre=\"Juan\", Edad=30, Notas=c(8, 9, 10))\nprint(lista)",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#asignaci√≥n-de-variables",
    "href": "chapters/Rstudio.html#asignaci√≥n-de-variables",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Asignaci√≥n de Variables",
    "text": "Asignaci√≥n de Variables\nDiferencia entre &lt;- y =:\na &lt;- 10   # Recomendado para asignaciones\nb = 20    # Tambi√©n funciona, pero es mejor evitarlo",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "href": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Uso de Funciones en R",
    "text": "Uso de Funciones en R\nEjemplo de funciones b√°sicas:\nnumeros &lt;- c(1, 2, 3, 4, 5)\nmean(numeros)  # Media\nsummary(numeros)  # Resumen estad√≠stico",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#instalaci√≥n-y-uso-de-paquetes",
    "href": "chapters/Rstudio.html#instalaci√≥n-y-uso-de-paquetes",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Instalaci√≥n y Uso de Paquetes",
    "text": "Instalaci√≥n y Uso de Paquetes\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\nhelp(ggplot2)  # Consultar documentaci√≥n",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "href": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Acceder a los archivos de Ubuntu en RStudio",
    "text": "Acceder a los archivos de Ubuntu en RStudio\n\nEjecuta el siguiente comando en PowerShell:\nwsl.exe wslpath -w ~\nMostrar√° una direcci√≥n como la que se muestra:\n\\\\wsl.localhost\\Ubuntu\\home\\tu_usuario\nEn RStudio puedes establecer el directorio de trabajo en la carpeta de Ubuntu (WSL) usando setwd(). Ten cuidado en las diuagonales, en powershell las diagonales son invertidas * y cuando las utilices en R utiliza las diagonales normales /*:\nsetwd(\"//wsl.localhost/Ubuntu/home/tu_usuario/mi_proyecto\")",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html",
    "href": "chapters/revbayes.html",
    "title": "Apuntes sobre RevBayes",
    "section": "",
    "text": "Introducci√≥n a la Inferencia Bayesiana\nLa inferencia bayesiana es un enfoque de la estad√≠stica que permite actualizar nuestras creencias sobre un par√°metro desconocido a medida que obtenemos nueva informaci√≥n. Se basa en el Teorema de Bayes, que nos dice c√≥mo combinar la informaci√≥n previa con la evidencia observada.\nEl Teorema de Bayes se expresa matem√°ticamente como:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nEl objetivo de la inferencia bayesiana es calcular la distribuci√≥n posterior, que nos proporciona una estimaci√≥n m√°s precisa del par√°metro \\(\\theta\\) al incorporar tanto datos como conocimiento previo.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#por-qu√©-se-necesita-mcmc",
    "href": "chapters/revbayes.html#por-qu√©-se-necesita-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¬øPor qu√© se necesita MCMC?",
    "text": "¬øPor qu√© se necesita MCMC?\nEn inferencia bayesiana, la distribuci√≥n posterior de un par√°metro \\(\\theta\\) se calcula usando:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nPero en la pr√°ctica, el denominador \\(P(D)\\) es dif√≠cil de calcular, ya que requiere integrar sobre todos los valores posibles de \\(\\theta\\):\n\\[\nP(D) = \\int P(D | \\theta) P(\\theta) d\\theta\n\\]\nCuando el espacio de par√°metros es muy grande, esta integral es imposible de resolver anal√≠ticamente. MCMC nos ayuda a aproximar la distribuci√≥n posterior sin necesidad de calcular \\(P(D)\\).",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#c√≥mo-funciona-mcmc",
    "href": "chapters/revbayes.html#c√≥mo-funciona-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¬øC√≥mo funciona MCMC?",
    "text": "¬øC√≥mo funciona MCMC?\nMCMC simula valores de los par√°metros siguiendo estos pasos:\n\nEmpieza en un valor inicial .\nPropone un nuevo valor basado en una distribuci√≥n de transici√≥n.\nDecide si acepta o rechaza seg√∫n la regla de aceptaci√≥n.\nRepite el proceso muchas veces para construir una cadena de valores que sigan la distribuci√≥n posterior.\n\nüîπ Importante:\nCon suficientes iteraciones, la cadena converge a la distribuci√≥n posterior, permitiendo estimar par√°metros de manera precisa.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#m√©todos-populares-de-mcmc",
    "href": "chapters/revbayes.html#m√©todos-populares-de-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "M√©todos populares de MCMC",
    "text": "M√©todos populares de MCMC\nExisten varias formas de implementar MCMC. Las m√°s comunes son:\n‚úÖ 1. Algoritmo de Metropolis-Hastings\n\nPropone un nuevo valor \\(\\theta^*\\).\nDecide si lo acepta o no comparando la raz√≥n de aceptaci√≥n:\n\\[\nr = \\frac{P(D | \\theta^*) P(\\theta^*)}{P(D | \\theta) P(\\theta)}\n\\]\n\nSi \\(r \\geq 1\\), acepta \\(\\theta^*\\).\nSi \\(r &lt; 1\\), acepta \\(\\theta^*\\) con probabilidad \\(r\\).\n\n\nSe usa cuando no se conoce la forma exacta de la distribuci√≥n posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#c√≥mo-saber-si-una-cadena-ha-convergido",
    "href": "chapters/revbayes.html#c√≥mo-saber-si-una-cadena-ha-convergido",
    "title": "Apuntes sobre RevBayes",
    "section": "¬øC√≥mo saber si una cadena ha convergido?",
    "text": "¬øC√≥mo saber si una cadena ha convergido?\n\n\n\n\n\nAlgunas t√©cnicas comunes para evaluar la convergencia incluyen:\n\nInspecci√≥n visual de trazas: un gr√°fico de trazas muestra si la cadena ha alcanzado un comportamiento estable sin tendencias obvias.\nTama√±o de muestra efectivo (Effective Sample Size, ESS): Dado que las muestras en MCMC est√°n correlacionadas, el n√∫mero real de muestras independientes es menor que el n√∫mero total de iteraciones. El tama√±o de muestra efectivo (ESS) estima cu√°ntas muestras independientes equivalentes hay en la cadena.\n\nSe calcula como:\n\\[\nESS = \\frac{N}{1 + 2 \\sum \\rho_k}\n\\]\nDonde \\(N\\) es el n√∫mero total de iteraciones y \\(\\rho_k\\) es la autocorrelaci√≥n en el retraso \\(k\\). Un ESS alto (\\(ESS &gt; 200\\)) indica que la cadena ha explorado bien el espacio de par√°metros y proporciona estimaciones confiables.\nUn ESS bajo sugiere que las muestras est√°n altamente correlacionadas y que se necesitan m√°s iteraciones o una mejor parametrizaci√≥n del algoritmo para obtener estimaciones m√°s precisas.\nPara visualizar estos valores y generar gr√°ficos, se puede utilizar Tracer, una herramienta que facilita el an√°lisis de convergencia de cadenas MCMC. Se puede descargar en el siguiente enlace:\nTracer v1.7.2",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "href": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "Tipos de Nodos en RevBayes",
    "text": "Tipos de Nodos en RevBayes\n\nüëâ Nodos Constantes\nSon valores fijos dentro del modelo. No tienen incertidumbre.\nn = 10  # N√∫mero de observaciones\n\n\nüëâ Nodos Estoc√°sticos\nRepresentan variables aleatorias con una distribuci√≥n. Son los par√°metros del modelo.\ntheta ~ dnBeta(2,2)  # Prior Beta(2,2)\nEn este caso, theta es una variable aleatoria con una distribuci√≥n Beta.\n\n\nüëâ Nodos Deterministas\nSon valores calculados a partir de otros nodos.\nmu := theta * n  # Media esperada\nAqu√≠, mu se calcula a partir de theta y n.\n\n\nüëâ Nodos Clamped (Observados)\nSe utilizan para fijar valores observados en el modelo.\nD ~ dnBinomial(n, theta)  # Modelo Binomial\nD.clamp(7)  # Observamos 7 √©xitos\nEn este caso, D es una variable aleatoria Binomial, pero la fijamos en 7.\n\n\nüëâ Nodos Plate\nLos plates se usan para repetir estructuras en modelos jer√°rquicos.\nfor (i in 1:10) {\n    theta[i] ~ dnBeta(2,2)\n}\nAqu√≠, estamos creando 10 valores de theta, cada uno con una distribuci√≥n Beta(2,2).",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "href": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "üîπ 1. Definiendo el Modelo en RevBayes",
    "text": "üîπ 1. Definiendo el Modelo en RevBayes\n\nüìå Distribuci√≥n Prior\nAntes de ver los datos, asumimos una creencia previa sobre la probabilidad ( p ).\nUtilizamos una distribuci√≥n Beta(8,2), basada en la suposici√≥n de que aproximadamente el 80% de las personas disfrutar√°n del ambiente.\n\\[\np \\sim \\text{Beta}(8,2)\n\\]\nP√°gina para visualizar las distribuciones para RevBayes, pega el siguiente c√≥digo en Rev code:\nx ~ dnBeta(8, 2)\nLa media de esta distribuci√≥n es:\n\\[\nE[p] = \\frac{\\alpha}{\\alpha + \\beta} = \\frac{8}{8+2} = 0.8\n\\]\n\n\n\nüìå Verosimilitud (Likelihood)\nLa verosimilitud describe la probabilidad de observar los datos dados un valor espec√≠fico de ( p ).\nComo cada estudiante puede estar satisfecho (√©xito) o insatisfecho (fracaso), usamos una distribuci√≥n Binomial:\n\\[\nk \\sim \\text{Binomial}(n = 10, p)\n\\]\nDonde: - ( k = 7 ) es el n√∫mero de estudiantes satisfechos observados. - ( n = 10 ) es el n√∫mero total de encuestados.\n\n\n\nüìå Posterior Bayesiana\nAplicamos el Teorema de Bayes:\n\\[\nP(p | D) \\propto P(D | p) P(p)\n\\]\nDado que usamos un prior Beta y una verosimilitud Binomial, la posterior tambi√©n sigue una distribuci√≥n Beta con par√°metros actualizados:\n\\[\np | D \\sim \\text{Beta}(8+7, 2+3) = \\text{Beta}(15,5)\n\\]\nLa media de la posterior nos da la mejor estimaci√≥n despu√©s de observar los datos:\n\\[\nE[p] = \\frac{15}{15 + 5} = 0.75\n\\]\nEsto significa que, despu√©s de observar que 7 de 10 estudiantes disfrutaron el ambiente, nuestra mejor estimaci√≥n de la probabilidad de que t√∫ disfrutes del ambiente es 75%.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#c√≥digo-en-revbayes",
    "href": "chapters/revbayes.html#c√≥digo-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "üîπ 2. C√≥digo en RevBayes",
    "text": "üîπ 2. C√≥digo en RevBayes\nA continuaci√≥n, presentamos el c√≥digo en RevBayes para implementar este modelo y ejecutar un an√°lisis MCMC.\n\n\n\n\n\n# ------------------------------------------------\n# RevBayes - Algoritmo de Metropolis-Hastings para estimar\n# la probabilidad de disfrutar el ambiente en las micheladas de Tepito\n# ------------------------------------------------\n\n# Datos observados\ntotal_clientes &lt;- 10  # N√∫mero total de encuestados\nsatisfechos &lt;- 7      # N√∫mero de estudiantes que disfrutaron el ambiente\n\n# Especificar la distribuci√≥n prior\nalpha &lt;- 8   # Basado en la creencia previa de 80% satisfacci√≥n\nbeta  &lt;- 2   # Complemento del prior\np ~ dnBeta(alpha, beta)  # Prior Beta(8,2)\n\n# Definir la propuesta de MCMC con Metropolis-Hastings\nmoves[1] = mvSlide(p, delta=0.1, weight=1)  # Movimiento en la distribuci√≥n de p\n\n# Especificar el modelo de verosimilitud (distribuci√≥n Binomial)\nk ~ dnBinomial(p, total_clientes)\nk.clamp(satisfechos)  # Fijar la observaci√≥n de 7 estudiantes satisfechos\n\n# Crear el modelo\nmy_model = model(p)\n\n# Definir monitores para el MCMC\nmonitors[1] = mnModel(filename=\"micheladas_MH.log\", printgen=10, separator = TAB)  # Guardar resultados\nmonitors[2] = mnScreen(printgen=100, p)  # Mostrar progreso cada 100 generaciones\n\n# Crear el an√°lisis MCMC con Metropolis-Hastings\nanalysis = mcmc(my_model, monitors, moves)\n\n# Ejecutar el MCMC con 100,000 iteraciones\nanalysis.run(100000)\n\n# Mostrar el resumen de los operadores de MCMC\nanalysis.operatorSummary()",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#mini-ejercicio",
    "href": "chapters/revbayes.html#mini-ejercicio",
    "title": "Apuntes sobre RevBayes",
    "section": "Mini-ejercicio",
    "text": "Mini-ejercicio\n\nCrea un script para RevBayes (.Rev) utilizando Visual Studio Code y copia el codigo.\nModifica el prior dnBeta(alpha, beta) con los valores que reflejen tu creencia sobre la probabilidad de satisfacci√≥n.\nGuarda el archivo micheladas_MH.log en la carpeta asiganada para guardar resultados.\nGuarda el script en la carpeta de scripts.\nEjecuta el an√°lisis MCMC en RevBayes.\nVisualiza los resultados usando Tracer para observar la distribuci√≥n posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html",
    "href": "chapters/u1_intro_diversification.html",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "",
    "text": "Presentaci√≥n: Introducci√≥n al proceso de diversificaci√≥n parte 1\nHaz clic en la imagen para ver el PDF de la presentaci√≥n",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "href": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "1.- Mediante la liberia remotes",
    "text": "1.- Mediante la liberia remotes\n\n# Instalar remotes si no est√° instalado\nif (!requireNamespace(\"remotes\", quietly = TRUE)) {\n  install.packages(\"remotes\")\n}\n\n# Instalar TreePar\nremotes::install_github(\"tanja819/TreePar\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "href": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "2.- Descargar el paquete TreePar",
    "text": "2.- Descargar el paquete TreePar\n\nPuedes descargar el paquete desde el siguiente enlace:\nüì• Descargar TreePar 3.3\nGuarda el archivo en una carpeta de tu elecci√≥n (por ejemplo, en ~/Descargas/ o C:/Users/TuUsuario/Downloads/).\n\n\n\nInstalar TreePar desde el archivo descargado\nUna vez que hayas descargado el archivo TreePar_3.3.tar.gz, abre R y ejecuta el siguiente c√≥digo para instalarlo:\n# Definir la ruta donde se descarg√≥ el archivo\nruta_archivo &lt;- \"~/Descargas/TreePar_3.3.tar.gz\"  # Cambia esta ruta seg√∫n tu sistema operativo\n\n# Instalar el paquete desde el archivo .tar.gz\ninstall.packages(ruta_archivo, repos = NULL, type = \"source\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descarga-del-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification.html#descarga-del-√°rbol-filogen√©tico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Descarga del √Årbol Filogen√©tico",
    "text": "Descarga del √Årbol Filogen√©tico\nüì• Puedes descargar el archivo NEXUS con el √°rbol de estudio en el siguiente enlace:\nüì• Descargar √Årbol Filogen√©tico\nGuarda el archivo en la carpeta correspondiente y verifica su ubicaci√≥n antes de continuar.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-√°rbol-en-r",
    "href": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-√°rbol-en-r",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Cargar y Visualizar el √Årbol en R",
    "text": "Cargar y Visualizar el √Årbol en R\nEjecuta el siguiente c√≥digo en R para cargar el archivo y visualizar el √°rbol completo:\n\n# Cargar los paquetes necesarios\nlibrary(ape)\nlibrary(ggtree)\nlibrary(treeio)\nlibrary(tidyverse)\n\n# Definir la ruta del archivo NEXUS\narchivo_nexus &lt;- \"../docs/u1_PatDiv/allSamples.tre\"  # Aseg√∫rate de cambiar esta ruta si es necesario\n\n# Cargar el √°rbol\narbol &lt;- read.nexus(archivo_nexus)\n\n# Calcular el L√≠mite M√°ximo del Eje X\nmax_edge_length &lt;- max(arbol$edge.length, na.rm = TRUE)\n\n# Graficar el √°rbol\nggtree(arbol) +\n  geom_tiplab(size = 3) +\n  geom_text2(aes(subset = !isTip, label = node), hjust = -0.3) +  # Etiquetar nodos internos\n  xlim(-0.5, max_edge_length * 1.4) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-espec√≠fico",
    "href": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-espec√≠fico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Extraer los nombres de las terminales de un nodo espec√≠fico:",
    "text": "Extraer los nombres de las terminales de un nodo espec√≠fico:\nUtilizar la funci√≥n getDescendants para obtener los nombres de todas la terminales del nodo interno 61:\n\nlibrary(phytools)\n\nnodo_interes &lt;- 61  # Reemplaza este valor por el nodo de tu inter√©s\n\n# Obtener los √≠ndices de los nodos descendientes\nnodos_internos &lt;- getDescendants(arbol, nodo_interes)\n\n# Filtrar solo los √≠ndices que corresponden a las terminales (tips)\nindices_tips &lt;- nodos_internos[nodos_internos &lt;= length(arbol$tip.label)]\n\n# Obtener los nombres de las terminales\nnombres_tips &lt;- arbol$tip.label[indices_tips]\n\n# Mostrar los nombres de las terminales\nprint(nombres_tips)\n\n [1] \"06166_50_120_Phod_marmorata\" \"KRN15_107_Phod_marmorata\"   \n [3] \"KRN52_Phod_alticeps\"         \"KRN10_118_Phod_alticeps\"    \n [5] \"KRN14_Phod_alticeps\"         \"KRN24_Cyste_armatus\"        \n [7] \"KRN02_Cyste_armatus\"         \"KRN25_Cyste_armatus\"        \n [9] \"KRN28_Cyste_wislizeni\"       \"KRN03_Cyste_wislizeni\"      \n[11] \"KRN26_Cyste_wislizeni\"       \"KRN100_101_Tegro_aloga\"     \n[13] \"KRN96_97_98_Tegro_aloga\"     \"KRN11_Tegro_erosa\"          \n[15] \"KRN12_Tegro_erosa\"           \"KRN13_Tegro_latecincta\"     \n[17] \"KRN53_Tegro_latecincta\"      \"KRN01_Cordy_opaca\"          \n[19] \"KRN112_Cordy_opaca\"          \"KRN111_Cordy_fulleri\"       \n[21] \"KRN23_Cordy_fulleri\"         \"KRN09_Mege_vittata\"         \n[23] \"KRN08_Mege_puncta\"           \"KRN07_133_Mege_cancell\"     \n[25] \"KRN129_Mege_cancell_h\"       \"KRN51_Pleu_reticulata\"      \n[27] \"KRN48_Pleu_mirabilis\"        \"KRN47_119_Pleu_mirabilis\"   \n[29] \"KRN49_Pleu_mirabilis\"        \"KRN19_Eup_sulciphrons\"      \n[31] \"KRN131_Eup_schwarzi\"         \"KRN88_89_Eup_histrionica\"   \n[33] \"KRN90_Eup_histrionica\"       \"KRN43_108_Eup_fissiceps\"    \n[35] \"KRN45_Eup_fissiceps\"         \"KRN44_Eup_fissiceps\"        \n[37] \"KRN54_121_Eup_fissiceps\"     \"KRN20_Eup_imperialis\"       \n[39] \"KRN06_Eup_imperialis\"        \"KRN42_Eup_imperialis\"       \n[41] \"KRN30_113_Eup_elegans\"       \"KRN38_115_Eup_elegans_p\"    \n[43] \"KRN29_Eup_elegans_p\"         \"KRN21_114_Eup_elegans_p\"    \n[45] \"KRN40_Eup_elegans_p\"         \"KRN92_93_Eup_edmundsi\"      \n[47] \"KRN18_135_Eup_viridis\"       \"KRN59_Eup_viridis\"",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-sub√°rboles-filogen√©ticos",
    "href": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-sub√°rboles-filogen√©ticos",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Uso de getMRCA y extract.clade para extraer Sub√°rboles Filogen√©ticos",
    "text": "Uso de getMRCA y extract.clade para extraer Sub√°rboles Filogen√©ticos\n\n# Obtener el nodo m√°s reciente en com√∫n del ingroup\nmrca_ingroup &lt;- getMRCA(arbol, nombres_tips)\n\n# Extraer el sub√°rbol del ingroup\nsubarbol &lt;- extract.clade(arbol, mrca_ingroup)\n\n# Calcular la longitud m√°xima de las ramas del sub√°rbol\nmax_edge_length &lt;- max(subarbol$edge.length, na.rm = TRUE)\n\n# Graficar el sub√°rbol\nggtree(subarbol) +\n  geom_tiplab(size = 3) +\n  xlim(-0.5, max_edge_length * 2) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "href": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Remover especies duplicadas",
    "text": "Remover especies duplicadas\n\n# Separar los nombres de las especies (asumiendo el formato \"ID_Especie\")\nspecies_info &lt;- data.frame(\n  tip_label = nombres_tips,\n  species = str_extract(nombres_tips, \"[A-Za-z]+_[A-Za-z]+(?:_[A-Za-z]+)?$\")\n)\n\n# Eliminar las ssp _h y _p\n# Seleccionar solo una muestra por especie\nunique_species &lt;- species_info %&gt;%\n  filter(!str_detect(species, \"_[hp]$\")) %&gt;%\n  group_by(species) %&gt;% \n  slice(1) %&gt;%  # Selecciona solo la primera aparici√≥n de cada especie\n  ungroup()\n\n# Extraer los nombres de los tips que queremos conservar\nselected_tips &lt;- unique_species$tip_label\n\n# Remover duplicados\nsubarbol_final &lt;- drop.tip(subarbol, setdiff(subarbol$tip.label, selected_tips))\n\nggtree(subarbol_final) + \n  geom_tiplab(size = 3) + \n  xlim(-0.5, max(subarbol_final$edge.length) * 2)  # Expande el espacio a la izquierda",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#guardar-el-√°rbol-resultante-en-formato-nexus",
    "href": "chapters/u1_intro_diversification.html#guardar-el-√°rbol-resultante-en-formato-nexus",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Guardar el √°rbol resultante en formato NEXUS",
    "text": "Guardar el √°rbol resultante en formato NEXUS\n\nwrite.nexus(subarbol_final, file=\"../docs/u1_PatDiv/subarbol_ingroup.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#carga-del-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification.html#carga-del-√°rbol-filogen√©tico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Carga del √Årbol Filogen√©tico",
    "text": "Carga del √Årbol Filogen√©tico\n\n# Carga de paquetes\nlibrary(subplex)\nlibrary(TreeSim)\nlibrary(deSolve)\nlibrary(ape)       \nlibrary(TreePar)\n\n# Cargar el √°rbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el √°rbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtenci√≥n-de-los-tiempos-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification.html#obtenci√≥n-de-los-tiempos-de-especiaci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Obtenci√≥n de los Tiempos de Especiaci√≥n",
    "text": "Obtenci√≥n de los Tiempos de Especiaci√≥n\nExtraeremos y ordenaremos los tiempos de especiaci√≥n (tiempos de ramificaci√≥n) del √°rbol:\n\n# Obtener y ordenar los tiempos de especiaci√≥n\n# La funci√≥n getx() extrae los tiempos de ramificaci√≥n del √°rbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulaci√≥n.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "href": "chapters/u1_intro_diversification.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Configuraci√≥n de Par√°metros para el An√°lisis",
    "text": "Configuraci√≥n de Par√°metros para el An√°lisis\nDefiniremos los par√°metros necesarios para el an√°lisis de cambios en las tasas de diversificaci√≥n:\n\nrho &lt;- 22/26  # Proporci√≥n de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tama√±o de la grilla de b√∫squeda de cambios de tasa (en millones de a√±os)\nstart &lt;- min(times) + 1.5  # Tiempo inicial para la b√∫squeda de cambios de tasa\nend &lt;- max(times) - 1.5    # Tiempo final para la b√∫squeda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#ejecuci√≥n-del-an√°lisis-con-bd.shifts.optim",
    "href": "chapters/u1_intro_diversification.html#ejecuci√≥n-del-an√°lisis-con-bd.shifts.optim",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Ejecuci√≥n del An√°lisis con bd.shifts.optim",
    "text": "Ejecuci√≥n del An√°lisis con bd.shifts.optim\nUtilizaremos la funci√≥n bd.shifts.optim para estimar las tasas de especiaci√≥n y extinci√≥n, as√≠ como los puntos en el tiempo donde ocurren cambios significativos en estas tasas:\n\n# Ejecutar el an√°lisis de cambios en las tasas de diversificaci√≥n\nresult_shifts &lt;- bd.shifts.optim(times, rho, grid, start, end, yule=TRUE)\n\n[1] \"startest\"\n[1] \"test\"\n\n# Mostrar los resultados\nresult_shifts[[2]][[1]]\n\n[1] 70.02138042  0.08912957\n\n\nA continuaci√≥n se presentan los valores obtenidos en la estimaci√≥n de la tasa de diversificaci√≥n. Dado que el modelo Yule asume que no hay extinci√≥n, la tasa de extinci√≥n no est√° definida en este an√°lisis.\n\nValor de la funci√≥n de verosimilitud negativa: 70.02138\nTasa de especiaci√≥n \\(\\lambda\\): 0.08913\n\nEn este contexto:\nEstos valores indican que la tasa de especiaci√≥n estimada (\\(\\lambda\\)) es aproximadamente 0.08913.\nEl valor de la funci√≥n de verosimilitud negativa (70.02138) proporciona una medida del ajuste del modelo a los datos, donde valores m√°s bajos generalmente indican un mejor ajuste.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "href": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "text": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "href": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Cargar el archivo NEXUS",
    "text": "Cargar el archivo NEXUS\n# Cargar la filogenia desde el archivo NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Obtener la lista de taxones en la filogenia\ntaxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "href": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Inicializar los vectores de moves y monitors",
    "text": "Inicializar los vectores de moves y monitors\n# Inicializar un vector vac√≠o para los movimientos (moves)\nmoves = VectorMoves()\n\n# Inicializar un vector vac√≠o para los monitores (monitors)\nmonitors = VectorMonitors()\n\n\n\n\n\nRepresentaci√≥n del modelo gr√°fico para el proceso Yule (Pure-Birth) en RevBayes, donde la tasa de especiaci√≥n (\\(\\lambda\\)) es tratada como una variable aleatoria extra√≠da de una distribuci√≥n uniforme.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiaci√≥n-lambda",
    "href": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiaci√≥n-lambda",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Especificar la tasa de especiaci√≥n (\\(\\lambda\\))",
    "text": "Especificar la tasa de especiaci√≥n (\\(\\lambda\\))\n# Especificar la tasa de especiaci√≥n Œª con una distribuci√≥n uniforme\nbirth_rate ~ dnUniform(0, 100.0)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiaci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Asignar un movimiento MCMC a la tasa de especiaci√≥n",
    "text": "Asignar un movimiento MCMC a la tasa de especiaci√≥n\n# Agregar un movimiento MCMC para la tasa de especiaci√≥n\nmoves.append( mvScale(birth_rate, lambda=1.0, tune=true, weight=3.0) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-proporci√≥n-de-especies-muestreadas-rho",
    "href": "chapters/u1_intro_diversification.html#especificar-la-proporci√≥n-de-especies-muestreadas-rho",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Especificar la proporci√≥n de especies muestreadas (\\(\\rho\\))",
    "text": "Especificar la proporci√≥n de especies muestreadas (\\(\\rho\\))\n# Obtener el n√∫mero de taxones en la filogenia\nnum_taxa &lt;- T.ntips()\n\n# Estimar la proporci√≥n de especies muestreadas\nrho &lt;- num_taxa / 26",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-ra√≠z",
    "href": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-ra√≠z",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Obtener la edad de la ra√≠z",
    "text": "Obtener la edad de la ra√≠z\n# Obtener la edad de la ra√≠z del √°rbol\nroot_time &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiaci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Definir el modelo de tiempo de especiaci√≥n",
    "text": "Definir el modelo de tiempo de especiaci√≥n\nEl modelo Yule (pure-birth) en RevBayes se define con el proceso de nacimiento y muerte (dnBDP), pero con la tasa de extinci√≥n (mu) fijada en 0.\n# Definir el modelo de diversificaci√≥n usando un proceso de nacimiento-muerte (BDP)\ntimetree ~ dnBDP(lambda=birth_rate, mu=0.0, rho=rho, rootAge=root_time, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)\nExplicaci√≥n\n\nlambda = birth_rate ‚Üí Tasa de especiaci√≥n es una variable aleatoria con dnUniform(0, 100.0).\nmu = 0.0 ‚Üí Asumimos que no hay extinci√≥n (modelo Yule).\nrho = rho ‚Üí Se ajusta seg√∫n el n√∫mero de especies muestreadas.\nrootAge = root_time ‚Üí Condicionamos el modelo en la edad de la ra√≠z.\nsamplingStrategy = \"uniform\" ‚Üí Asumimos muestreo uniforme.\ncondition = \"survival\" ‚Üí Solo analizamos √°rboles que sobrevivieron hasta el presente.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "href": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Fijar la filogenia observada",
    "text": "Fijar la filogenia observada\n# Fijar la filogenia observada\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-gr√°fico",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-gr√°fico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Definir el modelo gr√°fico",
    "text": "Definir el modelo gr√°fico\n# Crear el objeto de modelo\nmymodel = model(birth_rate)\nEsto crea un modelo gr√°fico dirigido ac√≠clico (DAG) donde birth_rate es el nodo principal, y RevBayes autom√°ticamente encuentra todos los otros nodos conectados.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "href": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Especificar los Monitores",
    "text": "Especificar los Monitores\n# Monitor para registrar los estados del modelo en un archivo de salida\nmonitors.append( mnModel(filename=\"output/diversification_Yule.log\", printgen=10, separator=TAB) )\n\n# Monitor para imprimir la tasa de especiaci√≥n en la pantalla cada 1000 generaciones\nmonitors.append( mnScreen(printgen=1000, birth_rate) )\nExplicaci√≥n\n\nmnModel guarda el registro de la ejecuci√≥n en \"output/diversification_Yule.log\", escribiendo cada 10 generaciones.\nmnScreen imprime la tasa de especiaci√≥n (birth_rate) en la consola cada 1000 generaciones.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Configurar y ejecutar el MCMC",
    "text": "Configurar y ejecutar el MCMC\n# Inicializar el MCMC con dos cadenas combinadas en un solo an√°lisis\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\n\n# Ejecutar el MCMC por 50,000 generaciones, ajustando los movimientos cada 200 generaciones\nmymcmc.run(generations=50000, tuningInterval=200)\nExplicaci√≥n\n\nnruns=2 ‚Üí Corre dos cadenas independientes.\ncombine=\"mixed\" ‚Üí Combina las cadenas en un solo conjunto de muestras.\ngenerations=50000 ‚Üí Ejecuta la simulaci√≥n por 50,000 generaciones.\ntuningInterval=200 ‚Üí Ajusta los movimientos cada 200 generaciones para mejorar la eficiencia del muestreo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "href": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Cargar los resultados en RevGadgets",
    "text": "Cargar los resultados en RevGadgets\nDespu√©s de correr el MCMC en RevBayes, usar RevGadgets en R para analizar la distribuci√≥n posterior:\n\n# Cargar librer√≠as necesarias\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC\nmcmc_trace &lt;- readTrace(\"../docs/u1_PatDiv/output/diversification_Yule.log\")\n\n# Visualizar la distribuci√≥n posterior de birth_rate\nplotTrace(mcmc_trace, vars=\"birth_rate\")\n\n[[1]]",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "href": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Calcular la media y el intervalo de HPD (Highest Posterior Density)",
    "text": "Calcular la media y el intervalo de HPD (Highest Posterior Density)\n\n# Calcular la media posterior y el HPD del 95%\nsummary_stats &lt;- summarizeTrace(mcmc_trace, vars=\"birth_rate\")\nprint(summary_stats)\n\n$birth_rate\n$birth_rate$trace_1\n         mean        median           MAP  quantile_2.5 quantile_97.5 \n   0.09313312    0.09214016    0.09140298    0.05919603    0.13341000",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#comparar-la-distribuci√≥n-previa-y-posterior",
    "href": "chapters/u1_intro_diversification.html#comparar-la-distribuci√≥n-previa-y-posterior",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 1",
    "section": "Comparar la distribuci√≥n previa y posterior",
    "text": "Comparar la distribuci√≥n previa y posterior\n\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC combinando las dos cadenas\nposterior_trace &lt;- readTrace(c(\"../docs/u1_PatDiv/output/diversification_Yule_run_1.log\", \"../docs/u1_PatDiv/output/diversification_Yule_run_2.log\"))\n\n# Extraer el primer conjunto de muestras (lista de data frames)\nyule_posterior &lt;- posterior_trace[[1]]\n\n# Simular 10,000 valores de la distribuci√≥n previa\nyule_prior &lt;- data.frame(birth_rate = runif(10000, min=0, max=100))\n\n# Agregar la columna de la distribuci√≥n previa en el posterior\nyule_posterior$birth_rate_prior &lt;- sample(yule_prior$birth_rate, size = nrow(yule_posterior), replace = TRUE)\n\n# Graficar la comparaci√≥n\nplotTrace(list(yule_posterior), vars = c(\"birth_rate\", \"birth_rate_prior\"))[[1]] +\n  theme(legend.position = c(0.80, 0.80),  # Ubicaci√≥n de la leyenda\n        legend.text = element_text(size =20),  # Tama√±o del texto de la leyenda\n        legend.title = element_text(size = 22)) +  # Tama√±o del t√≠tulo de la leyenda\n  xlim(0, 1)  # Ajusta el l√≠mite seg√∫n los valores observados",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html",
    "href": "chapters/u1_intro_diversification_2.html",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 2",
    "section": "",
    "text": "Presentaci√≥n: Introducci√≥n al proceso de diversificaci√≥n parte 2\nHaz clic en la imagen para ver el PDF de la presentaci√≥n",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducci√≥n",
    "href": "chapters/u1_intro_diversification_2.html#introducci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 2",
    "section": "Introducci√≥n",
    "text": "Introducci√≥n\nEn estudios filogen√©ticos, los modelos de nacimiento-muerte (birth-death models) permiten inferir c√≥mo han cambiado las tasas de especiaci√≥n () y extinci√≥n () a lo largo del tiempo. Sin embargo, estas tasas no son siempre constantes. Diversos eventos evolutivos, como la aparici√≥n de nuevas adaptaciones o cambios ambientales, pueden causar variaciones en la din√°mica de diversificaci√≥n de un linaje.\nEl paquete TreePar permite ajustar modelos de diversificaci√≥n con cambios en la tasa mediante la funci√≥n bd.shifts.optim(). Esta funci√≥n estima la mejor combinaci√≥n de tasas de especiaci√≥n y extinci√≥n en diferentes periodos de tiempo, seg√∫n la estructura de una filogenia dada.\nCargar librer√≠as y el √°rbol filogen√©tico\n\n# Cargar las librer√≠as necesarias\nlibrary(ape)       \nlibrary(TreePar)\nlibrary(tidyverse)\nlibrary(ggtree)\n\n# Cargar el √°rbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el √°rbol\nggtree(tree) + theme_tree()\n\n\n\n\n\n\n\n\nObtenci√≥n de los Tiempos de Especiaci√≥n\nExtraeremos y ordenaremos los tiempos de especiaci√≥n (tiempos de ramificaci√≥n) del √°rbol:\n\n# Obtener y ordenar los tiempos de especiaci√≥n\n# La funci√≥n getx() extrae los tiempos de ramificaci√≥n del √°rbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulaci√≥n.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293\n\n\nConfiguraci√≥n de Par√°metros para el An√°lisis\nDefiniremos los par√°metros necesarios para el an√°lisis de cambios en las tasas de diversificaci√≥n:\n\nrho &lt;- 22/26  # Proporci√≥n de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tama√±o de la grilla de b√∫squeda de cambios de tasa (en millones de a√±os)\nstart &lt;- min(times)   # Tiempo inicial para la b√∫squeda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la b√∫squeda de cambios de tasa\n\nModelo de nacimiento-muerte sin cambios en la tasa\n\nresbd &lt;- bd.shifts.optim(times, rho, grid, start, end)\n\n[1] \"startest\"\n[1] \"test\"\n\nresbd[[2]]  # Verosimilitud del modelo\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n\nModelo con un cambio en la tasa\nAqu√≠ probamos un modelo en el que la tasa cambia en un tiempo \\(t_{1}\\)\n\n\n\n\n\n\n\nPar√°metro\nSignificado\n\n\n\n\ntime\nEdades de los nodos terminales\n\n\nc(0.8, 1)\nProporci√≥n de especies muestreadas en cada periodo\n\n\ngrid\nIntervalo de discretizaci√≥n del tiempo\n\n\nstart, end\nRango de tiempo para el an√°lisis\n\n\nME=FALSE\nNo se consideran eventos de extinci√≥n masiva\n\n\nsurvival=1\nSe asume que todas las especies sobrevivientes han sido muestreadas\n\n\n\n\nresoneshift &lt;- bd.shifts.optim(times, c(rho, 1), grid, start, end, ME=FALSE, survival=1)\nresoneshift[[2]]  # Verosimilitud del modelo con un cambio en la tasa\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.295893e+01 9.952613e-01 8.527988e-02 1.001768e-04 1.594866e-01\n[6] 6.125229e+00\n\n\nInterpretaci√≥n\n\nVerosimilitud:\n\n\n\n\n\n\n\n\n\n√çndice\nPar√°metro estimado\nDescripci√≥n\n\n\n\n\n1\n62.95893\nVerosimilitud (log-likelihood)\n\n\n2\n0.99526\nProporci√≥n de especies muestreadas en el tiempo m√°s reciente (\\(\\rho\\))\n\n\n3\n0.08528\nTasa de especiaci√≥n (\\(\\lambda_1\\)) antes del cambio de tasa\n\n\n4\n0.00010\nTasa de extinci√≥n (\\(\\mu_1\\)) antes del cambio de tasa\n\n\n5\n0.15949\nTiempo del cambio en la tasa (\\(t_1\\))\n\n\n6\n6.12523\nNueva tasa de especiaci√≥n (\\(\\lambda_2\\)) despu√©s del cambio\n\n\n\nModelo con dos cambios en la tasa (2 shifts)\n\nrestwoshift &lt;- bd.shifts.optim(times, c(0.8,1,1), grid, start, end, ME=FALSE, survival=1)\nrestwoshift[[2]]\n\n\n\n[[1]]\n[1] 6.984598e+01 2.752173e-07 9.230017e-02\n\n[[2]]\n[1] 6.300085e+01 3.082460e-02 9.309168e-08 1.887393e-02 1.612077e-01\n[6] 6.125229e+00\n\n[[3]]\n[1]  6.045200e+01  7.427444e-08  1.840255e-02  1.040200e+00  2.028774e-02\n[6]  1.244237e-01 -2.968324e-02  6.125229e+00  1.472523e+01",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#resultados-del-segundo-cambio-en-la-tasa-restwoshift3",
    "href": "chapters/u1_intro_diversification_2.html#resultados-del-segundo-cambio-en-la-tasa-restwoshift3",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 2",
    "section": "Resultados del segundo cambio en la tasa (restwoshift[[3]])",
    "text": "Resultados del segundo cambio en la tasa (restwoshift[[3]])\n\n\n\n\n\n\n\n\n√çndice\nValor\nDescripci√≥n\n\n\n\n\n1\n60.45200\nVerosimilitud (log-likelihood)\n\n\n2\n7.427444e-08\nProporci√≥n de especies muestreadas en este periodo\n\n\n3\n0.01840\nTasa de especiaci√≥n (\\(\\lambda_2\\)) antes del segundo cambio\n\n\n4\n1.04020\nTasa de extinci√≥n (\\(\\mu_2\\)) antes del segundo cambio\n\n\n5\n0.02028\nNuevo tiempo del segundo cambio en la tasa (\\(t_2\\))\n\n\n6\n0.12442\nTasa de especiaci√≥n (\\(\\lambda_3\\)) despu√©s del segundo cambio\n\n\n7\n-0.02968\nUn par√°metro auxiliar de optimizaci√≥n\n\n\n8\n6.12523\nSe repite el valor de especiaci√≥n de un periodo anterior\n\n\n9\n14.72523\nMomento en el tiempo en el que ocurre el segundo cambio (\\(\\(t_2\\))\n\n\n\nComparaci√≥n de modelos usando Likelihood Ratio Test (LRT)\n¬øQu√© es la prueba LRT? Es una prueba estad√≠stica para comparar modelos anidados, es decir, modelos donde uno es una versi√≥n simplificada del otro (por ejemplo, el modelo de nacimiento-muerte puro vs.¬†un modelo con cambios en la tasa).\nSe calcula con la siguiente f√≥rmula:\n\\(LR = 2 * (\\mathcal{L}_{modelo m√°s simple} - \\mathcal{L}_{modelo m√°s complejo})\\)\nDonde: - Un p-valor menor a 0.05 indica que el modelo m√°s complejo es significativamente mejor que el m√°s simple.\nObtener las Verosimilitudes de cada modelo\n\n## Verosimilitud birth-death\nresbd[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death un cambio\nresoneshift[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death dos cambios\nrestwoshift[[2]][[1]][1]\n\n[1] 69.84598\n\n\nComparaci√≥n BD vs BD un cambio\n\nChiSq1 = 2 * (resbd[[2]][[1]][1] - resoneshift[[2]][[1]][1])\nChiSq1\n\n[1] 0\n\npchiSq1 &lt;- pchisq(ChiSq1, df=3)\npchiSq1\n\n[1] 0\n\n\nResultados:\n\n\\(LR = 0\\) ‚Üí No hay diferencia en la verosimilitud entre el modelo BD y BD con un cambio.\n\\(p_{valor} = 0\\) ‚Üí Indica que no hay mejora significativa en el modelo con un cambio en la tasa.\n\nComparaci√≥n BD un cambio vs BD dos cambios\n\nChiSq2 = 2 * (resoneshift[[2]][[1]][1] - restwoshift[[2]][[1]][1])\nChiSq2\n\n[1] 0.3508041\n\npchiSq2 &lt;- pchisq(ChiSq2, df=3)\npchiSq2\n\n[1] 0.04979325\n\n\nResultados:\n\n\\(LR = 0.3508\\) ‚Üí Hay una peque√±a diferencia en la verosimilitud entre el modelo BD con un cambio y el modelo BD con dos cambios.\n\\(p_{valor} = 0.0498\\) ‚Üí Justo en el l√≠mite del umbral de significancia \\((0.05)\\), lo que indica que el modelo con dos cambios podr√≠a ser significativamente mejor.\n\nGenerar el gr√°fico con bd.shifts.plot()\nGraficar el modelo con un cambio en la tasa\n\nbd.shifts.plot(list(resoneshift[[2]]), shifts = 1, timemax = max(times), ratemin = 0, ratemax = 0.2)\n\n\n\n\n\n\n\n\nGraficar el modelo con un cambio en la tasa\n\nbd.shifts.plot(list(restwoshift[[2]]), shifts = 2, timemax = max(times), ratemin = -0.1, ratemax = 0.2)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducci√≥n-1",
    "href": "chapters/u1_intro_diversification_2.html#introducci√≥n-1",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 2",
    "section": "Introducci√≥n",
    "text": "Introducci√≥n\nEl modelo de nacimiento-muerte ep√≠sodico es un proceso en el cual las tasas de diversificaci√≥n var√≠an ep√≠sodicamente a lo largo del tiempo y se modelan como tasas constantes por intervalos de tiempo (Stadler 2011; H√∂hna 2015). Siguiendo el tutorial oficial Episodic Diversification Rate Estimation.\nAsumimos que las tasas transformadas logar√≠tmicamente siguen una distribuci√≥n previa de campo aleatorio de Markov en forma de herradura (Horseshoe Markov random field, HSMRF) seg√∫n Magee et al.¬†(2020).\n\nTasas transformadas logar√≠tmicamente:\n\nEn muchos modelos evolutivos, las tasas de especiaci√≥n y extinci√≥n pueden variar en √≥rdenes de magnitud.\nPara modelar mejor estos cambios, se toma el logaritmo de las tasas en lugar de usarlas directamente.\nEsto ayuda a evitar valores negativos y hace que la distribuci√≥n de las tasas sea m√°s manejable.\n\nDistribuci√≥n previa (prior) de campo aleatorio de Markov en forma de herradura (HSMRF):\n\nDistribuci√≥n previa (prior): En un enfoque bayesiano, los par√°metros desconocidos (como las tasas de especiaci√≥n/extinci√≥n) tienen distribuciones previas que reflejan nuestras creencias antes de ver los datos.\nCampo aleatorio de Markov (Markov Random Field, MRF): Este t√©rmino indica que las tasas en un intervalo de tiempo dependen de las tasas en el intervalo anterior. En otras palabras, las tasas est√°n autocorrelacionadas temporalmente.\nForma de herradura (Horseshoe): Es un tipo de distribuci√≥n previa dise√±ada para manejar datos donde algunos valores pueden ser cercanos a cero (relativamente constantes), pero tambi√©n permite valores extremos (cambios bruscos en las tasas).\n¬øPor qu√© se usa? El HSMRF permite capturar patrones donde las tasas cambian lentamente la mayor parte del tiempo, pero ocasionalmente pueden dar saltos grandes, lo cual es biol√≥gicamente realista en muchos sistemas evolutivos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#lectura-del-√°rbol",
    "href": "chapters/u1_intro_diversification_2.html#lectura-del-√°rbol",
    "title": "Introducci√≥n al proceso de diversificaci√≥n parte 2",
    "section": "Lectura del √°rbol",
    "text": "Lectura del √°rbol\nComenzamos cargando el √°rbol filogen√©tico previamente filtrado.\n# Cargar el √°rbol filogen√©tico desde un archivo en formato NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Extraer la informaci√≥n taxon√≥mica del √°rbol\n taxa &lt;- T.taxa()\nDefinir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()\nDefinir el n√∫mero de intervalos en los que dividiremos el tiempo para modelar la diversificaci√≥n.\nNUM_INTERVALS = 10  # N√∫mero total de intervalos de tiempo\nNUM_BREAKS := NUM_INTERVALS - 1  # N√∫mero de puntos de cambio entre intervalos\n\n\n\n\n\n\n\n\n\nDefinimos distribuciones previas sobre las tasas dentro del modelo HSMRF de nacimiento-muerte. Par√°metros globales de escala\n# Hiperprior para controlar la variabilidad global de las tasas de especiaci√≥n y extinci√≥n\nspeciation_global_scale_hyperprior &lt;- 0.044\nextinction_global_scale_hyperprior &lt;- 0.044\nEstos hiperpriors controlan la variabilidad global de las tasas de especiaci√≥n y extinci√≥n:\n\nUn valor mayor permite m√°s cambios abruptos entre intervalos.\nUn valor menor suaviza las tasas a lo largo del tiempo.\n\nFunci√≥n setMRFGlobalScaleHyperpriorNShifts() del paquete RevGadgets en R para calcular el hiperprior autom√°ticamente.\n\n### Ejecutar en R, no agregar a RevBayes!!!\n### Calcula el hiperprior que utilizaremos en RevBayes\nlibrary(RevGadgets)\n## 10 numero intervalos\n## \"HSMRF\" Horseshoe Markov random field \nsetMRFGlobalScaleHyperpriorNShifts(10, \"HSMRF\")\n\n[1] 0.04446432\n\n\nAsignar distribuciones previas Half-Cauchy (dnHalfCauchy(0,1)) a los par√°metros de escala global, permite valores peque√±os pero tambi√©n acepta valores m√°s grandes ocasionalmente.\n# Distribuciones previas de Cauchy truncadas para los par√°metros de escala global\nspeciation_global_scale ~ dnHalfCauchy(0,1)\nextinction_global_scale ~ dnHalfCauchy(0,1)\nEn esta secci√≥n se definen las tasas iniciales de especiaci√≥n y extinci√≥n en el modelo HSMRF. En este enfoque, comenzamos con la tasa de especiaci√≥n y extinci√≥n en el presente y luego modelamos c√≥mo cambian hacia el pasado.\n# Definir tasas iniciales de especiaci√≥n y extinci√≥n en el presente\nlog_speciation_at_present ~ dnUniform(-10.0,10.0)\nlog_speciation_at_present.setValue(0.0)\nlog_extinction_at_present ~ dnUniform(-10.0,10.0)\nlog_extinction_at_present.setValue(-1.0)\n\n¬øPor qu√© se usa dnUniform(-10.0,10.0)?\nSe establece una distribuci√≥n uniforme como prior para las tasas iniciales de especiaci√≥n y extinci√≥n.\n\nComo estamos modelando las tasas en escala logar√≠tmica, esto implica que los valores de especiaci√≥n/extinci√≥n reales estar√°n entre:\n\n(e^{-10}) (casi 0, evoluci√≥n extremadamente lenta)\n(e^{10}) (tasa de diversificaci√≥n muy r√°pida)\n\nPermitir este rango amplio cubre la mayor√≠a de los valores posibles sin asumir un conocimiento previo espec√≠fico sobre la tasa de diversificaci√≥n en el presente.\n\n\n\n¬øPor qu√© los valores iniciales 0.0 y -1.0?\n\nlog_speciation_at_present.setValue(0.0): Equivale a establecer la tasa inicial de especiaci√≥n en ( e^0 = 1.0 ), lo cual es un punto razonable para comenzar.\nlog_extinction_at_present.setValue(-1.0): Equivale a una tasa inicial de extinci√≥n de ( e^{-1} ¬†approx 0.37 ), lo que implica que la extinci√≥n es menor que la especiaci√≥n en el punto de partida.\n\nMovimientos eficientes en MCMC para explorar estas tasas\nmoves.append( mvScaleBactrian(log_speciation_at_present,weight=5))\nmoves.append( mvScaleBactrian(log_extinction_at_present,weight=5))\nEn el c√≥digo de RevBayes para modelar la diversificaci√≥n epis√≥dica, se utiliza un bucle for para definir los cambios en las tasas de especiaci√≥n y extinci√≥n en cada intervalo de tiempo.\nfor (i in 1:NUM_BREAKS) {\n  # Variabilidad local en cada intervalo\n  sigma_speciation[i] ~ dnHalfCauchy(0,1)\n  sigma_extinction[i] ~ dnHalfCauchy(0,1)\n\n  # Se inicializan valores aleatorios en un rango de 0.005 a 0.1, para evitar valores extremos en el inicio del MCMC\n  sigma_speciation[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_extinction[i].setValue(runif(1,0.005,0.1)[1])\n\n  # Especificar los cambios en log-especiaci√≥n y log-extinci√≥n mediante una distribuci√≥n normal\n  delta_log_speciation[i] ~ dnNormal( mean=0, sd=sigma_speciation[i]*speciation_global_scale*speciation_global_scale_hyperprior )\n  delta_log_extinction[i] ~ dnNormal( mean=0, sd=sigma_extinction[i]*extinction_global_scale*extinction_global_scale_hyperprior )\n}\nCalcular las tasas de especiaci√≥n y extinci√≥n a lo largo del tiempo a partir de los cambios en log-escala.\nspeciation := fnassembleContinuousMRF(log_speciation_at_present, delta_log_speciation, initialValueIsLogScale=TRUE, order=1)\nextinction := fnassembleContinuousMRF(log_extinction_at_present, delta_log_extinction, initialValueIsLogScale=TRUE, order=1)\nMovimientos de MCMC para el Modelo HSMRF\n# Movimiento para los cambios en log-escala de especiaci√≥n y extinci√≥n\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_speciation, weight=5, tune=FALSE))\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_extinction, weight=5, tune=FALSE))\n\n# Movimiento Gibbs para los hiperpar√°metros globales y locales\nmoves.append(mvHSRFHyperpriorsGibbs(speciation_global_scale, sigma_speciation , delta_log_speciation , speciation_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\nmoves.append(mvHSRFHyperpriorsGibbs(extinction_global_scale, sigma_extinction , delta_log_extinction , extinction_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\n\n# Movimiento de intercambio entre intervalos adyacentes\nmoves.append(mvHSRFIntervalSwap(delta_log_speciation, sigma_speciation, weight=5))\nmoves.append(mvHSRFIntervalSwap(delta_log_extinction, sigma_extinction, weight=5))\nSe utilizan tres tipos principales de movimientos en este c√≥digo:\n\nMuestreo El√≠ptico Slice (mvEllipticalSliceSamplingSimple)\n\nOptimiza la exploraci√≥n de los cambios en log-escala de las tasas de especiaci√≥n y extinci√≥n.\nFunciona bien en modelos con alta correlaci√≥n entre par√°metros.\n\nMuestreo Gibbs (mvHSRFHyperpriorsGibbs)\n\nSe usa para actualizar los hiperpar√°metros globales y locales del modelo.\nPermite ajustes eficientes en la escala de variabilidad de las tasas.\n\nIntercambio de intervalos (mvHSRFIntervalSwap)\n\nIntercambia valores entre intervalos de tiempo adyacentes.\nAyuda a evitar que la cadena de MCMC se quede atrapada en un estado sub√≥ptimo.\n\n\nConfiguraci√≥n de los Intervalos de Tiempo\ninterval_times &lt;- abs(T.rootAge() * seq(1, NUM_BREAKS, 1)/NUM_INTERVALS)\n\nT.rootAge() ‚Üí Obtiene la edad de la ra√≠z del √°rbol filogen√©tico (es decir, el tiempo en el pasado en que el linaje com√∫n m√°s reciente existi√≥).\nseq(1, NUM_BREAKS, 1) ‚Üí Genera una secuencia de n√∫meros del 1 al NUM_BREAKS (el n√∫mero de puntos de cambio entre intervalos).\nMultiplica la ra√≠z del √°rbol T.rootAge() por esta secuencia para escalar los intervalos al tiempo evolutivo real.\nDivide entre NUM_INTERVALS para normalizar y hacer que los intervalos sean de igual tama√±o.\nabs(...) ‚Üí Convierte los valores a positivos porque las edades van en direcci√≥n del presente al pasado.\n\nCorrecci√≥n por Muestreo Incompleto\nrho &lt;- T.ntips()/26\nInicializando el Nodo Estoc√°stico del √Årbol de Tiempos\ntimetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)\nAsignando Datos Observados al √Årbol\ntimetree.clamp(T)\nCreando el Modelo Completo, Encuentra todas las conexiones en la red bayesiana y las agrupa en un solo objeto model()\nmymodel = model(rho)\nConfiguraci√≥n de los Monitores\nmonitors.append(mnModel(filename=\"../output/Eupomphini_EBD.log\", printgen=10, separator = TAB))\nCrea un monitor (mnModel) que guarda los valores de todos los par√°metros del modelo.\n‚úî Guarda los resultados en el archivo \"output/primates_EBD.log\".\n‚úî printgen=10 ‚Üí Especifica que se guardar√° un estado cada 10 generaciones.\n‚úî separator=TAB ‚Üí Usa tabulaciones para separar los valores en el archivo de salida.\nCreaci√≥n de Monitores para las Tasas de Especiaci√≥n y Extinci√≥n\n# Tasas de especiaci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_rates.log\", printgen=10, separator = TAB, speciation))\n\n# Intervalos de tiempo de especiaci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_times.log\", printgen=10, separator = TAB, interval_times))\n\n# Tasas de extinci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_rates.log\", printgen=10, separator = TAB, extinction))\n\n#Intervalos de tiempo de extinci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_times.log\", printgen=10, separator = TAB, interval_times))\nCreaci√≥n de un Monitor en Pantalla\nmonitors.append(mnScreen(printgen=1000, extinction_global_scale, speciation_global_scale))\nConfiguraci√≥n del MCMC\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\nCrea el objeto MCMC mymcmc que utilizar√°:\n\nmymodel ‚Üí El modelo definido anteriormente.\nmonitors ‚Üí Los monitores configurados.\nmoves ‚Üí Los movimientos de MCMC definidos antes.\nnruns=2 ‚Üí Ejecuta dos cadenas independientes de MCMC.\ncombine=\"mixed\" ‚Üí Mezcla las cadenas al final del proceso para mejorar la estimaci√≥n de par√°metros.\n\nEjecutar el MCMC\nmymcmc.run(generations=50000, tuningInterval=200)\nVisualizaci√≥n de las tasas de diversificaci√≥n\nFinalmente, generamos un gr√°fico que muestra c√≥mo las tasas de especiaci√≥n y extinci√≥n han cambiado a lo largo del tiempo.\n\nlibrary(RevGadgets)\n\n# Especificar la ruta de los archivos de salida \nspeciation_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_times.log\"\nspeciation_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_rates.log\"\nextinction_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_times.log\"\nextinction_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_rates.log\"\n\n# Leer y procesar los datos\nrates &lt;- processDivRates(speciation_time_log = speciation_time_file,\n                         speciation_rate_log = speciation_rate_file,\n                         extinction_time_log = extinction_time_file,\n                         extinction_rate_log = extinction_rate_file,\n                         burnin = 0.25, # Se descarta el 25% inicial de las iteraciones como burn-in\n                         summary = \"median\")  # Se toman las tasas medianas como resumen\n\n# Graficar las tasas atravez del tiempo\np &lt;- plotDivRates(rates = rates) +\n  xlab(\"Millions of years ago\") +\n  ylab(\"Rate per million years\")\n\np",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n parte 2</span>"
    ]
  }
]