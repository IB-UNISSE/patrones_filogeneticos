[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Patrones filogen√©ticos: macroevoluci√≥n y adaptaci√≥n",
    "section": "",
    "text": "Presentaci√≥n del Curso: Patrones Filogen√©ticos, Macroevoluci√≥n y Adaptaci√≥n\nHaz clic en la imagen para ver el PDF de la presentaci√≥n del curso",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "index.html#unidad-1-patrones-de-diversificaci√≥n",
    "href": "index.html#unidad-1-patrones-de-diversificaci√≥n",
    "title": "Patrones filogen√©ticos: macroevoluci√≥n y adaptaci√≥n",
    "section": "Unidad 1: Patrones de diversificaci√≥n",
    "text": "Unidad 1: Patrones de diversificaci√≥n\n\nIntroducci√≥n al proceso de diversificaci√≥n\nModelos con cambios en las Tasas de diversificaci√≥n\nEstimaci√≥n de Eventos de Extinci√≥n Masiva\nIntroducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "crumbs": [
      "<span class='chapter-number'>1</span>¬† <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "chapters/install.html",
    "href": "chapters/install.html",
    "title": "Instalaci√≥n de Software",
    "section": "",
    "text": "Introducci√≥n\nEste es el manual para la instalaci√≥n de los programas que se utilizar√°n durante el curso Patrones filogen√©ticos: macroevoluci√≥n y adaptaci√≥n. Los programas seleccionados son herramientas esenciales para el desarrollo de an√°lisis y actividades dentro del curso.\nLos programas a instalar incluyen:\nA continuaci√≥n, se presentan las instrucciones detalladas para instalar y configurar cada uno de estos programas, asegurando que los participantes cuenten con todas las herramientas necesarias para aprovechar al m√°ximo el curso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n",
    "href": "chapters/install.html#descripci√≥n",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nVisual Studio Code (VS Code) es un editor de c√≥digo fuente ligero pero potente, desarrollado por Microsoft. Es compatible con varios lenguajes de programaci√≥n y ofrece caracter√≠sticas como autocompletado de c√≥digo, depuraci√≥n integrada, control de versiones con Git y una amplia variedad de extensiones que permiten personalizar y ampliar su funcionalidad.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalaci√≥n",
    "href": "chapters/install.html#pasos-de-instalaci√≥n",
    "title": "Instalaci√≥n de Software",
    "section": "Pasos de instalaci√≥n",
    "text": "Pasos de instalaci√≥n\n\nDescargar el instalador:\n\nVe al sitio oficial de Visual Studio Code: https://code.visualstudio.com/.\nHaz clic en el bot√≥n para descargar el archivo ejecutable.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado (por lo general, estar√° en la carpeta Descargas).\nHaz doble clic en el archivo para iniciar el asistente de instalaci√≥n.\n\nConfigurar las opciones de instalaci√≥n:\n\nAcepta los t√©rminos y condiciones.\nElige una carpeta de instalaci√≥n o deja la predeterminada.\nSelecciona las opciones adicionales como:\n\nCrear un √≠cono en el escritorio.\nAgregar ‚ÄúCode‚Äù al men√∫ contextual para abrir archivos y carpetas.\nRegistrar el programa como editor por defecto de ciertos archivos.\n\n\nCompletar la instalaci√≥n:\n\nHaz clic en ‚ÄúInstalar‚Äù.\nEspera a que el proceso finalice y haz clic en ‚ÄúFinalizar‚Äù para abrir Visual Studio Code.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n-1",
    "href": "chapters/install.html#descripci√≥n-1",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nR es un lenguaje de programaci√≥n y software para el an√°lisis estad√≠stico y la visualizaci√≥n de datos. RStudio es un entorno de desarrollo integrado (IDE) que facilita trabajar con R gracias a su interfaz amigable y herramientas adicionales como depuraci√≥n de c√≥digo, manejo de proyectos y soporte para Markdown.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalaci√≥n-1",
    "href": "chapters/install.html#pasos-de-instalaci√≥n-1",
    "title": "Instalaci√≥n de Software",
    "section": "Pasos de instalaci√≥n",
    "text": "Pasos de instalaci√≥n\n\nInstalaci√≥n de R\n\nDescargar el instalador:\n\nVe al sitio oficial de CRAN: https://cran.r-project.org/.\nSelecciona ‚ÄúDownload R for Windows‚Äù y luego ‚Äúbase‚Äù.\nHaz clic en el enlace para descargar el instalador m√°s reciente.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente, aceptando los valores predeterminados a menos que necesites personalizar la instalaci√≥n.\n\nCompletar la instalaci√≥n:\n\nHaz clic en ‚ÄúFinalizar‚Äù al terminar el proceso.\n\n\n\n\nInstalaci√≥n de RStudio\n\nDescargar el instalador:\n\nVe al sitio oficial de RStudio: https://posit.co/download/rstudio-desktop/.\nDescarga la versi√≥n gratuita de RStudio Desktop.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente de instalaci√≥n.\n\nCompletar la instalaci√≥n:\n\nHaz clic en ‚ÄúFinalizar‚Äù al terminar el proceso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n-2",
    "href": "chapters/install.html#descripci√≥n-2",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nRevBayes es un software dise√±ado para realizar an√°lisis filogen√©ticos avanzados utilizando m√©todos bayesianos. Ofrece flexibilidad para modelar procesos evolutivos complejos y es ampliamente utilizado en investigaciones de filogen√©tica y macroevoluci√≥n.\nPara instalar RevBayes en Windows, utilizaremos Ubuntu mediante Windows Subsystem for Linux (WSL).",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-la-virtualizaci√≥n-est√°-habilitada",
    "href": "chapters/install.html#verificar-si-la-virtualizaci√≥n-est√°-habilitada",
    "title": "Instalaci√≥n de Software",
    "section": "1. Verificar si la virtualizaci√≥n est√° habilitada",
    "text": "1. Verificar si la virtualizaci√≥n est√° habilitada\n\nAbrir el Administrador de Tareas:\n\nPresiona Ctrl + Shift + Esc para abrir el Administrador de Tareas.\nVe a la pesta√±a Rendimiento y selecciona CPU.\nEn la esquina inferior derecha, verifica si la opci√≥n ‚ÄúVirtualizaci√≥n‚Äù est√° habilitada.\n\n\n\n\n\n\nHabilitar la virtualizaci√≥n (si est√° deshabilitada):\n\nReinicia tu computadora y accede al BIOS/UEFI.\nPara procesadores Intel, busca una opci√≥n como ‚ÄúIntel Virtualization Technology‚Äù o ‚ÄúVT-x‚Äù y act√≠vala.\nPara procesadores AMD, busca ‚ÄúSVM Mode‚Äù o una opci√≥n similar y act√≠vala.\nGuarda los cambios y reinicia.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-wsl-est√°-instalado-y-actualizado",
    "href": "chapters/install.html#verificar-si-wsl-est√°-instalado-y-actualizado",
    "title": "Instalaci√≥n de Software",
    "section": "2. Verificar si WSL est√° instalado y actualizado",
    "text": "2. Verificar si WSL est√° instalado y actualizado\n\nAbrir PowerShell como administrador\n\nPresiona Win + X y selecciona ‚ÄúWindows PowerShell (Admin)‚Äù.\nEjecuta el siguiente comando para verificar si WSL est√° instalado y funcionando:\nwsl --status\nSi el comando muestra un error o indica que WSL no est√° disponible, sigue el Paso 3 para instalarlo desde cero.\nSi WSL ya est√° habilitado, pasa al Paso 4 para actualizarlo y asegurarte de que est√© en la versi√≥n 2.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-wsl-desde-cero-si-no-est√°-disponible",
    "href": "chapters/install.html#instalar-wsl-desde-cero-si-no-est√°-disponible",
    "title": "Instalaci√≥n de Software",
    "section": "3. Instalar WSL desde cero (si no est√° disponible)",
    "text": "3. Instalar WSL desde cero (si no est√° disponible)\nSi wsl --status muestra un error, sigue estos pasos para habilitar WSL desde cero:\n\nAbrir PowerShell como administrador y ejecutar los siguientes comandos:\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\nReiniciar la computadora para aplicar los cambios.\nVerificar la instalaci√≥n:\n\nEjecuta nuevamente:\nwsl --status\nSi el comando muestra que WSL est√° instalado correctamente puedes proceder con el paso 4.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#actualizar-wsl-y-establecer-la-versi√≥n-por-defecto",
    "href": "chapters/install.html#actualizar-wsl-y-establecer-la-versi√≥n-por-defecto",
    "title": "Instalaci√≥n de Software",
    "section": "4. Actualizar WSL y establecer la versi√≥n por defecto",
    "text": "4. Actualizar WSL y establecer la versi√≥n por defecto\nSi WSL ya estaba habilitado, sigue estos pasos para actualizarlo y asegurarte de que est√© en la versi√≥n 2:\n\nActualizar el kernel de WSL 2 (en caso de que se necesite)\n\nDescarga la actualizaci√≥n oficial desde Microsoft: Descargar actualizaci√≥n de WSL-2\nGuarda el archivo wsl_update_x64.msi en tu computadora.\nEjecuta el archivo descargado y sigue las instrucciones de instalaci√≥n.\nUna vez instalado, reinicia tu computadora.\n\nConfigurar WSL para usar la versi√≥n 2\n\nAbre PowerShell como administrador y ejecuta:\nwsl --set-default-version 2\nEsto asegurar√° que todas las distribuciones nuevas de Linux usen WSL 2 por defecto.\n\nInstalaci√≥n de Ubuntu:\n\nUna vez reiniciado el equipo, abre PowerShell como administrador y ejecuta:\nwsl --install -d Ubuntu\nEsto instalar√° autom√°ticamente WSL2 y descargar√° la distribuci√≥n de Ubuntu m√°s reciente,\nEn caso de que no se instale, descarga Ubuntu (se recomienda la versi√≥n 22.04) desde la aplicaci√≥n de Microsoft Store e inst√°lala manualmente.\n\nEstablecer el usuario por defecto en WSL\n\nAseg√∫rate de que WSL est√© configurado para que siempre uses tu usuario por defecto y no root:\nwsl -d Ubuntu --user tu_usuario\nSi no recuerdas que verion de Ubuntu tines instalada, usa:\nwsl -l -v\nSi no recuerdas tu usuario en WSL, usa:\nwhoami\n\nConfigurar Ubuntu:\n\nAbre Ubuntu desde el men√∫ de inicio.\nCrea un nombre de usuario y contrase√±a cuando se te solicite.\n\n\n\n\n\n\nAcceder a la carpeta de usuario de Windows:\n\nVerifica si la ruta existe:\n\nls \"/mnt/c/Users/\"\n\nVerifica tu nombre de usuario:\n\nls \"/mnt/c/Users/mi_usuario\"\n\nCrear un alias en ~/.bashrc:\n\nnano ~/.bashrc\n\nAgrega esta l√≠nea al final del archivo:\n\nalias homepatron='cd \"/mnt/c/Users/mi_usuario\"'\n\nGuarda (CTRL + X, luego Y y Enter) y actualiza:\n\nsource ~/.bashrc\n\nAhora podr√°s ejecutar:\n\nhomepatron",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "href": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "title": "Instalaci√≥n de Software",
    "section": "Instalar RevBayes en Ubuntu",
    "text": "Instalar RevBayes en Ubuntu\n\nActualizar paquetes:\n\nEjecuta:\nsudo apt update && sudo apt upgrade -y\n\nDescargar RevBayes:\n\nUsa el siguiente comando para descargar la versi√≥n 1.2.5:\nwget https://github.com/revbayes/revbayes/releases/download/v1.2.5/revbayes-v1.2.5-linux64.tar.gz\n\nInstalar RevBayes:\n\nExtrae el archivo descargado y navega a la carpeta:\ntar -xzf revbayes-v1.2.5-linux64.tar.gz\ncd revbayes-v1.2.5/bin\nHaz que el ejecutable sea ejecutable:\nchmod +x rb\n\nAgregar RevBayes al PATH:\n\nPara que rb est√© disponible en cualquier sesi√≥n de Ubuntu, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/revbayes-v1.2.5/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto permitir√° ejecutar rb desde cualquier directorio en futuras sesiones de terminal.\n\nVerificar la instalaci√≥n:\n\nEjecuta el programa:\nrb\nDeber√≠as ver la interfaz de l√≠nea de comandos de RevBayes.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripci√≥n-3",
    "href": "chapters/install.html#descripci√≥n-3",
    "title": "Instalaci√≥n de Software",
    "section": "Descripci√≥n",
    "text": "Descripci√≥n\nBAMM es un software dise√±ado para analizar tasas de diversificaci√≥n y evoluci√≥n de rasgos en filogenias de gran tama√±o. Utiliza m√©todos bayesianos para estimar patrones heterog√©neos de evoluci√≥n y es ampliamente utilizado en estudios de macroevoluci√≥n.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalaci√≥n-de-bamm-en-ubuntu-wsl-o-nativo",
    "href": "chapters/install.html#instalaci√≥n-de-bamm-en-ubuntu-wsl-o-nativo",
    "title": "Instalaci√≥n de Software",
    "section": "Instalaci√≥n de BAMM en Ubuntu (WSL o nativo)",
    "text": "Instalaci√≥n de BAMM en Ubuntu (WSL o nativo)\n\nActualizar el sistema y dependencias:\n\nEjecuta los siguientes comandos para asegurarte de que el sistema est√© actualizado y las dependencias necesarias est√©n instaladas:\nsudo apt update && sudo apt upgrade -y\nsudo apt install git build-essential cmake libgsl-dev -y\n\nClonar el repositorio de BAMM:\n\nClona el repositorio oficial de BAMM desde GitHub:\ngit clone https://github.com/macroevolution/bamm.git\n\nCrear el directorio de compilaci√≥n:\n\nNavega al directorio ra√≠z del proyecto, crea un directorio llamado build y accede a √©l:\ncd bamm\nmkdir build\ncd build\n\nCompilar BAMM:\n\nEjecuta los siguientes comandos para compilar BAMM:\ncmake ..\nmake -j\nEl ejecutable final se generar√° con el nombre bamm dentro del directorio build.\n\nAgregar BAMM al PATH:\n\nPara que el ejecutable bamm est√© disponible desde cualquier directorio, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/bamm/build:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto asegurar√° que puedas ejecutar bamm desde cualquier lugar en futuras sesiones.\n\nVerificar la instalaci√≥n:\n\nAseg√∫rate de que BAMM est√© correctamente instalado ejecutando:\nbamm -h\nDeber√≠as ver la pantalla de ayuda de BAMM.",
    "crumbs": [
      "<span class='chapter-number'>2</span>¬† <span class='chapter-title'>Instalaci√≥n de Software</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html",
    "href": "chapters/commandline.html",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "",
    "text": "Comandos b√°sicos en Bash",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#navegaci√≥n-en-el-sistema-de-archivos",
    "href": "chapters/commandline.html#navegaci√≥n-en-el-sistema-de-archivos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "1. Navegaci√≥n en el sistema de archivos",
    "text": "1. Navegaci√≥n en el sistema de archivos\n\n\n\n\n\n\npwd ‚Üí Muestra el directorio actual.\npwd\nls ‚Üí Lista los archivos y carpetas en el directorio actual.\nls -l     # Muestra detalles (permisos, due√±o, tama√±o, fecha)\nls -a     # Muestra archivos ocultos\nls -h     # Muestra tama√±os en formato legible \ncd ‚Üí Cambia de directorio.\ncd /   # Ir a la raiz\ncd /home/usuario/proyecto/data # ir a la carpeta data ruta absoluta\ncd data/ # ir a la carpeta data ruta relativa\ncd ..      # Subir un nivel",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#manipulaci√≥n-de-archivos-y-directorios",
    "href": "chapters/commandline.html#manipulaci√≥n-de-archivos-y-directorios",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "2. Manipulaci√≥n de archivos y directorios",
    "text": "2. Manipulaci√≥n de archivos y directorios\n\nmkdir ‚Üí Crea un directorio.\nmkdir nueva_carpeta\nrm ‚Üí Borra archivos y carpetas.\nrm archivo.txt        # Borra un archivo\nrm -r carpeta         # Borra una carpeta y su contenido\nrm -i archivo.txt     # Pregunta antes de borrar\ncp ‚Üí Copia archivos o carpetas.\ncp archivo.txt copia.txt   # Copia un archivo\ncp -r carpeta destino/     # Copia una carpeta\nmv ‚Üí Mueve o renombra archivos y carpetas.\nmv archivo.txt nueva_ubicacion/\nmv archivo.txt nuevo_nombre.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#visualizaci√≥n-y-edici√≥n-de-archivos",
    "href": "chapters/commandline.html#visualizaci√≥n-y-edici√≥n-de-archivos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "3. Visualizaci√≥n y edici√≥n de archivos",
    "text": "3. Visualizaci√≥n y edici√≥n de archivos\n\ncat ‚Üí Muestra el contenido de un archivo.\ncat archivo.txt\nless ‚Üí Permite visualizar archivos grandes de manera interactiva.\nless archivo.txt   # Usa las teclas ‚Üë ‚Üì para moverte, \"q\" para salir\nnano ‚Üí Editor de texto en terminal.\nnano archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#limpiar-la-terminal",
    "href": "chapters/commandline.html#limpiar-la-terminal",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "4. Limpiar la terminal",
    "text": "4. Limpiar la terminal\n\nclear ‚Üí Borra la pantalla de la terminal, pero no elimina procesos ni historial.\nclear\nCtrl + L ‚Üí Hace lo mismo que clear, pero sin ejecutar un comando expl√≠cito.\n\nEn macOS: Cmd + K tambi√©n limpia la terminal.",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#historial-de-comandos",
    "href": "chapters/commandline.html#historial-de-comandos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "5. Historial de comandos",
    "text": "5. Historial de comandos\n\nC√≥mo moverse en el historial\n\n‚Üë (Flecha arriba) ‚Üí Muestra el √∫ltimo comando ejecutado.\n‚Üì (Flecha abajo) ‚Üí Avanza en la lista de comandos previos.\nCtrl + R ‚Üí B√∫squeda r√°pida en el historial. Escribe parte del comando y pulsa Enter cuando encuentres el que necesitas.\n\nEjemplo: Presiona Ctrl + R y escribe nano, mostrar√° el √∫ltimo comando que usaste con nano.\n\n\nhistory ‚Üí Muestra los √∫ltimos comandos ejecutados.\nhistory\nBuscar en el historial r√°pidamente con grep\nhistory | grep ls   # Filtra los comandos que contienen \"ls\"\nhistory | grep nano # Filtra los comandos con \"nano\"",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "href": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "6. Permisos y propiedades de archivos",
    "text": "6. Permisos y propiedades de archivos\n\nchmod ‚Üí Cambia permisos de ejecucion.\nchmod +x script.Rev  # Permisos de ejecuci√≥n\nchown ‚Üí Cambia el due√±o de un archivo.\nsudo chown usuario archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "href": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "title": "Apuntes sobre comandos b√°sicos en Bash",
    "section": "Iniciar Ubuntu en la terminal de VS Code.",
    "text": "Iniciar Ubuntu en la terminal de VS Code.\n\nAbre VS Code y ve a Extensions (Ctrl + Shift + X)\n\n\n\n\n\nBusca WSL e instala la extensi√≥n oficial de Microsoft.\n\n\n\n\n\nTeclea el comando Ctrl + Shift + P y selecciona WSL: Connect to WSL\n\n\n\n\n\nSe abrir√° una nueva ventana, ve a **Terminal** y selecciona una nueva **Terminal**\n\n\n\n\n\nEn la parte inferior se abrir√° la terminal de Ubuntu",
    "crumbs": [
      "<span class='chapter-number'>3</span>¬† <span class='chapter-title'>Apuntes sobre comandos b√°sicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html",
    "href": "chapters/Rstudio.html",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "¬øQu√© es R y qu√© es RStudio?",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#qu√©-es-r-y-qu√©-es-rstudio",
    "href": "chapters/Rstudio.html#qu√©-es-r-y-qu√©-es-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "R es un lenguaje de programaci√≥n enfocado en el an√°lisis de datos y estad√≠sticas.\nRStudio es un entorno de desarrollo integrado (IDE) que facilita el trabajo con R y permite organiza los proyectos y facilita la ejecuci√≥n de c√≥digo, la visualizaci√≥n de gr√°ficos y la gesti√≥n de paquetes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#partes-de-rstudio",
    "href": "chapters/Rstudio.html#partes-de-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Partes de RStudio",
    "text": "Partes de RStudio\nRStudio tiene cuatro paneles principales:\n\nConsole: Donde se ejecuta el c√≥digo en tiempo real.\n\n\n\n\n\nEditor de scripts: Para escribir y guardar c√≥digo en archivos .r, .R o .Rmd.\n\n\n\n\n\nEnvironment/History: Muestra variables y comandos previos.\n\n\n\n\n\nFiles/Plots/Packages/Help: Para manejar archivos, visualizar gr√°ficos, instalar programas y acceder a documentaci√≥n.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#creaci√≥n-de-un-proyecto-en-rstudio",
    "href": "chapters/Rstudio.html#creaci√≥n-de-un-proyecto-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Creaci√≥n de un Proyecto en RStudio",
    "text": "Creaci√≥n de un Proyecto en RStudio\nBeneficios de trabajar con proyectos:\n\nOrganizaci√≥n de archivos y c√≥digo.\nFacilita la reproducibilidad.\nEvita problemas con rutas de archivos.\n\nPara crear un proyecto:\n\nEn RStudio, ir a File &gt; New Project.\n\n\n\n\n\nElegir un directorio nuevo o existente.\n\n\n\n\n\nTrabajar siempre dentro del proyecto para evitar problemas de rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#organizaci√≥n-de-proyectos-en-rstudio",
    "href": "chapters/Rstudio.html#organizaci√≥n-de-proyectos-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Organizaci√≥n de Proyectos en RStudio",
    "text": "Organizaci√≥n de Proyectos en RStudio\nMantener una estructura organizada en los proyectos es clave para la reproducibilidad y eficiencia. Se recomienda la siguiente estructura de carpetas:\nproyecto/\n‚îÇ‚îÄ‚îÄ data/         # Datos crudos y procesados\n‚îÇ‚îÄ‚îÄ scripts/      # C√≥digo fuente en R\n‚îÇ‚îÄ‚îÄ output/       # Resultados y gr√°ficos\n‚îÇ‚îÄ‚îÄ reports/      # Documentaci√≥n y reportes\n‚îÇ‚îÄ‚îÄ README.md     # Descripci√≥n del proyecto\nAdem√°s, para lograr una nomenclatura eficiente y consistente en archivos, se pueden seguir algunas pautas:\n\nConsistencia: Usar un esquema de nombres consistente en todo el proyecto.\nEvitar Espacios: Usar guiones bajos (_) o guiones (-) en lugar de espacios.\nPrefijos y Sufijos: Usar prefijos y sufijos estandarizados para identificar el estado o versi√≥n del archivo.\nEvitar Acentos y Caracteres Especiales: No utilizar acentos, e√±es ni caracteres especiales que puedan causar problemas de compatibilidad en diferentes sistemas operativos o herramientas de software.\n\nEjemplos:\nbears_cytb.nex\ntree_BD.Rev\nmultifig.R\nqw_feature2.csv",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "href": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Rutas Absolutas y Relativas",
    "text": "Rutas Absolutas y Relativas\nLas rutas de archivos en R pueden ser absolutas o relativas:\n\nRuta absoluta: Define la ubicaci√≥n exacta de un archivo, por ejemplo:\nread.csv(\"C:/Users/TuUsuario/Documents/data/datos.csv\")\nRuta relativa: Se basa en la ubicaci√≥n del proyecto:\nread.csv(\"data/datos.csv\")\n\nSiempre es recomendable usar proyectos para evitar errores con rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#principales-objetos-en-r",
    "href": "chapters/Rstudio.html#principales-objetos-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Principales Objetos en R",
    "text": "Principales Objetos en R\n\nVectores\nx &lt;- c(1, 2, 3, 4, 5)\nprint(x)\n\n\nMatrices\nm &lt;- matrix(1:9, nrow=3)\nprint(m)\n\n\nData Frames\ndf &lt;- data.frame(Nombre=c(\"A\", \"B\", \"C\"), Edad=c(25, 30, 22))\nprint(df)\n\n\nListas\nlista &lt;- list(Nombre=\"Juan\", Edad=30, Notas=c(8, 9, 10))\nprint(lista)",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#asignaci√≥n-de-variables",
    "href": "chapters/Rstudio.html#asignaci√≥n-de-variables",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Asignaci√≥n de Variables",
    "text": "Asignaci√≥n de Variables\nDiferencia entre &lt;- y =:\na &lt;- 10   # Recomendado para asignaciones\nb = 20    # Tambi√©n funciona, pero es mejor evitarlo",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "href": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Uso de Funciones en R",
    "text": "Uso de Funciones en R\nEjemplo de funciones b√°sicas:\nnumeros &lt;- c(1, 2, 3, 4, 5)\nmean(numeros)  # Media\nsummary(numeros)  # Resumen estad√≠stico",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#instalaci√≥n-y-uso-de-paquetes",
    "href": "chapters/Rstudio.html#instalaci√≥n-y-uso-de-paquetes",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Instalaci√≥n y Uso de Paquetes",
    "text": "Instalaci√≥n y Uso de Paquetes\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\nhelp(ggplot2)  # Consultar documentaci√≥n",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "href": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Acceder a los archivos de Ubuntu en RStudio",
    "text": "Acceder a los archivos de Ubuntu en RStudio\n\nEjecuta el siguiente comando en PowerShell:\nwsl.exe wslpath -w ~\nMostrar√° una direcci√≥n como la que se muestra:\n\\\\wsl.localhost\\Ubuntu\\home\\tu_usuario\nEn RStudio puedes establecer el directorio de trabajo en la carpeta de Ubuntu (WSL) usando setwd(). Ten cuidado en las diuagonales, en powershell las diagonales son invertidas * y cuando las utilices en R utiliza las diagonales normales /*:\nsetwd(\"//wsl.localhost/Ubuntu/home/tu_usuario/mi_proyecto\")",
    "crumbs": [
      "<span class='chapter-number'>4</span>¬† <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html",
    "href": "chapters/revbayes.html",
    "title": "Apuntes sobre RevBayes",
    "section": "",
    "text": "Introducci√≥n a la Inferencia Bayesiana\nLa inferencia bayesiana es un enfoque de la estad√≠stica que permite actualizar nuestras creencias sobre un par√°metro desconocido a medida que obtenemos nueva informaci√≥n. Se basa en el Teorema de Bayes, que nos dice c√≥mo combinar la informaci√≥n previa con la evidencia observada.\nEl Teorema de Bayes se expresa matem√°ticamente como:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nEl objetivo de la inferencia bayesiana es calcular la distribuci√≥n posterior, que nos proporciona una estimaci√≥n m√°s precisa del par√°metro \\(\\theta\\) al incorporar tanto datos como conocimiento previo.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#por-qu√©-se-necesita-mcmc",
    "href": "chapters/revbayes.html#por-qu√©-se-necesita-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¬øPor qu√© se necesita MCMC?",
    "text": "¬øPor qu√© se necesita MCMC?\nEn inferencia bayesiana, la distribuci√≥n posterior de un par√°metro \\(\\theta\\) se calcula usando:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nPero en la pr√°ctica, el denominador \\(P(D)\\) es dif√≠cil de calcular, ya que requiere integrar sobre todos los valores posibles de \\(\\theta\\):\n\\[\nP(D) = \\int P(D | \\theta) P(\\theta) d\\theta\n\\]\nCuando el espacio de par√°metros es muy grande, esta integral es imposible de resolver anal√≠ticamente. MCMC nos ayuda a aproximar la distribuci√≥n posterior sin necesidad de calcular \\(P(D)\\).",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#c√≥mo-funciona-mcmc",
    "href": "chapters/revbayes.html#c√≥mo-funciona-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¬øC√≥mo funciona MCMC?",
    "text": "¬øC√≥mo funciona MCMC?\nMCMC simula valores de los par√°metros siguiendo estos pasos:\n\nEmpieza en un valor inicial .\nPropone un nuevo valor basado en una distribuci√≥n de transici√≥n.\nDecide si acepta o rechaza seg√∫n la regla de aceptaci√≥n.\nRepite el proceso muchas veces para construir una cadena de valores que sigan la distribuci√≥n posterior.\n\nüîπ Importante:\nCon suficientes iteraciones, la cadena converge a la distribuci√≥n posterior, permitiendo estimar par√°metros de manera precisa.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#m√©todos-populares-de-mcmc",
    "href": "chapters/revbayes.html#m√©todos-populares-de-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "M√©todos populares de MCMC",
    "text": "M√©todos populares de MCMC\nExisten varias formas de implementar MCMC. Las m√°s comunes son:\n‚úÖ 1. Algoritmo de Metropolis-Hastings\n\nPropone un nuevo valor \\(\\theta^*\\).\nDecide si lo acepta o no comparando la raz√≥n de aceptaci√≥n:\n\\[\nr = \\frac{P(D | \\theta^*) P(\\theta^*)}{P(D | \\theta) P(\\theta)}\n\\]\n\nSi \\(r \\geq 1\\), acepta \\(\\theta^*\\).\nSi \\(r &lt; 1\\), acepta \\(\\theta^*\\) con probabilidad \\(r\\).\n\n\nSe usa cuando no se conoce la forma exacta de la distribuci√≥n posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#c√≥mo-saber-si-una-cadena-ha-convergido",
    "href": "chapters/revbayes.html#c√≥mo-saber-si-una-cadena-ha-convergido",
    "title": "Apuntes sobre RevBayes",
    "section": "¬øC√≥mo saber si una cadena ha convergido?",
    "text": "¬øC√≥mo saber si una cadena ha convergido?\n\n\n\n\n\nAlgunas t√©cnicas comunes para evaluar la convergencia incluyen:\n\nInspecci√≥n visual de trazas: un gr√°fico de trazas muestra si la cadena ha alcanzado un comportamiento estable sin tendencias obvias.\nTama√±o de muestra efectivo (Effective Sample Size, ESS): Dado que las muestras en MCMC est√°n correlacionadas, el n√∫mero real de muestras independientes es menor que el n√∫mero total de iteraciones. El tama√±o de muestra efectivo (ESS) estima cu√°ntas muestras independientes equivalentes hay en la cadena.\n\nSe calcula como:\n\\[\nESS = \\frac{N}{1 + 2 \\sum \\rho_k}\n\\]\nDonde \\(N\\) es el n√∫mero total de iteraciones y \\(\\rho_k\\) es la autocorrelaci√≥n en el retraso \\(k\\). Un ESS alto (\\(ESS &gt; 200\\)) indica que la cadena ha explorado bien el espacio de par√°metros y proporciona estimaciones confiables.\nUn ESS bajo sugiere que las muestras est√°n altamente correlacionadas y que se necesitan m√°s iteraciones o una mejor parametrizaci√≥n del algoritmo para obtener estimaciones m√°s precisas.\nPara visualizar estos valores y generar gr√°ficos, se puede utilizar Tracer, una herramienta que facilita el an√°lisis de convergencia de cadenas MCMC. Se puede descargar en el siguiente enlace:\nTracer v1.7.2",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "href": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "Tipos de Nodos en RevBayes",
    "text": "Tipos de Nodos en RevBayes\n\nüëâ Nodos Constantes\nSon valores fijos dentro del modelo. No tienen incertidumbre.\nn = 10  # N√∫mero de observaciones\n\n\nüëâ Nodos Estoc√°sticos\nRepresentan variables aleatorias con una distribuci√≥n. Son los par√°metros del modelo.\ntheta ~ dnBeta(2,2)  # Prior Beta(2,2)\nEn este caso, theta es una variable aleatoria con una distribuci√≥n Beta.\n\n\nüëâ Nodos Deterministas\nSon valores calculados a partir de otros nodos.\nmu := theta * n  # Media esperada\nAqu√≠, mu se calcula a partir de theta y n.\n\n\nüëâ Nodos Clamped (Observados)\nSe utilizan para fijar valores observados en el modelo.\nD ~ dnBinomial(n, theta)  # Modelo Binomial\nD.clamp(7)  # Observamos 7 √©xitos\nEn este caso, D es una variable aleatoria Binomial, pero la fijamos en 7.\n\n\nüëâ Nodos Plate\nLos plates se usan para repetir estructuras en modelos jer√°rquicos.\nfor (i in 1:10) {\n    theta[i] ~ dnBeta(2,2)\n}\nAqu√≠, estamos creando 10 valores de theta, cada uno con una distribuci√≥n Beta(2,2).",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "href": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "üîπ 1. Definiendo el Modelo en RevBayes",
    "text": "üîπ 1. Definiendo el Modelo en RevBayes\n\nüìå Distribuci√≥n Prior\nAntes de ver los datos, asumimos una creencia previa sobre la probabilidad ( p ).\nUtilizamos una distribuci√≥n Beta(8,2), basada en la suposici√≥n de que aproximadamente el 80% de las personas disfrutar√°n del ambiente.\n\\[\np \\sim \\text{Beta}(8,2)\n\\]\nP√°gina para visualizar las distribuciones para RevBayes, pega el siguiente c√≥digo en Rev code:\nx ~ dnBeta(8, 2)\nLa media de esta distribuci√≥n es:\n\\[\nE[p] = \\frac{\\alpha}{\\alpha + \\beta} = \\frac{8}{8+2} = 0.8\n\\]\n\n\n\nüìå Verosimilitud (Likelihood)\nLa verosimilitud describe la probabilidad de observar los datos dados un valor espec√≠fico de ( p ).\nComo cada estudiante puede estar satisfecho (√©xito) o insatisfecho (fracaso), usamos una distribuci√≥n Binomial:\n\\[\nk \\sim \\text{Binomial}(n = 10, p)\n\\]\nDonde: - ( k = 7 ) es el n√∫mero de estudiantes satisfechos observados. - ( n = 10 ) es el n√∫mero total de encuestados.\n\n\n\nüìå Posterior Bayesiana\nAplicamos el Teorema de Bayes:\n\\[\nP(p | D) \\propto P(D | p) P(p)\n\\]\nDado que usamos un prior Beta y una verosimilitud Binomial, la posterior tambi√©n sigue una distribuci√≥n Beta con par√°metros actualizados:\n\\[\np | D \\sim \\text{Beta}(8+7, 2+3) = \\text{Beta}(15,5)\n\\]\nLa media de la posterior nos da la mejor estimaci√≥n despu√©s de observar los datos:\n\\[\nE[p] = \\frac{15}{15 + 5} = 0.75\n\\]\nEsto significa que, despu√©s de observar que 7 de 10 estudiantes disfrutaron el ambiente, nuestra mejor estimaci√≥n de la probabilidad de que t√∫ disfrutes del ambiente es 75%.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#c√≥digo-en-revbayes",
    "href": "chapters/revbayes.html#c√≥digo-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "üîπ 2. C√≥digo en RevBayes",
    "text": "üîπ 2. C√≥digo en RevBayes\nA continuaci√≥n, presentamos el c√≥digo en RevBayes para implementar este modelo y ejecutar un an√°lisis MCMC.\n\n\n\n\n\n# ------------------------------------------------\n# RevBayes - Algoritmo de Metropolis-Hastings para estimar\n# la probabilidad de disfrutar el ambiente en las micheladas de Tepito\n# ------------------------------------------------\n\n# Datos observados\ntotal_clientes &lt;- 10  # N√∫mero total de encuestados\nsatisfechos &lt;- 7      # N√∫mero de estudiantes que disfrutaron el ambiente\n\n# Especificar la distribuci√≥n prior\nalpha &lt;- 8   # Basado en la creencia previa de 80% satisfacci√≥n\nbeta  &lt;- 2   # Complemento del prior\np ~ dnBeta(alpha, beta)  # Prior Beta(8,2)\n\n# Definir la propuesta de MCMC con Metropolis-Hastings\nmoves[1] = mvSlide(p, delta=0.1, weight=1)  # Movimiento en la distribuci√≥n de p\n\n# Especificar el modelo de verosimilitud (distribuci√≥n Binomial)\nk ~ dnBinomial(p, total_clientes)\nk.clamp(satisfechos)  # Fijar la observaci√≥n de 7 estudiantes satisfechos\n\n# Crear el modelo\nmy_model = model(p)\n\n# Definir monitores para el MCMC\nmonitors[1] = mnModel(filename=\"micheladas_MH.log\", printgen=10, separator = TAB)  # Guardar resultados\nmonitors[2] = mnScreen(printgen=100, p)  # Mostrar progreso cada 100 generaciones\n\n# Crear el an√°lisis MCMC con Metropolis-Hastings\nanalysis = mcmc(my_model, monitors, moves)\n\n# Ejecutar el MCMC con 100,000 iteraciones\nanalysis.run(100000)\n\n# Mostrar el resumen de los operadores de MCMC\nanalysis.operatorSummary()",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#mini-ejercicio",
    "href": "chapters/revbayes.html#mini-ejercicio",
    "title": "Apuntes sobre RevBayes",
    "section": "Mini-ejercicio",
    "text": "Mini-ejercicio\n\nCrea un script para RevBayes (.Rev) utilizando Visual Studio Code y copia el codigo.\nModifica el prior dnBeta(alpha, beta) con los valores que reflejen tu creencia sobre la probabilidad de satisfacci√≥n.\nGuarda el archivo micheladas_MH.log en la carpeta asiganada para guardar resultados.\nGuarda el script en la carpeta de scripts.\nEjecuta el an√°lisis MCMC en RevBayes.\nVisualiza los resultados usando Tracer para observar la distribuci√≥n posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>¬† <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html",
    "href": "chapters/u1_intro_diversification.html",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "",
    "text": "Presentaci√≥n: Introducci√≥n al proceso de diversificaci√≥n\nHaz clic en la imagen para ver el PDF de la presentaci√≥n",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "href": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "1.- Mediante la liberia remotes",
    "text": "1.- Mediante la liberia remotes\n\n# Instalar remotes si no est√° instalado\nif (!requireNamespace(\"remotes\", quietly = TRUE)) {\n  install.packages(\"remotes\")\n}\n\n# Instalar TreePar\nremotes::install_github(\"tanja819/TreePar\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "href": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "2.- Descargar el paquete TreePar",
    "text": "2.- Descargar el paquete TreePar\n\nPuedes descargar el paquete desde el siguiente enlace:\nüì• Descargar TreePar 3.3\nGuarda el archivo en una carpeta de tu elecci√≥n (por ejemplo, en ~/Descargas/ o C:/Users/TuUsuario/Downloads/).\n\n\n\nInstalar TreePar desde el archivo descargado\nUna vez que hayas descargado el archivo TreePar_3.3.tar.gz, abre R y ejecuta el siguiente c√≥digo para instalarlo:\n# Definir la ruta donde se descarg√≥ el archivo\nruta_archivo &lt;- \"~/Descargas/TreePar_3.3.tar.gz\"  # Cambia esta ruta seg√∫n tu sistema operativo\n\n# Instalar el paquete desde el archivo .tar.gz\ninstall.packages(ruta_archivo, repos = NULL, type = \"source\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descarga-del-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification.html#descarga-del-√°rbol-filogen√©tico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Descarga del √Årbol Filogen√©tico",
    "text": "Descarga del √Årbol Filogen√©tico\nüì• Puedes descargar el archivo NEXUS con el √°rbol de estudio en el siguiente enlace:\nüì• Descargar √Årbol Filogen√©tico\nGuarda el archivo en la carpeta correspondiente y verifica su ubicaci√≥n antes de continuar.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-√°rbol-en-r",
    "href": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-√°rbol-en-r",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Cargar y Visualizar el √Årbol en R",
    "text": "Cargar y Visualizar el √Årbol en R\nEjecuta el siguiente c√≥digo en R para cargar el archivo y visualizar el √°rbol completo:\n\n# Cargar los paquetes necesarios\nlibrary(ape)\nlibrary(ggtree)\nlibrary(treeio)\nlibrary(tidyverse)\n\n# Definir la ruta del archivo NEXUS\narchivo_nexus &lt;- \"../docs/u1_PatDiv/allSamples.tre\"  # Aseg√∫rate de cambiar esta ruta si es necesario\n\n# Cargar el √°rbol\narbol &lt;- read.nexus(archivo_nexus)\n\n# Calcular el L√≠mite M√°ximo del Eje X\nmax_edge_length &lt;- max(arbol$edge.length, na.rm = TRUE)\n\n# Graficar el √°rbol\nggtree(arbol) +\n  geom_tiplab(size = 3) +\n  geom_text2(aes(subset = !isTip, label = node), hjust = -0.3) +  # Etiquetar nodos internos\n  xlim(-0.5, max_edge_length * 1.4) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-espec√≠fico",
    "href": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-espec√≠fico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Extraer los nombres de las terminales de un nodo espec√≠fico:",
    "text": "Extraer los nombres de las terminales de un nodo espec√≠fico:\nUtilizar la funci√≥n getDescendants para obtener los nombres de todas la terminales del nodo interno 61:\n\nlibrary(phytools)\n\nnodo_interes &lt;- 61  # Reemplaza este valor por el nodo de tu inter√©s\n\n# Obtener los √≠ndices de los nodos descendientes\nnodos_internos &lt;- getDescendants(arbol, nodo_interes)\n\n# Filtrar solo los √≠ndices que corresponden a las terminales (tips)\nindices_tips &lt;- nodos_internos[nodos_internos &lt;= length(arbol$tip.label)]\n\n# Obtener los nombres de las terminales\nnombres_tips &lt;- arbol$tip.label[indices_tips]\n\n# Mostrar los nombres de las terminales\nprint(nombres_tips)\n\n [1] \"06166_50_120_Phod_marmorata\" \"KRN15_107_Phod_marmorata\"   \n [3] \"KRN52_Phod_alticeps\"         \"KRN10_118_Phod_alticeps\"    \n [5] \"KRN14_Phod_alticeps\"         \"KRN24_Cyste_armatus\"        \n [7] \"KRN02_Cyste_armatus\"         \"KRN25_Cyste_armatus\"        \n [9] \"KRN28_Cyste_wislizeni\"       \"KRN03_Cyste_wislizeni\"      \n[11] \"KRN26_Cyste_wislizeni\"       \"KRN100_101_Tegro_aloga\"     \n[13] \"KRN96_97_98_Tegro_aloga\"     \"KRN11_Tegro_erosa\"          \n[15] \"KRN12_Tegro_erosa\"           \"KRN13_Tegro_latecincta\"     \n[17] \"KRN53_Tegro_latecincta\"      \"KRN01_Cordy_opaca\"          \n[19] \"KRN112_Cordy_opaca\"          \"KRN111_Cordy_fulleri\"       \n[21] \"KRN23_Cordy_fulleri\"         \"KRN09_Mege_vittata\"         \n[23] \"KRN08_Mege_puncta\"           \"KRN07_133_Mege_cancell\"     \n[25] \"KRN129_Mege_cancell_h\"       \"KRN51_Pleu_reticulata\"      \n[27] \"KRN48_Pleu_mirabilis\"        \"KRN47_119_Pleu_mirabilis\"   \n[29] \"KRN49_Pleu_mirabilis\"        \"KRN19_Eup_sulciphrons\"      \n[31] \"KRN131_Eup_schwarzi\"         \"KRN88_89_Eup_histrionica\"   \n[33] \"KRN90_Eup_histrionica\"       \"KRN43_108_Eup_fissiceps\"    \n[35] \"KRN45_Eup_fissiceps\"         \"KRN44_Eup_fissiceps\"        \n[37] \"KRN54_121_Eup_fissiceps\"     \"KRN20_Eup_imperialis\"       \n[39] \"KRN06_Eup_imperialis\"        \"KRN42_Eup_imperialis\"       \n[41] \"KRN30_113_Eup_elegans\"       \"KRN38_115_Eup_elegans_p\"    \n[43] \"KRN29_Eup_elegans_p\"         \"KRN21_114_Eup_elegans_p\"    \n[45] \"KRN40_Eup_elegans_p\"         \"KRN92_93_Eup_edmundsi\"      \n[47] \"KRN18_135_Eup_viridis\"       \"KRN59_Eup_viridis\"",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-sub√°rboles-filogen√©ticos",
    "href": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-sub√°rboles-filogen√©ticos",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Uso de getMRCA y extract.clade para extraer Sub√°rboles Filogen√©ticos",
    "text": "Uso de getMRCA y extract.clade para extraer Sub√°rboles Filogen√©ticos\n\n# Obtener el nodo m√°s reciente en com√∫n del ingroup\nmrca_ingroup &lt;- getMRCA(arbol, nombres_tips)\n\n# Extraer el sub√°rbol del ingroup\nsubarbol &lt;- extract.clade(arbol, mrca_ingroup)\n\n# Calcular la longitud m√°xima de las ramas del sub√°rbol\nmax_edge_length &lt;- max(subarbol$edge.length, na.rm = TRUE)\n\n# Graficar el sub√°rbol\nggtree(subarbol) +\n  geom_tiplab(size = 3) +\n  xlim(-0.5, max_edge_length * 2) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "href": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Remover especies duplicadas",
    "text": "Remover especies duplicadas\n\n# Separar los nombres de las especies (asumiendo el formato \"ID_Especie\")\nspecies_info &lt;- data.frame(\n  tip_label = nombres_tips,\n  species = str_extract(nombres_tips, \"[A-Za-z]+_[A-Za-z]+(?:_[A-Za-z]+)?$\")\n)\n\n# Eliminar las ssp _h y _p\n# Seleccionar solo una muestra por especie\nunique_species &lt;- species_info %&gt;%\n  filter(!str_detect(species, \"_[hp]$\")) %&gt;%\n  group_by(species) %&gt;% \n  slice(1) %&gt;%  # Selecciona solo la primera aparici√≥n de cada especie\n  ungroup()\n\n# Extraer los nombres de los tips que queremos conservar\nselected_tips &lt;- unique_species$tip_label\n\n# Remover duplicados\nsubarbol_final &lt;- drop.tip(subarbol, setdiff(subarbol$tip.label, selected_tips))\n\nggtree(subarbol_final) + \n  geom_tiplab(size = 3) + \n  xlim(-0.5, max(subarbol_final$edge.length) * 2)  # Expande el espacio a la izquierda",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#guardar-el-√°rbol-resultante-en-formato-nexus",
    "href": "chapters/u1_intro_diversification.html#guardar-el-√°rbol-resultante-en-formato-nexus",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Guardar el √°rbol resultante en formato NEXUS",
    "text": "Guardar el √°rbol resultante en formato NEXUS\n\nwrite.nexus(subarbol_final, file=\"../docs/u1_PatDiv/subarbol_ingroup.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#carga-del-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification.html#carga-del-√°rbol-filogen√©tico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Carga del √Årbol Filogen√©tico",
    "text": "Carga del √Årbol Filogen√©tico\n\n# Carga de paquetes\nlibrary(subplex)\nlibrary(TreeSim)\nlibrary(deSolve)\nlibrary(ape)       \nlibrary(TreePar)\n\n# Cargar el √°rbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el √°rbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtenci√≥n-de-los-tiempos-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification.html#obtenci√≥n-de-los-tiempos-de-especiaci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Obtenci√≥n de los Tiempos de Especiaci√≥n",
    "text": "Obtenci√≥n de los Tiempos de Especiaci√≥n\nExtraeremos y ordenaremos los tiempos de especiaci√≥n (tiempos de ramificaci√≥n) del √°rbol:\n\n# Obtener y ordenar los tiempos de especiaci√≥n\n# La funci√≥n getx() extrae los tiempos de ramificaci√≥n del √°rbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulaci√≥n.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "href": "chapters/u1_intro_diversification.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Configuraci√≥n de Par√°metros para el An√°lisis",
    "text": "Configuraci√≥n de Par√°metros para el An√°lisis\nDefiniremos los par√°metros necesarios para el an√°lisis de cambios en las tasas de diversificaci√≥n:\n\nrho &lt;- 22/26  # Proporci√≥n de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tama√±o de la grilla de b√∫squeda de cambios de tasa (en millones de a√±os)\nstart &lt;- min(times)   # Tiempo inicial para la b√∫squeda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la b√∫squeda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#ejecuci√≥n-del-an√°lisis-con-bd.shifts.optim",
    "href": "chapters/u1_intro_diversification.html#ejecuci√≥n-del-an√°lisis-con-bd.shifts.optim",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Ejecuci√≥n del An√°lisis con bd.shifts.optim",
    "text": "Ejecuci√≥n del An√°lisis con bd.shifts.optim\nUtilizaremos la funci√≥n bd.shifts.optim para estimar las tasas de especiaci√≥n y extinci√≥n, as√≠ como los puntos en el tiempo donde ocurren cambios significativos en estas tasas:\n\n# Ejecutar el an√°lisis de cambios en las tasas de diversificaci√≥n\nresult_shifts &lt;- bd.shifts.optim(times, rho, grid, start, end, yule=TRUE)\n\n[1] \"startest\"\n[1] \"test\"\n\n# Mostrar los resultados\nresult_shifts[[2]][[1]]\n\n[1] 70.02138042  0.08912957\n\n\nA continuaci√≥n se presentan los valores obtenidos en la estimaci√≥n de la tasa de diversificaci√≥n. Dado que el modelo Yule asume que no hay extinci√≥n, la tasa de extinci√≥n no est√° definida en este an√°lisis.\n\nValor de la funci√≥n de verosimilitud negativa: 70.02138\nTasa de especiaci√≥n \\(\\lambda\\): 0.08913\n\nEn este contexto:\nEstos valores indican que la tasa de especiaci√≥n estimada (\\(\\lambda\\)) es aproximadamente 0.08913.\nEl valor de la funci√≥n de verosimilitud negativa (70.02138) proporciona una medida del ajuste del modelo a los datos, donde valores m√°s bajos generalmente indican un mejor ajuste.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "href": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "text": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "href": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Cargar el archivo NEXUS",
    "text": "Cargar el archivo NEXUS\n# Cargar la filogenia desde el archivo NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Obtener la lista de taxones en la filogenia\ntaxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "href": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Inicializar los vectores de moves y monitors",
    "text": "Inicializar los vectores de moves y monitors\n# Inicializar un vector vac√≠o para los movimientos (moves)\nmoves = VectorMoves()\n\n# Inicializar un vector vac√≠o para los monitores (monitors)\nmonitors = VectorMonitors()\n\n\n\n\n\nRepresentaci√≥n del modelo gr√°fico para el proceso Yule (Pure-Birth) en RevBayes, donde la tasa de especiaci√≥n (\\(\\lambda\\)) es tratada como una variable aleatoria extra√≠da de una distribuci√≥n uniforme.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiaci√≥n-lambda",
    "href": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiaci√≥n-lambda",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Especificar la tasa de especiaci√≥n (\\(\\lambda\\))",
    "text": "Especificar la tasa de especiaci√≥n (\\(\\lambda\\))\n# Especificar la tasa de especiaci√≥n Œª con una distribuci√≥n uniforme\nbirth_rate ~ dnUniform(0, 100.0)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiaci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Asignar un movimiento MCMC a la tasa de especiaci√≥n",
    "text": "Asignar un movimiento MCMC a la tasa de especiaci√≥n\n# Agregar un movimiento MCMC para la tasa de especiaci√≥n\nmoves.append( mvScale(birth_rate, lambda=1.0, tune=true, weight=3.0) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-proporci√≥n-de-especies-muestreadas-rho",
    "href": "chapters/u1_intro_diversification.html#especificar-la-proporci√≥n-de-especies-muestreadas-rho",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Especificar la proporci√≥n de especies muestreadas (\\(\\rho\\))",
    "text": "Especificar la proporci√≥n de especies muestreadas (\\(\\rho\\))\n# Obtener el n√∫mero de taxones en la filogenia\nnum_taxa &lt;- T.ntips()\n\n# Estimar la proporci√≥n de especies muestreadas\nrho &lt;- num_taxa / 26",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-ra√≠z",
    "href": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-ra√≠z",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Obtener la edad de la ra√≠z",
    "text": "Obtener la edad de la ra√≠z\n# Obtener la edad de la ra√≠z del √°rbol\nroot_time &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiaci√≥n",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Definir el modelo de tiempo de especiaci√≥n",
    "text": "Definir el modelo de tiempo de especiaci√≥n\nEl modelo Yule (pure-birth) en RevBayes se define con el proceso de nacimiento y muerte (dnBDP), pero con la tasa de extinci√≥n (mu) fijada en 0.\n# Definir el modelo de diversificaci√≥n usando un proceso de nacimiento-muerte (BDP)\ntimetree ~ dnBDP(lambda=birth_rate, mu=0.0, rho=rho, rootAge=root_time, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)\nExplicaci√≥n\n\nlambda = birth_rate ‚Üí Tasa de especiaci√≥n es una variable aleatoria con dnUniform(0, 100.0).\nmu = 0.0 ‚Üí Asumimos que no hay extinci√≥n (modelo Yule).\nrho = rho ‚Üí Se ajusta seg√∫n el n√∫mero de especies muestreadas.\nrootAge = root_time ‚Üí Condicionamos el modelo en la edad de la ra√≠z.\nsamplingStrategy = \"uniform\" ‚Üí Asumimos muestreo uniforme.\ncondition = \"survival\" ‚Üí Solo analizamos √°rboles que sobrevivieron hasta el presente.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "href": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Fijar la filogenia observada",
    "text": "Fijar la filogenia observada\n# Fijar la filogenia observada\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-gr√°fico",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-gr√°fico",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Definir el modelo gr√°fico",
    "text": "Definir el modelo gr√°fico\n# Crear el objeto de modelo\nmymodel = model(birth_rate)\nEsto crea un modelo gr√°fico dirigido ac√≠clico (DAG) donde birth_rate es el nodo principal, y RevBayes autom√°ticamente encuentra todos los otros nodos conectados.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "href": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Especificar los Monitores",
    "text": "Especificar los Monitores\n# Monitor para registrar los estados del modelo en un archivo de salida\nmonitors.append( mnModel(filename=\"output/diversification_Yule.log\", printgen=10, separator=TAB) )\n\n# Monitor para imprimir la tasa de especiaci√≥n en la pantalla cada 1000 generaciones\nmonitors.append( mnScreen(printgen=1000, birth_rate) )\nExplicaci√≥n\n\nmnModel guarda el registro de la ejecuci√≥n en \"output/diversification_Yule.log\", escribiendo cada 10 generaciones.\nmnScreen imprime la tasa de especiaci√≥n (birth_rate) en la consola cada 1000 generaciones.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Configurar y ejecutar el MCMC",
    "text": "Configurar y ejecutar el MCMC\n# Inicializar el MCMC con dos cadenas combinadas en un solo an√°lisis\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\n\n# Ejecutar el MCMC por 50,000 generaciones, ajustando los movimientos cada 200 generaciones\nmymcmc.run(generations=50000, tuningInterval=200)\nExplicaci√≥n\n\nnruns=2 ‚Üí Corre dos cadenas independientes.\ncombine=\"mixed\" ‚Üí Combina las cadenas en un solo conjunto de muestras.\ngenerations=50000 ‚Üí Ejecuta la simulaci√≥n por 50,000 generaciones.\ntuningInterval=200 ‚Üí Ajusta los movimientos cada 200 generaciones para mejorar la eficiencia del muestreo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "href": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Cargar los resultados en RevGadgets",
    "text": "Cargar los resultados en RevGadgets\nDespu√©s de correr el MCMC en RevBayes, usar RevGadgets en R para analizar la distribuci√≥n posterior:\n\n# Cargar librer√≠as necesarias\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC\nmcmc_trace &lt;- readTrace(\"../docs/u1_PatDiv/output/diversification_Yule.log\")\n\n# Visualizar la distribuci√≥n posterior de birth_rate\nplotTrace(mcmc_trace, vars=\"birth_rate\")\n\n[[1]]",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "href": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Calcular la media y el intervalo de HPD (Highest Posterior Density)",
    "text": "Calcular la media y el intervalo de HPD (Highest Posterior Density)\n\n# Calcular la media posterior y el HPD del 95%\nsummary_stats &lt;- summarizeTrace(mcmc_trace, vars=\"birth_rate\")\nprint(summary_stats)\n\n$birth_rate\n$birth_rate$trace_1\n         mean        median           MAP  quantile_2.5 quantile_97.5 \n   0.09313312    0.09214016    0.09139628    0.05919603    0.13341000",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#comparar-la-distribuci√≥n-previa-y-posterior",
    "href": "chapters/u1_intro_diversification.html#comparar-la-distribuci√≥n-previa-y-posterior",
    "title": "Introducci√≥n al proceso de diversificaci√≥n",
    "section": "Comparar la distribuci√≥n previa y posterior",
    "text": "Comparar la distribuci√≥n previa y posterior\n\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC combinando las dos cadenas\nposterior_trace &lt;- readTrace(c(\"../docs/u1_PatDiv/output/diversification_Yule_run_1.log\", \"../docs/u1_PatDiv/output/diversification_Yule_run_2.log\"))\n\n# Extraer el primer conjunto de muestras (lista de data frames)\nyule_posterior &lt;- posterior_trace[[1]]\n\n# Simular 10,000 valores de la distribuci√≥n previa\nyule_prior &lt;- data.frame(birth_rate = runif(10000, min=0, max=100))\n\n# Agregar la columna de la distribuci√≥n previa en el posterior\nyule_posterior$birth_rate_prior &lt;- sample(yule_prior$birth_rate, size = nrow(yule_posterior), replace = TRUE)\n\n# Graficar la comparaci√≥n\nplotTrace(list(yule_posterior), vars = c(\"birth_rate\", \"birth_rate_prior\"))[[1]] +\n  theme(legend.position = c(0.80, 0.80),  # Ubicaci√≥n de la leyenda\n        legend.text = element_text(size =20),  # Tama√±o del texto de la leyenda\n        legend.title = element_text(size = 22)) +  # Tama√±o del t√≠tulo de la leyenda\n  xlim(0, 1)  # Ajusta el l√≠mite seg√∫n los valores observados",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>6</span>¬† <span class='chapter-title'>Introducci√≥n al proceso de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html",
    "href": "chapters/u1_intro_diversification_2.html",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "",
    "text": "Presentaci√≥n: Modelos con cambios en las tasas de diversificaci√≥n\nHaz clic en la imagen para ver el PDF de la presentaci√≥n",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducci√≥n",
    "href": "chapters/u1_intro_diversification_2.html#introducci√≥n",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Introducci√≥n",
    "text": "Introducci√≥n\nEn estudios filogen√©ticos, los modelos de nacimiento-muerte (birth-death models) permiten inferir c√≥mo han cambiado las tasas de diversificaci√≥n (\\(\\lambda\\)) y extinci√≥n (\\(\\mu\\)) a lo largo del tiempo. Sin embargo, estas tasas no son siempre constantes. Diversos eventos evolutivos, como la aparici√≥n de nuevas adaptaciones o cambios ambientales, pueden causar variaciones en la din√°mica de diversificaci√≥n de un linaje.\nEl paquete TreePar permite ajustar modelos de diversificaci√≥n con cambios en la tasa mediante la funci√≥n bd.shifts.optim(). Esta funci√≥n estima la mejor combinaci√≥n de tasas de diversificaci√≥n y extinci√≥n en diferentes periodos de tiempo, seg√∫n la estructura de una filogenia dada.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#cargar-librer√≠as-y-el-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification_2.html#cargar-librer√≠as-y-el-√°rbol-filogen√©tico",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Cargar librer√≠as y el √°rbol filogen√©tico",
    "text": "Cargar librer√≠as y el √°rbol filogen√©tico\n\n# Cargar las librer√≠as necesarias\nlibrary(ape)       \nlibrary(TreePar)\nlibrary(tidyverse)\nlibrary(ggtree)\n\n# Cargar el √°rbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el √°rbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#obtenci√≥n-de-los-tiempos-de-diversificaci√≥n",
    "href": "chapters/u1_intro_diversification_2.html#obtenci√≥n-de-los-tiempos-de-diversificaci√≥n",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Obtenci√≥n de los tiempos de diversificaci√≥n",
    "text": "Obtenci√≥n de los tiempos de diversificaci√≥n\nExtraeremos y ordenaremos los tiempos de diversificaci√≥n (tiempos de ramificaci√≥n) del √°rbol:\n\n# Obtener y ordenar los tiempos de especiaci√≥n\n# La funci√≥n getx() extrae los tiempos de ramificaci√≥n del √°rbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulaci√≥n.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "href": "chapters/u1_intro_diversification_2.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Configuraci√≥n de Par√°metros para el An√°lisis",
    "text": "Configuraci√≥n de Par√°metros para el An√°lisis\nDefiniremos los par√°metros necesarios para el an√°lisis de cambios en las tasas de diversificaci√≥n:\n\nrho &lt;- 22/26  # Proporci√≥n de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tama√±o de la grilla de b√∫squeda de cambios de tasa (en millones de a√±os)\nstart &lt;- min(times)   # Tiempo inicial para la b√∫squeda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la b√∫squeda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelo-de-nacimiento-muerte-sin-cambios",
    "href": "chapters/u1_intro_diversification_2.html#modelo-de-nacimiento-muerte-sin-cambios",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Modelo de nacimiento-muerte sin cambios",
    "text": "Modelo de nacimiento-muerte sin cambios\n\nresbd &lt;- bd.shifts.optim(times, rho, grid, start, end)\n\n[1] \"startest\"\n[1] \"test\"\n\nresbd[[2]]  # Verosimilitud del modelo\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelo-con-un-cambio",
    "href": "chapters/u1_intro_diversification_2.html#modelo-con-un-cambio",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Modelo con un cambio",
    "text": "Modelo con un cambio\nAqu√≠ probamos un modelo en el que la tasa cambia en un tiempo \\(t_{1}\\)\n\n\n\n\n\n\n\nPar√°metro\nSignificado\n\n\n\n\ntime\nEdades de los nodos terminales\n\n\nc(0.8, 1)\nc(\\(\\rho\\), Intervalo de discretizaci√≥n del tiempo)\n\n\ngrid\nIntervalo de discretizaci√≥n del tiempo\n\n\nstart, end\nRango de tiempo para el an√°lisis\n\n\nME=FALSE\nNo se consideran eventos de extinci√≥n masiva\n\n\nsurvival=1\nSe asume que todas las especies sobrevivientes han sido muestreadas\n\n\n\n\nresoneshift &lt;- bd.shifts.optim(times, c(rho, 1), grid, start, end, ME=FALSE, survival=1)\nresoneshift[[2]]  # Verosimilitud del modelo con un cambio en la tasa\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.295893e+01 9.952613e-01 8.527988e-02 1.001768e-04 1.594866e-01\n[6] 6.125229e+00\n\n\nInterpretaci√≥n\n\n\n\n\n\n\n\n\n√çndice\nPar√°metro estimado\nDescripci√≥n\n\n\n\n\n1\n62.95893\nVerosimilitud (log-likelihood)\n\n\n2\n0.99526\nTurnover antes del cambio (\\(\\epsilon_0\\))\n\n\n3\n0.08528\nTurnover despu√©s del cambio (\\(\\epsilon_1\\))\n\n\n4\n0.00010\nDiversificaci√≥n antes del cambio (\\(r_0\\))\n\n\n5\n0.15949\nDiversificaci√≥n despu√©s del cambio (\\(r_1\\))\n\n\n6\n6.12523\ntiempo del cambio\n\n\n\nGraficar el modelo con un cambio en la tasa\n\nbd.shifts.plot(list(resoneshift[[2]]), shifts = 1, timemax = max(times), ratemin = 0, ratemax = 1.1, plotturnover = TRUE)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelo-con-dos-cambios",
    "href": "chapters/u1_intro_diversification_2.html#modelo-con-dos-cambios",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Modelo con dos cambios",
    "text": "Modelo con dos cambios\n\nrestwoshift &lt;- bd.shifts.optim(times, c(0.8,1,1), grid, start, end, ME=FALSE, survival=1)\nrestwoshift[[2]]\n\n\n\n[[1]]\n[1] 6.984598e+01 2.752173e-07 9.230017e-02\n\n[[2]]\n[1] 6.300085e+01 3.082460e-02 9.309168e-08 1.887393e-02 1.612077e-01\n[6] 6.125229e+00\n\n[[3]]\n[1]  6.045200e+01  7.427444e-08  1.840255e-02  1.040200e+00  2.028774e-02\n[6]  1.244237e-01 -2.968324e-02  6.125229e+00  1.472523e+01\n\n\nInterpretaci√≥n\n\n\n\n\n\n\n\n\n√çndice\nValor\nDescripci√≥n\n\n\n\n\n1\n60.45200\nVerosimilitud (log-likelihood)\n\n\n2\n7.427444e-08\nTurnover antes del primer cambio (\\(\\epsilon_0\\))\n\n\n3\n0.01840\nTurnover antes del segundo cambio (\\(\\epsilon_1\\))\n\n\n4\n1.04020\nTurnover despu√©s del segundo cambio (\\(\\epsilon_2\\))\n\n\n5\n0.02028\nDiversificaci√≥n antes del primer cambio (\\(r_0\\))\n\n\n6\n0.12442\nDiversificaci√≥n antes del segundo cambio (\\(r_1\\))\n\n\n7\n-0.02968\nDiversificaci√≥n despues del segundo cambio (\\(r_2\\))\n\n\n8\n6.12523\nTiempo del primer cambio \\(t_1\\)\n\n\n9\n14.72523\nTiempo del segundo cambio \\(t_1\\)\n\n\n\nGraficar el modelo con dos cambio en la tasa\n\nbd.shifts.plot(list(restwoshift[[2]]), shifts = 2, timemax = max(times), ratemin = -0.1, ratemax = 1.1, plotturnover = TRUE)\n\n\n\n\n\n\n\n\nOpcion con ggtree y ggplot\n\nlibrary(ggplot2)\nlibrary(ggtree)\nlibrary(tidyr)\nlibrary(patchwork) \n\n# Extraer resultados de restwoshift[[2]]\nresultados &lt;- restwoshift[[2]][[3]]\n\n# Crear el gr√°fico del √°rbol con `ggtree`\np_tree &lt;- ggtree(tree) + \n  theme_tree() +\n  theme(plot.background = element_blank())\n\n# Crear el data frame con los valores obtenidos\ndf_prueba &lt;- data.frame(\n  turnover = c(resultados[2], resultados[2], resultados[3], resultados[4]),  \n  r = c(resultados[5], resultados[5], resultados[6], resultados[7]),  \n  tiempo = c(start, resultados[8], resultados[9], end)  # Tiempo en sentido inverso (del pasado al presente)\n)\n\n# Transformar datos al formato largo para ggplot2\ndf_long &lt;- pivot_longer(df_prueba, cols = c(turnover, r), \n                        names_to = \"Tasa\", values_to = \"Valor\")\n\n# Crear el gr√°fico de tasas con `geom_step()`\np_tasas &lt;- ggplot(df_long, aes(x = tiempo, y = Valor, color = rev(Tasa))) +\n  geom_step(size = 1, direction = \"hv\") + \n  geom_point(size = 3) +\n  scale_x_reverse() +  # Invertir el eje X para que el tiempo fluya del pasado al presente\n  labs(x = \"Time\",\n       y = \"Rate\") +\n  theme_minimal()\n\n# Superponer el √°rbol y el gr√°fico de tasas con ajuste de proporciones\np_tree + p_tasas + plot_layout(ncol = 1, heights = c(1, 1.5))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#comparaci√≥n-de-modelos-usando-likelihood-ratio-test-lrt",
    "href": "chapters/u1_intro_diversification_2.html#comparaci√≥n-de-modelos-usando-likelihood-ratio-test-lrt",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Comparaci√≥n de modelos usando Likelihood Ratio Test (LRT)",
    "text": "Comparaci√≥n de modelos usando Likelihood Ratio Test (LRT)\n¬øQu√© es la prueba LRT? Es una prueba estad√≠stica para comparar modelos anidados, es decir, modelos donde uno es una versi√≥n simplificada del otro (por ejemplo, el modelo de nacimiento-muerte puro vs.¬†un modelo con cambios en la tasa).\nSe calcula con la siguiente f√≥rmula:\n\\(LR = 2 * (\\mathcal{L}_{modelo m√°s simple} - \\mathcal{L}_{modelo m√°s complejo})\\)\nDonde: - Un p-valor menor a 0.05 indica que el modelo m√°s complejo es significativamente mejor que el m√°s simple.\nObtener las Verosimilitudes de cada modelo\n\n## Verosimilitud birth-death\nresbd[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death un cambio\nresoneshift[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death dos cambios\nrestwoshift[[2]][[1]][1]\n\n[1] 69.84598\n\n\nComparaci√≥n BD vs BD un cambio\n\nChiSq1 = 2 * (resbd[[2]][[1]][1] - resoneshift[[2]][[1]][1])\nChiSq1\n\n[1] 0\n\npchiSq1 &lt;- pchisq(ChiSq1, df=3)\npchiSq1\n\n[1] 0\n\n\nResultados:\n\n\\(LR = 0\\) ‚Üí No hay diferencia en la verosimilitud entre el modelo BD y BD con un cambio.\n\\(p_{valor} = 0\\) ‚Üí Indica que no hay mejora significativa en el modelo con un cambio en la tasa.\n\nComparaci√≥n BD un cambio vs BD dos cambios\n\nChiSq2 = 2 * (resoneshift[[2]][[1]][1] - restwoshift[[2]][[1]][1])\nChiSq2\n\n[1] 0.3508041\n\npchiSq2 &lt;- pchisq(ChiSq2, df=3)\npchiSq2\n\n[1] 0.04979325\n\n\nResultados:\n\n\\(LR = 0.3508\\) ‚Üí Hay una peque√±a diferencia en la verosimilitud entre el modelo BD con un cambio y el modelo BD con dos cambios.\n\\(p_{valor} = 0.0498\\) ‚Üí Justo en el l√≠mite del umbral de significancia \\((0.05)\\), lo que indica que el modelo con dos cambios podr√≠a ser significativamente mejor.\n\nGenerar el gr√°fico con bd.shifts.plot()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducci√≥n-1",
    "href": "chapters/u1_intro_diversification_2.html#introducci√≥n-1",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Introducci√≥n",
    "text": "Introducci√≥n\nEl modelo de nacimiento-muerte ep√≠sodico es un proceso en el cual las tasas de diversificaci√≥n var√≠an ep√≠sodicamente a lo largo del tiempo y se modelan como tasas constantes por intervalos de tiempo (Stadler 2011; H√∂hna 2015). Siguiendo el tutorial oficial Episodic Diversification Rate Estimation.\nAsumimos que las tasas transformadas logar√≠tmicamente siguen una distribuci√≥n previa de campo aleatorio de Markov en forma de herradura (Horseshoe Markov random field, HSMRF) seg√∫n Magee et al.¬†(2020).\n\nTasas transformadas logar√≠tmicamente:\n\nEn muchos modelos evolutivos, las tasas de diversificaci√≥n y extinci√≥n pueden variar en √≥rdenes de magnitud.\nPara modelar mejor estos cambios, se toma el logaritmo de las tasas en lugar de usarlas directamente.\nEsto ayuda a evitar valores negativos y hace que la distribuci√≥n de las tasas sea m√°s manejable.\n\nDistribuci√≥n previa (prior) de campo aleatorio de Markov en forma de herradura (HSMRF):\n\nDistribuci√≥n previa (prior): En un enfoque bayesiano, los par√°metros desconocidos (como las tasas de especiaci√≥n/extinci√≥n) tienen distribuciones previas que reflejan nuestras creencias antes de ver los datos.\nCampo aleatorio de Markov (Markov Random Field, MRF): Este t√©rmino indica que las tasas en un intervalo de tiempo dependen de las tasas en el intervalo anterior. En otras palabras, las tasas est√°n autocorrelacionadas temporalmente.\nForma de herradura (Horseshoe): Es un tipo de distribuci√≥n previa dise√±ada para manejar datos donde algunos valores pueden ser cercanos a cero (relativamente constantes), pero tambi√©n permite valores extremos (cambios bruscos en las tasas).\n¬øPor qu√© se usa? El HSMRF permite capturar patrones donde las tasas cambian lentamente la mayor parte del tiempo, pero ocasionalmente pueden dar saltos grandes, lo cual es biol√≥gicamente realista en muchos sistemas evolutivos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#lectura-del-√°rbol",
    "href": "chapters/u1_intro_diversification_2.html#lectura-del-√°rbol",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Lectura del √°rbol",
    "text": "Lectura del √°rbol\nComenzamos cargando el √°rbol filogen√©tico previamente filtrado.\n# Cargar el √°rbol filogen√©tico desde un archivo en formato NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Extraer la informaci√≥n taxon√≥mica del √°rbol\n taxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "href": "chapters/u1_intro_diversification_2.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definir-el-n√∫mero-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificaci√≥n.",
    "href": "chapters/u1_intro_diversification_2.html#definir-el-n√∫mero-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificaci√≥n.",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Definir el n√∫mero de intervalos en los que dividiremos el tiempo para modelar la diversificaci√≥n.",
    "text": "Definir el n√∫mero de intervalos en los que dividiremos el tiempo para modelar la diversificaci√≥n.\nNUM_INTERVALS = 10  # N√∫mero total de intervalos de tiempo\nNUM_BREAKS := NUM_INTERVALS - 1  # N√∫mero de puntos de cambio entre intervalos",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definimos-distribuciones-previas-sobre-las-tasas-dentro-del-modelo-hsmrf-de-nacimiento-muerte.-par√°metros-globales-de-escala",
    "href": "chapters/u1_intro_diversification_2.html#definimos-distribuciones-previas-sobre-las-tasas-dentro-del-modelo-hsmrf-de-nacimiento-muerte.-par√°metros-globales-de-escala",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Definimos distribuciones previas sobre las tasas dentro del modelo HSMRF de nacimiento-muerte. Par√°metros globales de escala",
    "text": "Definimos distribuciones previas sobre las tasas dentro del modelo HSMRF de nacimiento-muerte. Par√°metros globales de escala\n# Hiperprior para controlar la variabilidad global de las tasas de diversificaci√≥n y extinci√≥n\nspeciation_global_scale_hyperprior &lt;- 0.044\nextinction_global_scale_hyperprior &lt;- 0.044\nEstos hiperpriors controlan la variabilidad global de las tasas de diversificaci√≥n y extinci√≥n:\n\nUn valor mayor permite m√°s cambios abruptos entre intervalos.\nUn valor menor suaviza las tasas a lo largo del tiempo.\n\nFunci√≥n setMRFGlobalScaleHyperpriorNShifts() del paquete RevGadgets en R para calcular el hiperprior autom√°ticamente.\n\n### Ejecutar en R, no agregar a RevBayes!!!\n### Calcula el hiperprior que utilizaremos en RevBayes\nlibrary(RevGadgets)\n## 10 numero intervalos\n## \"HSMRF\" Horseshoe Markov random field \nsetMRFGlobalScaleHyperpriorNShifts(10, \"HSMRF\")\n\n[1] 0.04446432",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#asignar-distribuciones-previas-half-cauchy-dnhalfcauchy01",
    "href": "chapters/u1_intro_diversification_2.html#asignar-distribuciones-previas-half-cauchy-dnhalfcauchy01",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Asignar distribuciones previas Half-Cauchy (dnHalfCauchy(0,1))",
    "text": "Asignar distribuciones previas Half-Cauchy (dnHalfCauchy(0,1))\nSe asignan a los par√°metros de escala global, esto permite valores peque√±os pero tambi√©n acepta valores m√°s grandes ocasionalmente.\n# Distribuciones previas de Cauchy truncadas para los par√°metros de escala global\nspeciation_global_scale ~ dnHalfCauchy(0,1)\nextinction_global_scale ~ dnHalfCauchy(0,1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definir-las-tasas-iniciales-de-diversificaci√≥n-y-extinci√≥n-en-el-modelo-hsmrf.",
    "href": "chapters/u1_intro_diversification_2.html#definir-las-tasas-iniciales-de-diversificaci√≥n-y-extinci√≥n-en-el-modelo-hsmrf.",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Definir las tasas iniciales de diversificaci√≥n y extinci√≥n en el modelo HSMRF.",
    "text": "Definir las tasas iniciales de diversificaci√≥n y extinci√≥n en el modelo HSMRF.\nEn este enfoque, comenzamos con la tasa de diversificaci√≥n y extinci√≥n en el presente y luego modelamos c√≥mo cambian hacia el pasado.\n# Definir tasas iniciales de diversificaci√≥n y extinci√≥n en el presente\nlog_speciation_at_present ~ dnUniform(-10.0,10.0)\nlog_speciation_at_present.setValue(0.0)\nlog_extinction_at_present ~ dnUniform(-10.0,10.0)\nlog_extinction_at_present.setValue(-1.0)\n¬øPor qu√© se usa dnUniform(-10.0,10.0)?\nSe establece una distribuci√≥n uniforme como prior para las tasas iniciales de diversificaci√≥n y extinci√≥n.\n\nComo estamos modelando las tasas en escala logar√≠tmica, esto implica que los valores de especiaci√≥n/extinci√≥n reales estar√°n entre:\n\n(e^{-10}) (casi 0, evoluci√≥n extremadamente lenta)\n(e^{10}) (tasa de diversificaci√≥n muy r√°pida)\n\nPermitir este rango amplio cubre la mayor√≠a de los valores posibles sin asumir un conocimiento previo espec√≠fico sobre la tasa de diversificaci√≥n en el presente.\n\n¬øPor qu√© los valores iniciales 0.0 y -1.0?\n\nlog_speciation_at_present.setValue(0.0): Equivale a establecer la tasa inicial de diversificaci√≥n en (\\(e^0 = 1.0\\)), lo cual es un punto razonable para comenzar.\nlog_extinction_at_present.setValue(-1.0): Equivale a una tasa inicial de extinci√≥n de (\\(e^{-1} \\approx 0.37\\)), lo que implica que la extinci√≥n es menor que la diversificaci√≥n en el punto de partida.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#movimientos-eficientes-en-mcmc-para-explorar-estas-tasas",
    "href": "chapters/u1_intro_diversification_2.html#movimientos-eficientes-en-mcmc-para-explorar-estas-tasas",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Movimientos eficientes en MCMC para explorar estas tasas",
    "text": "Movimientos eficientes en MCMC para explorar estas tasas\nmoves.append( mvScaleBactrian(log_speciation_at_present,weight=5))\nmoves.append( mvScaleBactrian(log_extinction_at_present,weight=5))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelar-la-diversificaci√≥n-epis√≥dica",
    "href": "chapters/u1_intro_diversification_2.html#modelar-la-diversificaci√≥n-epis√≥dica",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Modelar la diversificaci√≥n epis√≥dica",
    "text": "Modelar la diversificaci√≥n epis√≥dica\nEn el c√≥digo de RevBayes para modelar la diversificaci√≥n epis√≥dica, se utiliza un bucle for para definir los cambios en las tasas de diversificaci√≥n y extinci√≥n en cada intervalo de tiempo.\nfor (i in 1:NUM_BREAKS) {\n  # Variabilidad local en cada intervalo\n  sigma_speciation[i] ~ dnHalfCauchy(0,1)\n  sigma_extinction[i] ~ dnHalfCauchy(0,1)\n\n  # Se inicializan valores aleatorios en un rango de 0.005 a 0.1, para evitar valores extremos en el inicio del MCMC\n  sigma_speciation[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_extinction[i].setValue(runif(1,0.005,0.1)[1])\n\n  # Especificar los cambios en log-diversificaci√≥n y log-extinci√≥n mediante una distribuci√≥n normal\n  delta_log_speciation[i] ~ dnNormal( mean=0, sd=sigma_speciation[i]*speciation_global_scale*speciation_global_scale_hyperprior )\n  delta_log_extinction[i] ~ dnNormal( mean=0, sd=sigma_extinction[i]*extinction_global_scale*extinction_global_scale_hyperprior )\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#calcular-las-tasas-de-diversificaci√≥n-y-extinci√≥n",
    "href": "chapters/u1_intro_diversification_2.html#calcular-las-tasas-de-diversificaci√≥n-y-extinci√≥n",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Calcular las tasas de diversificaci√≥n y extinci√≥n",
    "text": "Calcular las tasas de diversificaci√≥n y extinci√≥n\nspeciation := fnassembleContinuousMRF(log_speciation_at_present, delta_log_speciation, initialValueIsLogScale=TRUE, order=1)\nextinction := fnassembleContinuousMRF(log_extinction_at_present, delta_log_extinction, initialValueIsLogScale=TRUE, order=1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#movimientos-de-mcmc-para-el-modelo-hsmrf",
    "href": "chapters/u1_intro_diversification_2.html#movimientos-de-mcmc-para-el-modelo-hsmrf",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Movimientos de MCMC para el Modelo HSMRF",
    "text": "Movimientos de MCMC para el Modelo HSMRF\n# Movimiento para los cambios en log-escala de diversificaci√≥n y extinci√≥n\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_speciation, weight=5, tune=FALSE))\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_extinction, weight=5, tune=FALSE))\n\n# Movimiento Gibbs para los hiperpar√°metros globales y locales\nmoves.append(mvHSRFHyperpriorsGibbs(speciation_global_scale, sigma_speciation , delta_log_speciation , speciation_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\nmoves.append(mvHSRFHyperpriorsGibbs(extinction_global_scale, sigma_extinction , delta_log_extinction , extinction_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\n\n# Movimiento de intercambio entre intervalos adyacentes\nmoves.append(mvHSRFIntervalSwap(delta_log_speciation, sigma_speciation, weight=5))\nmoves.append(mvHSRFIntervalSwap(delta_log_extinction, sigma_extinction, weight=5))\nSe utilizan tres tipos principales de movimientos en este c√≥digo:\n\nMuestreo El√≠ptico Slice (mvEllipticalSliceSamplingSimple)\n\nOptimiza la exploraci√≥n de los cambios en log-escala de las tasas de diversificaci√≥n y extinci√≥n.\nFunciona bien en modelos con alta correlaci√≥n entre par√°metros.\n\nMuestreo Gibbs (mvHSRFHyperpriorsGibbs)\n\nSe usa para actualizar los hiperpar√°metros globales y locales del modelo.\nPermite ajustes eficientes en la escala de variabilidad de las tasas.\n\nIntercambio de intervalos (mvHSRFIntervalSwap)\n\nIntercambia valores entre intervalos de tiempo adyacentes.\nAyuda a evitar que la cadena de MCMC se quede atrapada en un estado sub√≥ptimo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuraci√≥n-de-los-intervalos-de-tiempo",
    "href": "chapters/u1_intro_diversification_2.html#configuraci√≥n-de-los-intervalos-de-tiempo",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Configuraci√≥n de los Intervalos de Tiempo",
    "text": "Configuraci√≥n de los Intervalos de Tiempo\ninterval_times &lt;- abs(T.rootAge() * seq(1, NUM_BREAKS, 1)/NUM_INTERVALS)\n\nT.rootAge() ‚Üí Obtiene la edad de la ra√≠z del √°rbol filogen√©tico (es decir, el tiempo en el pasado en que el linaje com√∫n m√°s reciente existi√≥).\nseq(1, NUM_BREAKS, 1) ‚Üí Genera una secuencia de n√∫meros del 1 al NUM_BREAKS (el n√∫mero de puntos de cambio entre intervalos).\nMultiplica la ra√≠z del √°rbol T.rootAge() por esta secuencia para escalar los intervalos al tiempo evolutivo real.\nDivide entre NUM_INTERVALS para normalizar y hacer que los intervalos sean de igual tama√±o.\nabs(...) ‚Üí Convierte los valores a positivos porque las edades van en direcci√≥n del presente al pasado.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#correcci√≥n-por-muestreo-incompleto",
    "href": "chapters/u1_intro_diversification_2.html#correcci√≥n-por-muestreo-incompleto",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Correcci√≥n por Muestreo Incompleto",
    "text": "Correcci√≥n por Muestreo Incompleto\nrho &lt;- T.ntips()/26",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#inicializando-el-nodo-estoc√°stico-del-√°rbol-de-tiempos",
    "href": "chapters/u1_intro_diversification_2.html#inicializando-el-nodo-estoc√°stico-del-√°rbol-de-tiempos",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Inicializando el Nodo Estoc√°stico del √Årbol de Tiempos",
    "text": "Inicializando el Nodo Estoc√°stico del √Årbol de Tiempos\ntimetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#asignando-datos-observados-al-√°rbol",
    "href": "chapters/u1_intro_diversification_2.html#asignando-datos-observados-al-√°rbol",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Asignando Datos Observados al √Årbol",
    "text": "Asignando Datos Observados al √Årbol\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#creando-el-modelo-completo",
    "href": "chapters/u1_intro_diversification_2.html#creando-el-modelo-completo",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Creando el Modelo Completo",
    "text": "Creando el Modelo Completo\nEncuentra todas las conexiones en la red bayesiana y las agrupa en un solo objeto model()\nmymodel = model(rho)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuraci√≥n-de-los-monitores",
    "href": "chapters/u1_intro_diversification_2.html#configuraci√≥n-de-los-monitores",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Configuraci√≥n de los Monitores",
    "text": "Configuraci√≥n de los Monitores\nmonitors.append(mnModel(filename=\"../output/Eupomphini_EBD.log\", printgen=10, separator = TAB))\nCrea un monitor (mnModel) que guarda los valores de todos los par√°metros del modelo.\n‚úî Guarda los resultados en el archivo \"output/primates_EBD.log\".\n‚úî printgen=10 ‚Üí Especifica que se guardar√° un estado cada 10 generaciones.\n‚úî separator=TAB ‚Üí Usa tabulaciones para separar los valores en el archivo de salida.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#creaci√≥n-de-monitores-para-las-tasas-de-diversificaci√≥n-y-extinci√≥n",
    "href": "chapters/u1_intro_diversification_2.html#creaci√≥n-de-monitores-para-las-tasas-de-diversificaci√≥n-y-extinci√≥n",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Creaci√≥n de Monitores para las Tasas de diversificaci√≥n y Extinci√≥n",
    "text": "Creaci√≥n de Monitores para las Tasas de diversificaci√≥n y Extinci√≥n\n# Tasas de especiaci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_rates.log\", printgen=10, separator = TAB, speciation))\n\n# Intervalos de tiempo de especiaci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_times.log\", printgen=10, separator = TAB, interval_times))\n\n# Tasas de extinci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_rates.log\", printgen=10, separator = TAB, extinction))\n\n#Intervalos de tiempo de extinci√≥n\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_times.log\", printgen=10, separator = TAB, interval_times))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#creaci√≥n-de-un-monitor-en-pantalla",
    "href": "chapters/u1_intro_diversification_2.html#creaci√≥n-de-un-monitor-en-pantalla",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Creaci√≥n de un Monitor en Pantalla",
    "text": "Creaci√≥n de un Monitor en Pantalla\nmonitors.append(mnScreen(printgen=1000, extinction_global_scale, speciation_global_scale))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuraci√≥n-del-mcmc",
    "href": "chapters/u1_intro_diversification_2.html#configuraci√≥n-del-mcmc",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Configuraci√≥n del MCMC",
    "text": "Configuraci√≥n del MCMC\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\nCrea el objeto MCMC mymcmc que utilizar√°:\n\nmymodel ‚Üí El modelo definido anteriormente.\nmonitors ‚Üí Los monitores configurados.\nmoves ‚Üí Los movimientos de MCMC definidos antes.\nnruns=2 ‚Üí Ejecuta dos cadenas independientes de MCMC.\ncombine=\"mixed\" ‚Üí Mezcla las cadenas al final del proceso para mejorar la estimaci√≥n de par√°metros.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_2.html#ejecutar-el-mcmc",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=50000, tuningInterval=200)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#visualizaci√≥n-de-las-tasas-de-diversificaci√≥n",
    "href": "chapters/u1_intro_diversification_2.html#visualizaci√≥n-de-las-tasas-de-diversificaci√≥n",
    "title": "Modelos con cambios en las tasas de diversificaci√≥n",
    "section": "Visualizaci√≥n de las tasas de diversificaci√≥n",
    "text": "Visualizaci√≥n de las tasas de diversificaci√≥n\nFinalmente, generamos un gr√°fico que muestra c√≥mo las tasas de diversificaci√≥n y extinci√≥n han cambiado a lo largo del tiempo.\n\nlibrary(RevGadgets)\n\n# Especificar la ruta de los archivos de salida \nspeciation_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_times.log\"\nspeciation_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_rates.log\"\nextinction_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_times.log\"\nextinction_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_rates.log\"\n\n# Leer y procesar los datos\nrates &lt;- processDivRates(speciation_time_log = speciation_time_file,\n                         speciation_rate_log = speciation_rate_file,\n                         extinction_time_log = extinction_time_file,\n                         extinction_rate_log = extinction_rate_file,\n                         burnin = 0.25, # Se descarta el 25% inicial de las iteraciones como burn-in\n                         summary = \"median\")  # Se toman las tasas medianas como resumen\n\n# Graficar las tasas atravez del tiempo\np &lt;- plotDivRates(rates = rates) +\n  xlab(\"Millions of years ago\") +\n  ylab(\"Rate per million years\")\n\np",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>7</span>¬† <span class='chapter-title'>Modelos con cambios en las tasas de diversificaci√≥n</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html",
    "href": "chapters/u1_intro_diversification_3.html",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "",
    "text": "Presentaci√≥n: Estimaci√≥n de Eventos de Extinci√≥n Masiva\nHaz clic en la imagen para ver el PDF de la presentaci√≥n",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#cargar-librer√≠as-y-el-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification_3.html#cargar-librer√≠as-y-el-√°rbol-filogen√©tico",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Cargar librer√≠as y el √°rbol filogen√©tico",
    "text": "Cargar librer√≠as y el √°rbol filogen√©tico\n\n# Cargar las librer√≠as necesarias\nlibrary(ape)       \nlibrary(TreePar)\nlibrary(tidyverse)\nlibrary(ggtree)\n\n# Cargar el √°rbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el √°rbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#obtenci√≥n-de-los-tiempos-de-diversificaci√≥n",
    "href": "chapters/u1_intro_diversification_3.html#obtenci√≥n-de-los-tiempos-de-diversificaci√≥n",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Obtenci√≥n de los tiempos de diversificaci√≥n",
    "text": "Obtenci√≥n de los tiempos de diversificaci√≥n\nExtraeremos y ordenaremos los tiempos de diversificaci√≥n (tiempos de ramificaci√≥n) del √°rbol:\n\n# Obtener y ordenar los tiempos de especiaci√≥n\n# La funci√≥n getx() extrae los tiempos de ramificaci√≥n del √°rbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulaci√≥n.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "href": "chapters/u1_intro_diversification_3.html#configuraci√≥n-de-par√°metros-para-el-an√°lisis",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Configuraci√≥n de Par√°metros para el An√°lisis",
    "text": "Configuraci√≥n de Par√°metros para el An√°lisis\nDefiniremos los par√°metros necesarios para el an√°lisis de cambios en las tasas de diversificaci√≥n:\n\nrho &lt;- 22/26  # Proporci√≥n de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tama√±o de la grilla de b√∫squeda de cambios de tasa (en millones de a√±os)\nstart &lt;- min(times)   # Tiempo inicial para la b√∫squeda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la b√∫squeda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#modelo-con-un-evento-de-extinci√≥n-masiva",
    "href": "chapters/u1_intro_diversification_3.html#modelo-con-un-evento-de-extinci√≥n-masiva",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Modelo con un Evento de Extinci√≥n Masiva",
    "text": "Modelo con un Evento de Extinci√≥n Masiva\n\n# Ejecutar la optimizaci√≥n con detecci√≥n de extinci√≥n masiva\nres_MEE &lt;- bd.shifts.optim(times, c(rho, 1), grid, start, end, ME = TRUE, survival = 1) # Activar detecci√≥n de extinciones masivas\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.817460e+01 1.195857e-07 1.246163e-01 3.649862e-01 9.252293e-01\n\n\nInterpretaci√≥n\n\n\n\n\n\n\n\n\n√çndice\nPar√°metro estimado\nDescripci√≥n\n\n\n\n\n1\n68.1746\nVerosimilitud (log-likelihood)\n\n\n2\n1.195857e-07\nTurnover (\\(\\epsilon\\))\n\n\n3\n0.1246163\nDiversificaci√≥n (\\(r\\))\n\n\n4\n0.3649862\nEspecies muestreadas antes del evento (\\(\\rho_0\\))\n\n\n5\n0.925229\nTiempo antes del evento (\\(t_0\\))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#modelo-con-dos-eventos-de-extinci√≥n-masiva",
    "href": "chapters/u1_intro_diversification_3.html#modelo-con-dos-eventos-de-extinci√≥n-masiva",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Modelo con dos Eventos de Extinci√≥n Masiva",
    "text": "Modelo con dos Eventos de Extinci√≥n Masiva\n\n# Ejecutar la optimizaci√≥n con detecci√≥n de extinci√≥n masiva\nres_MEE2 &lt;- bd.shifts.optim(times, c(rho, 1, 1), grid, start, end, ME = TRUE, survival = 1) # Activar detecci√≥n de extinciones masivas\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.817460e+01 1.195857e-07 1.246163e-01 3.649862e-01 9.252293e-01\n\n[[3]]\n[1] 6.603778e+01 6.878473e-08 2.676687e-01 7.137593e-02 7.086373e-01\n[6] 9.252293e-01 9.525229e+00\n\n\nInterpretaci√≥n\n\n\n\n\n\n\n\n\n√çndice\nPar√°metro estimado\nDescripci√≥n\n\n\n\n\n1\n66.03778\nVerosimilitud (log-likelihood)\n\n\n2\n6.878473e-08\nTurnover (\\(\\epsilon\\))\n\n\n3\n0.2676687\nDiversificaci√≥n (\\(r\\))\n\n\n4\n0.07137593\nEspecies muestreadas antes del evento (\\(\\rho_0\\))\n\n\n5\n0.7086373\nEspecies muestreadas despu√©s del evento (\\(\\rho_1\\))\n\n\n6\n0.9252293\nTiempo antes del evento (\\(t_0\\))\n\n\n7\n9.525229\nTiempo despu√©s del evento (\\(t_1\\))\n\n\n\nComparaci√≥n MEE un evento vs MEE dos cambio\n\n## Verosimilitud MEE un evento\nres_MEE[[2]][[2]][1]\n\n[1] 68.1746\n\n## Verosimilitud MEE dos eventos\nres_MEE2[[2]][[3]][1]\n\n[1] 66.03778\n\n\n\nChiSq1 = 2 * (res_MEE[[2]][[2]][1] - res_MEE2[[2]][[3]][1])\nChiSq1\n\n[1] 4.273639\n\ndgf &lt;- 6 - 4\npchiSq1 &lt;- pchisq(ChiSq1, df=dgf)\npchiSq1\n\n[1] 0.8819704\n\n\nInterpretaci√≥n de los resultados\n\nChi-cuadrado (ChiSq1) = 4.273639\n\nEsto representa cu√°nto mejor se ajusta el modelo con 2 eventos en comparaci√≥n con el modelo con 1 evento.\n\nGrados de libertad = 2\n\nSe obtiene de la diferencia en el n√∫mero de par√°metros entre ambos modelos (6 - 4 = 2).\n\np-value = 0.8819704\n\nEl p-valor es alto (\\(&gt;0.05\\)), lo que indica que NO hay evidencia suficiente para preferir el modelo con 2 eventos de extinci√≥n sobre el modelo con 1 evento.\nEsto sugiere que el modelo con 1 evento de extinci√≥n es suficiente para explicar los datos, y agregar un segundo evento no mejora significativamente el ajuste del modelo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#introducci√≥n",
    "href": "chapters/u1_intro_diversification_3.html#introducci√≥n",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Introducci√≥n",
    "text": "Introducci√≥n\nEn este tutorial, aprenderemos a inferir eventos de extinci√≥n masiva utilizando un modelo Episodic Fossilized Birth-Death (EFBD) en RevBayes. Siguiendo el tutorial oficial Mass Extinction Estimation.\n\n¬øQu√© es el modelo de diversificaci√≥n epis√≥dico?\nEl modelo episodic birth-death es un proceso en el que las tasas de especiaci√≥n, extinci√≥n y fosilizaci√≥n son constantes dentro de intervalos de tiempo, pero pueden cambiar entre ellos. En ciertos momentos, este modelo incorpora la posibilidad de que ocurra una extinci√≥n masiva, en la que un gran porcentaje de linajes desaparece de manera instant√°nea con una probabilidad \\(M_i\\).\n\n\nRelaci√≥n con otros modelos de diversificaci√≥n\nEste modelo es una extensi√≥n del modelo de diversificaci√≥n con tasas variables en el tiempo, tratado en el tutorial Episodic Diversification Rate Estimation. Adem√°s, dado que permite la incorporaci√≥n de f√≥siles en la filogenia, es √∫til revisar los tutoriales de Combined-Evidence Analysis y Fossilized Birth-Death Process for Analysis of Extant Taxa and Fossil Specimens.\n\n\nConsideraciones clave\nPara evitar confundir cambios en las tasas de diversificaci√≥n con eventos de extinci√≥n masiva, este modelo incorpora un Horseshoe Markov Random Field (MRF), el cual permite detectar correctamente los cambios en especiaci√≥n, extinci√≥n y fosilizaci√≥n sin interpretaciones err√≥neas.\nEste enfoque est√° basado en la implementaci√≥n presentada en Magee y H√∂hna (2021) y nos permitir√° explorar c√≥mo la diversidad ha cambiado a lo largo del tiempo y si existen eventos de extinci√≥n masiva en nuestra filogenia.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#c√°lculo-de-valores-necesarios-para-el-an√°lisis",
    "href": "chapters/u1_intro_diversification_3.html#c√°lculo-de-valores-necesarios-para-el-an√°lisis",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "C√°lculo de Valores Necesarios para el An√°lisis",
    "text": "C√°lculo de Valores Necesarios para el An√°lisis\nAntes de definir los priors en nuestro modelo de estimaci√≥n de extinciones masivas, es importante calcular valores iniciales para las tasas de especiaci√≥n, extinci√≥n y fosilizaci√≥n. Para ello, ejecutaremos un modelo de tasa constante usando el enfoque Fossilized Birth-Death Process (FBDP) en RevBayes.\nEste script permite estimar los valores base para los priors en las tasas de diversificaci√≥n.\n\nPasos clave del script\n\nLeer los datos filogen√©ticos desde el archivo subarbol_ingroup.nex.\nDefinir priors iniciales para las tasas de especiaci√≥n, extinci√≥n y fosilizaci√≥n usando una distribuci√≥n Half-Cauchy(0,0.1).\nConfigurar movimientos del MCMC para optimizar la exploraci√≥n del espacio de par√°metros.\nDefinir el modelo FBDP, donde:\n\nlambda = tasa de especiaci√≥n\nmu = tasa de extinci√≥n\nphi = tasa de fosilizaci√≥n\nPhi = probabilidad de muestreo de especies extantes\n\nEjecutar la inferencia bayesiana (MCMC) para estimar los par√°metros.\n\n**Guarda este script como mcmc_CRFBD.Rev y ejec√∫talo en RevBayes:**\n#######################\n# Lectura de los Datos #\n#######################\n\n# Leer el √°rbol filogen√©tico \"observado\"\nT &lt;- readTrees(\"../data/subarbol_ingroup.nex\")[1]\n\n# Extraer taxones del √°rbol\ntaxa &lt;- T.taxa()\n\n# Inicializar vectores de movimientos y monitores\nmoves    = VectorMoves()\nmonitors = VectorMonitors()\n\n##########\n# Priors #\n##########\n\n# Definir priors iniciales con distribuci√≥n Half-Cauchy(0,0.1)\nspeciation_rate ~ dnHalfCauchy(0.0,0.1)\nmoves.append( mvScaleBactrian(speciation_rate, weight=7.5) )\nmoves.append( mvRandomDive(speciation_rate, weight=2.5) )\n\nextinction_rate ~ dnHalfCauchy(0.0,0.1)\nmoves.append( mvScaleBactrian(extinction_rate, weight=7.5) )\nmoves.append( mvRandomDive(extinction_rate, weight=2.5) )\n\nfossilization_rate ~ dnHalfCauchy(0.0,0.1)\nmoves.append( mvScaleBactrian(fossilization_rate, weight=7.5) )\nmoves.append( mvRandomDive(fossilization_rate, weight=2.5) )\n\n# Agregar un movimiento conjunto para explorar m√∫ltiples par√°metros simult√°neamente\njoint_move = mvAVMVN(weight=10.0)\njoint_move.addVariable(speciation_rate)\njoint_move.addVariable(extinction_rate)\njoint_move.addVariable(fossilization_rate)\nmoves.append( joint_move )\n\n### Probabilidad de muestreo de especies extantes\n# Se fija en 22/26, ya que hay ~26 especies descritas de Eupomphini y se han muestreado 22.\nsampling_at_present &lt;- 22/26\n\n##############\n# Definir el Modelo #\n##############\n\ntimetree ~ dnFBDP(rootAge = T.rootAge(),\n                  lambda = speciation_rate,\n                  mu = extinction_rate,\n                  phi = fossilization_rate,\n                  Phi = sampling_at_present,\n                  condition = \"time\",\n                  taxa = taxa,\n                  initialTre = T)\n\n# Restringir el modelo con el √°rbol observado\ntimetree.clamp(T)\n\n# Envolver el modelo en un workspace\nmymodel = model(sampling_at_present)\n\n#############\n# Monitores #\n#############\n\n# Guardar los valores de los par√°metros en un archivo de salida\nmonitors.append( mnModel(filename=\"../out/eupomphini_CRFBD.log\", printgen=10, separator = TAB) )\nmonitors.append( mnScreen(printgen=1000) )\n\n################\n# Ejecutar el MCMC #\n################\n\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\n\n# Ejecutar la cadena MCMC con 50,000 generaciones\nmymcmc.run(generations=50000, tuningInterval=200)\n\n# Salir de RevBayes\nq()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#ejecutar-en-r-c√°lculo-de-priors-y-hiperprior-para-revbayes-con-revgadgets",
    "href": "chapters/u1_intro_diversification_3.html#ejecutar-en-r-c√°lculo-de-priors-y-hiperprior-para-revbayes-con-revgadgets",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Ejecutar en R: C√°lculo de Priors y Hiperprior para RevBayes con RevGadgets",
    "text": "Ejecutar en R: C√°lculo de Priors y Hiperprior para RevBayes con RevGadgets\n\n# Cargar la librer√≠a RevGadgets\nlibrary(RevGadgets)\n\n# Leer las tasas de diversificaci√≥n desde el archivo de salida de RevBayes\ndiversification_rates &lt;- readTrace(\"../docs/u1_PatDiv/output/CRFBD/eupomphini_CRFBD.log\", burnin = 0.25)[[1]]\n\n# Ajustar una distribuci√≥n Gamma a las tasas inferidas\nspeciation_prior &lt;- posteriorSamplesToParametricPrior(diversification_rates$speciation_rate, \"gamma\")\nextinction_prior &lt;- posteriorSamplesToParametricPrior(diversification_rates$extinction_rate, \"gamma\")\nfossilization_prior &lt;- posteriorSamplesToParametricPrior(diversification_rates$fossilization_rate, \"gamma\")\n\n# Imprimir los valores de los par√°metros de la distribuci√≥n Gamma\nprint(speciation_prior)  # [1] -&gt; alpha, [2] -&gt; beta\n\ngamma.shape  gamma.rate \n   10.31672   104.25685 \n\nprint(extinction_prior)  # [1] -&gt; alpha, [2] -&gt; beta\n\ngamma.shape  gamma.rate \n  0.5185615  32.6386155 \n\nprint(fossilization_prior)  # [1] -&gt; alpha, [2] -&gt; beta\n\ngamma.shape  gamma.rate \n  0.5099949 146.6218854 \n\n# Calcular el hiperprior para RevBayes usando HSMRF con 10 intervalos\nhyperprior_value &lt;- setMRFGlobalScaleHyperpriorNShifts(10, \"HSMRF\")\n\n# Imprimir el valor del hiperprior\nprint(hyperprior_value)\n\n[1] 0.04446432",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#c√≥digo-en-revbayes-para-estimaci√≥n-de-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#c√≥digo-en-revbayes-para-estimaci√≥n-de-extinciones-masivas",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "C√≥digo en RevBayes para Estimaci√≥n de Extinciones Masivas",
    "text": "C√≥digo en RevBayes para Estimaci√≥n de Extinciones Masivas\nGuarda este script como mcmc_EFBD_ME.Rev y ejec√∫talo en RevBayes:",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#lectura-del-√°rbol",
    "href": "chapters/u1_intro_diversification_3.html#lectura-del-√°rbol",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Lectura del √°rbol",
    "text": "Lectura del √°rbol\nComenzamos cargando el √°rbol filogen√©tico previamente filtrado.\n# Cargar el √°rbol filogen√©tico desde un archivo en formato NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Extraer la informaci√≥n taxon√≥mica del √°rbol\n taxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "href": "chapters/u1_intro_diversification_3.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-el-n√∫mero-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificaci√≥n.",
    "href": "chapters/u1_intro_diversification_3.html#definir-el-n√∫mero-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificaci√≥n.",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Definir el n√∫mero de intervalos en los que dividiremos el tiempo para modelar la diversificaci√≥n.",
    "text": "Definir el n√∫mero de intervalos en los que dividiremos el tiempo para modelar la diversificaci√≥n.\nNUM_INTERVALS = 10  # N√∫mero total de intervalos de tiempo\nNUM_BREAKS := NUM_INTERVALS - 1  # N√∫mero de puntos de cambio entre intervalos",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#configuraci√≥n-de-los-intervalos-de-tiempo",
    "href": "chapters/u1_intro_diversification_3.html#configuraci√≥n-de-los-intervalos-de-tiempo",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Configuraci√≥n de los Intervalos de Tiempo",
    "text": "Configuraci√≥n de los Intervalos de Tiempo\nEl modelo Episodic Fossilized Birth-Death asume que los puntos en el tiempo est√°n distribuidos equidistantemente. Para ello, creamos un vector de tiempos que servir√° para definir las tasas de especiaci√≥n, extinci√≥n y fosilizaci√≥n, as√≠ como para modelar las extinciones masivas.\ninterval_times &lt;- abs(T.rootAge() * seq(1, NUM_BREAKS, 1) / NUM_INTERVALS)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#priors-en-las-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#priors-en-las-extinciones-masivas",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Priors en las Extinciones Masivas",
    "text": "Priors en las Extinciones Masivas\nEl modelo utiliza una mezcla de saltos reversibles (reversible jump mixture model), lo que significa que la inferencia de extinciones masivas se realiza en dos partes:\n\nProbabilidad de que ocurra una extinci√≥n masiva en un intervalo de tiempo determinado.\nProbabilidad de que un linaje se extinga en caso de que haya una extinci√≥n masiva.\n\nPara establecer un n√∫mero esperado de extinciones masivas, podemos definir un valor conservador como 1.0:\nexpected_number_of_mass_extinctions &lt;- 1.0\nComo hay NUM_BREAKS posibles puntos de extinci√≥n, calculamos la probabilidad de que no ocurra una extinci√≥n masiva en un intervalo dado:\n mix_p &lt;- Probability(1.0 - expected_number_of_mass_extinctions / NUM_BREAKS)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-un-prior-para-la-mortalidad-en-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#definir-un-prior-para-la-mortalidad-en-extinciones-masivas",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Definir un Prior para la Mortalidad en Extinciones Masivas",
    "text": "Definir un Prior para la Mortalidad en Extinciones Masivas\nDado que las extinciones masivas suelen eliminar la mayor√≠a de los linajes, utilizamos una distribuci√≥n Beta(18,2) como prior. Esta distribuci√≥n tiene:\n\nMedia de 0.9, lo que implica que, en promedio, el 90% de los linajes mueren en una extinci√≥n masiva.\nIntervalo de confianza del 95% entre [0.74, 0.987], asegurando que la mayor√≠a de los linajes se extinguen cuando ocurre una extinci√≥n masiva.\n\nAhora configuramos el prior para todas las NUM_BREAKS posibles extinciones masivas:\nfor (i in 1:NUM_BREAKS) {\n    mass_extinction_probabilities[i] ~ dnReversibleJumpMixture(0.0, dnBeta(18.0, 2.0), mix_p)\n    moves.append(mvRJSwitch(mass_extinction_probabilities[i]))\n    moves.append(mvSlideBactrian(mass_extinction_probabilities[i]))\n}\n\n¬øQu√© hace este c√≥digo?\n‚úÖ dnReversibleJumpMixture(0.0, dnBeta(18.0, 2.0), mix_p)\n\nDefine un modelo en el que cada intervalo de tiempo tiene una probabilidad de albergar una extinci√≥n masiva.\nSi hay una extinci√≥n masiva, se modela con dnBeta(18.0, 2.0).\nSi no hay extinci√≥n, se asigna un valor de 0.0.\n\n‚úÖ Movimientos del MCMC\nPara explorar correctamente los par√°metros de extinciones masivas en el an√°lisis MCMC, agregamos:\n\nmvRJSwitch ‚Üí Determina si hay o no una extinci√≥n masiva en un intervalo.\nmvSlideBactrian ‚Üí Ajusta la probabilidad de muerte en caso de extinci√≥n.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#priors-sobre-la-variabilidad-de-las-tasas",
    "href": "chapters/u1_intro_diversification_3.html#priors-sobre-la-variabilidad-de-las-tasas",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Priors sobre la Variabilidad de las Tasas",
    "text": "Priors sobre la Variabilidad de las Tasas\n\nVariabilidad en las Tasas de Especiaci√≥n, Extinci√≥n y Fosilizaci√≥n\nPara modelar la variaci√≥n en las tasas de diversificaci√≥n a lo largo del tiempo, utilizamos el Horseshoe Markov Random Field (HSMRF) Birth-Death Model (Magee et al.¬†2020).\nEste modelo:\n\nPermite que las tasas de diversificaci√≥n cambien a lo largo del tiempo.\nUsa una distribuci√≥n Horseshoe (Carvalho et al.¬†2010) para modelar los cambios en la escala logar√≠tmica.\nAsume que la mayor√≠a de los cambios son peque√±os, pero permite saltos grandes en las tasas.\n\n\n\nEscala Global de Variabilidad\nPara controlar la variabilidad general de las tasas de especiaci√≥n, extinci√≥n y fosilizaci√≥n desde el presente hasta el pasado, usamos un par√°metro de escala global.\nTambi√©n debemos definir un hiperprior para la escala global, que ayuda a determinar la variabilidad esperada en las tasas. En este caso, usamos el valor 0.044 cuando trabajamos con 10 intervalos de tasa.\nspeciation_rate_global_scale_hyperprior &lt;- 0.044\nextinction_rate_global_scale_hyperprior &lt;- 0.044\nfossilization_rate_global_scale_hyperprior &lt;- 0.044\nNota: Si se usa un n√∫mero diferente de intervalos, se puede calcular el hiperprior con la funci√≥n de RevGadgets: setMRFGlobalScaleHyperpriorNShifts(NUM_INTERVALS).\n\n\nDefinir los Priors para las Tasas de Especiaci√≥n, Extinci√≥n y Fosilizaci√≥n\nCada par√°metro de escala global se modela con una distribuci√≥n Half-Cauchy centrada en 0 con par√°metro de dispersi√≥n 1.\nspeciation_rate_global_scale ~ dnHalfCauchy(0,1)\nextinction_rate_global_scale ~ dnHalfCauchy(0,1)\nfossilization_rate_global_scale ~ dnHalfCauchy(0,1)\n¬øPor qu√© usamos una distribuci√≥n Half-Cauchy?\n\nFlexible: Permite modelar valores grandes sin restringir excesivamente la variabilidad.\nEvita sesgos: No impone l√≠mites arbitrarios a los cambios de tasa.\nAsegura que las tasas sean positivas, ya que la distribuci√≥n Half-Cauchy solo tiene valores positivos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#especificaci√≥n-de-las-tasas-epis√≥dicas",
    "href": "chapters/u1_intro_diversification_3.html#especificaci√≥n-de-las-tasas-epis√≥dicas",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Especificaci√≥n de las Tasas Epis√≥dicas",
    "text": "Especificaci√≥n de las Tasas Epis√≥dicas\n\nModelado de las Tasas en el Tiempo\nPara modelar las tasas de especiaci√≥n, extinci√≥n y fosilizaci√≥n a lo largo del tiempo, utilizamos distribuciones Horseshoe Markov Random Field (HSMRF) en su escala logar√≠tmica.\nSin embargo, la tasa en el presente debe modelarse de manera distinta porque:\n\nNo est√° correlacionada con ninguna tasa anterior.\nSe modela hacia atr√°s en el tiempo en lugar de hacia adelante.\nEsto permite que, si conocemos alg√∫n evento que afect√≥ la diversificaci√≥n en un momento espec√≠fico (ej. hace 25 millones de a√±os), podamos incorporarlo en el an√°lisis.\n\n\n\nPriorizaci√≥n de la Primera Tasa (Tasa en el Presente)\nDado que el modelo contiene muchos par√°metros, utilizamos un enfoque emp√≠rico bayesiano (Empirical Bayes Strategy).\n\nPrimero, se ajusta un modelo FBD de tasa constante (Constant-Rate Fossilized Birth-Death).\nLuego, se extrae la distribuci√≥n posterior de esas tasas y se ajusta un prior Gamma para la tasa en el presente.\nEsto nos permite definir priors m√°s realistas y adaptados a los datos.\n\nEl archivo mcmc_CRFBD.Rev puede ejecutarse para estimar estas distribuciones, y la funci√≥n de RevGadgets posteriorSamplesToParametricPrior() permite ajustar una distribuci√≥n a las muestras posteriores.\nspeciation_rate_hyperprior_alpha &lt;- 10.31672 \nspeciation_rate_hyperprior_beta &lt;- 104.25685\nextinction_rate_hyperprior_alpha &lt;- 0.5185615\nextinction_rate_hyperprior_beta &lt;- 32.6386155\nfossilization_rate_hyperprior_alpha &lt;- 0.5099949\nfossilization_rate_hyperprior_beta &lt;- 146.6218854\n\nspeciation_rate_at_present ~ dnGamma(speciation_rate_hyperprior_alpha,speciation_rate_hyperprior_beta)\nextinction_rate_at_present ~ dnGamma(extinction_rate_hyperprior_alpha,extinction_rate_hyperprior_beta)\nfossilization_rate_at_present ~ dnGamma(fossilization_rate_hyperprior_alpha,fossilization_rate_hyperprior_beta)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-movimientos-para-las-tasas-en-el-presente",
    "href": "chapters/u1_intro_diversification_3.html#definir-movimientos-para-las-tasas-en-el-presente",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Definir Movimientos para las Tasas en el Presente",
    "text": "Definir Movimientos para las Tasas en el Presente\nEn este paso, aplicamos una variedad de movimientos para explorar eficientemente los valores para cada tasa en el presente (speciation_rate_at_present, extinction_rate_at_present, fossilization_rate_at_present), aplicamos diferentes tipos de movimientos:\nmoves.append( mvScaleBactrian(speciation_rate_at_present, weight=5) )\nmoves.append( mvScaleBactrian(extinction_rate_at_present, weight=5) )\nmoves.append( mvScaleBactrian(fossilization_rate_at_present, weight=5) )\n\nmoves.append( mvMirrorMultiplier(speciation_rate_at_present, weight=5) )\nmoves.append( mvMirrorMultiplier(extinction_rate_at_present, weight=5) )\nmoves.append( mvMirrorMultiplier(fossilization_rate_at_present, weight=5) )\n\nmoves.append( mvRandomDive(speciation_rate_at_present, weight=5) )\nmoves.append( mvRandomDive(extinction_rate_at_present, weight=5) )\nmoves.append( mvRandomDive(fossilization_rate_at_present, weight=5) )\n\nAplicar Movimientos Conjuntos\nLos par√°metros de especiaci√≥n, extinci√≥n y fosilizaci√≥n est√°n correlacionados, por lo que debemos aplicar movimientos conjuntos para evitar sesgos en la inferencia.\navmvn_rates_at_present = mvAVMVN(weight=50)\navmvn_rates_at_present.addVariable(speciation_rate_at_present)\navmvn_rates_at_present.addVariable(extinction_rate_at_present)\navmvn_rates_at_present.addVariable(fossilization_rate_at_present)\nmoves.append( avmvn_rates_at_present )\n\n\nAplicar un Movimiento de Escalado Dependiente (Up-Down Scale)\nPara mantener una relaci√≥n coherente entre las tasas de especiaci√≥n y extinci√≥n, aplicamos el movimiento de escalado Up-Down:\nup_down_move = mvUpDownScale(weight=5.0)\nup_down_move.addVariable(speciation_rate_at_present, TRUE)\nup_down_move.addVariable(extinction_rate_at_present, TRUE)\nmoves.append( up_down_move )\nResumen\n‚úÖ Se aplican movimientos individuales para explorar cada par√°metro por separado.\n‚úÖ Se usan movimientos conjuntos (mvAVMVN) para capturar correlaciones entre tasas.\n‚úÖ Se aplica mvUpDownScale para mantener relaciones biol√≥gicamente realistas entre las tasas.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#parametrizaci√≥n-no-centralizada-para-hsmrf",
    "href": "chapters/u1_intro_diversification_3.html#parametrizaci√≥n-no-centralizada-para-hsmrf",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Parametrizaci√≥n No Centralizada para HSMRF",
    "text": "Parametrizaci√≥n No Centralizada para HSMRF\nPara hacer posible el MCMC en el modelo HSMRF, utilizamos una parametrizaci√≥n no centralizada. Esto significa que:\n\nPrimero definimos los cambios en la escala logar√≠tmica de las tasas entre intervalos.\nLuego ensamblamos el vector de tasas, utilizando una combinaci√≥n de par√°metros globales y locales.\nImplementamos adaptabilidad local, permitiendo que algunas tasas var√≠en r√°pidamente y otras sean m√°s estables.\n\n\nAsignaci√≥n de Par√°metros de Escala Local\nCada intervalo de tiempo necesita una varianza espec√≠fica para la distribuci√≥n Horseshoe, lo que nos permite modelar la adaptabilidad local.\nfor (i in 1:NUM_BREAKS) {\n   # Escala variable para cada intervalo de tiempo\n  sigma_speciation_rate[i] ~ dnHalfCauchy(0,1)\n  sigma_extinction_rate[i] ~ dnHalfCauchy(0,1)\n  sigma_fossilization_rate[i] ~ dnHalfCauchy(0,1)\n\n  # Escala variable para cada intervalo de tiempo\n  sigma_speciation_rate[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_extinction_rate[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_fossilization_rate[i].setValue(runif(1,0.005,0.1)[1])\n\n   # Movimientos para los valores individuales de sigma\n  moves.append( mvScaleBactrian(sigma_speciation_rate[i], weight=5) )\n  moves.append( mvScaleBactrian(sigma_extinction_rate[i], weight=5) )\n  moves.append( mvScaleBactrian(sigma_fossilization_rate[i], weight=5) )\n\n  # Parametrizaci√≥n no centralizada del modelo HSMRF\n  delta_log_speciation_rate[i] ~ dnNormal( mean=0, sd=sigma_speciation_rate[i]*speciation_rate_global_scale*speciation_rate_global_scale_hyperprior )\n  delta_log_extinction_rate[i] ~ dnNormal( mean=0, sd=sigma_extinction_rate[i]*extinction_rate_global_scale*extinction_rate_global_scale_hyperprior )\n  delta_log_fossilization_rate[i] ~ dnNormal( mean=0, sd=sigma_fossilization_rate[i]*fossilization_rate_global_scale*fossilization_rate_global_scale_hyperprior )\n\n  # Inicializaci√≥n con valores aleatorios entre -0.1 y 0.1\n  delta_log_speciation_rate[i].setValue(runif(1,-0.1,0.1)[1])\n  delta_log_extinction_rate[i].setValue(runif(1,-0.1,0.1)[1])\n  delta_log_fossilization_rate[i].setValue(runif(1,-0.1,0.1)[1])\n \n  # Movimientos para Mejorar la Mezcla en MCMC\n  moves.append( mvSlideBactrian(delta_log_speciation_rate[i], weight=5) )\n  moves.append( mvSlideBactrian(delta_log_extinction_rate[i], weight=5) )\n  moves.append( mvSlideBactrian(delta_log_fossilization_rate[i], weight=5) )\n\n  # aplicamos movimientos de tipo Up-Down para mantener la correlaci√≥n entre los cambios de tasas\n  delta_up_down_move[i] = mvUpDownSlide(weight=5.0)\n  delta_up_down_move[i].addVariable(delta_log_speciation_rate[i],TRUE)\n  delta_up_down_move[i].addVariable(delta_log_extinction_rate[i],TRUE)\n  moves.append( delta_up_down_move[i] )\n}\nResumen\n‚úÖ Se modelan los cambios en las tasas en la escala logar√≠tmica usando una parametrizaci√≥n no centralizada.\n‚úÖ Se definen par√°metros de escala local (sigma), permitiendo que algunas tasas cambien m√°s r√°pido que otras.\n‚úÖ Se agregan movimientos (moves) para mejorar la mezcla de MCMC y evitar estancamientos en valores sub√≥ptimos.\n‚úÖ Se aplican movimientos Up-Down para correlacionar los cambios en especiaci√≥n y extinci√≥n.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#ensamblar-las-tasas-en-el-tiempo",
    "href": "chapters/u1_intro_diversification_3.html#ensamblar-las-tasas-en-el-tiempo",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Ensamblar las Tasas en el Tiempo",
    "text": "Ensamblar las Tasas en el Tiempo\nHasta ahora, hemos definido:\n‚úÖ Tasa en el presente (speciation_rate_at_present, etc.).\n‚úÖ Cambios en la escala logar√≠tmica (delta_log_speciation_rate, etc.).\n‚úÖ Par√°metros de escala local y global (sigma_speciation_rate, etc.).\nAhora, ensamblamos estos elementos en vectores de tasas continuas con la funci√≥n fnassembleContinuousMRF.\nspeciation_rate := fnassembleContinuousMRF(speciation_rate_at_present, delta_log_speciation_rate, initialValueIsLogScale=FALSE, order=1)\nextinction_rate := fnassembleContinuousMRF(extinction_rate_at_present, delta_log_extinction_rate, initialValueIsLogScale=FALSE, order=1)\nfossilization_rate := fnassembleContinuousMRF(fossilization_rate_at_present, delta_log_fossilization_rate, initialValueIsLogScale=FALSE, order=1)\n¬øQu√© hace fnassembleContinuousMRF?\n\nConvierte la serie de cambios logar√≠tmicos en una tasa continua a lo largo del tiempo.\nUsa la tasa en el presente como punto de partida.\ninitialValueIsLogScale=FALSE ‚Üí Significa que el primer valor NO est√° en escala logar√≠tmica.\norder=1 ‚Üí Indica que las tasas cambian en funci√≥n de una serie de incrementos.\n\n\nAplicar el Elliptical Slice Sampler\nEl Elliptical Slice Sampling (ESS) es un m√©todo eficiente para actualizar par√°metros en distribuciones Gaussianas sin rechazos.\n# Aplicar Elliptical Slice Sampling a los cambios logar√≠tmicos\nmoves.append( mvEllipticalSliceSamplingSimple(delta_log_speciation_rate, weight=5, tune=FALSE) )\nmoves.append( mvEllipticalSliceSamplingSimple(delta_log_extinction_rate, weight=5, tune=FALSE) )\nmoves.append( mvEllipticalSliceSamplingSimple(delta_log_fossilization_rate, weight=5, tune=FALSE) )\n\n\nAplicar Gibbs Sampling para Hiperpar√°metros\nLos hiperpar√°metros de escala global y local requieren un m√©todo de muestreo Gibbs, que permite actualizar grupos de par√°metros en funci√≥n de distribuciones condicionales.\n# Gibbs sampler para las escalas globales y locales\nmoves.append( mvHSRFHyperpriorsGibbs(speciation_rate_global_scale, sigma_speciation_rate, delta_log_speciation_rate, speciation_rate_global_scale_hyperprior, propGlobalOnly=0.75, weight=10) )\nmoves.append( mvHSRFHyperpriorsGibbs(extinction_rate_global_scale, sigma_extinction_rate, delta_log_extinction_rate, extinction_rate_global_scale_hyperprior, propGlobalOnly=0.75, weight=10) )\nmoves.append( mvHSRFHyperpriorsGibbs(fossilization_rate_global_scale, sigma_fossilization_rate, delta_log_fossilization_rate, fossilization_rate_global_scale_hyperprior, propGlobalOnly=0.75, weight=10) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#aplicar-movimientos-de-intercambio-swap-moves",
    "href": "chapters/u1_intro_diversification_3.html#aplicar-movimientos-de-intercambio-swap-moves",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Aplicar Movimientos de Intercambio (Swap Moves)",
    "text": "Aplicar Movimientos de Intercambio (Swap Moves)\nPara mejorar la mezcla del MCMC, permitimos intercambiar valores de delta_log y sigma entre intervalos de tiempo adyacentes.\n# Intercambio de intervalos adyacentes en los cambios logar√≠tmicos y escalas locales\nmoves.append( mvHSRFIntervalSwap(delta_log_speciation_rate, sigma_speciation_rate, weight=5) )\nmoves.append( mvHSRFIntervalSwap(delta_log_extinction_rate, sigma_extinction_rate, weight=5) )\nmoves.append( mvHSRFIntervalSwap(delta_log_fossilization_rate, sigma_fossilization_rate, weight=5) )\nResumen\n‚úÖ Se ensamblan las tasas de diversificaci√≥n utilizando fnassembleContinuousMRF.\n‚úÖ Se aplica Elliptical Slice Sampling para actualizar los cambios en la escala logar√≠tmica.\n‚úÖ Se usa muestreo Gibbs para mejorar la estimaci√≥n de los hiperpar√°metros.\n‚úÖ Se aplican movimientos de intercambio (swap moves) para mejorar la mezcla en MCMC.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#muestreo-incompleto-de-taxones",
    "href": "chapters/u1_intro_diversification_3.html#muestreo-incompleto-de-taxones",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Muestreo Incompleto de Taxones",
    "text": "Muestreo Incompleto de Taxones\nEn estudios de diversificaci√≥n, es importante considerar el sesgo de muestreo, ya que en muchos casos solo se ha muestreado una parte de las especies vivientes.\nPara este an√°lisis, sabemos que hemos muestreado 22 de 26 especies de Eupomphini vivientes. Por lo tanto, definimos un nodo constante que representa esta proporci√≥n:\nsampling_at_present &lt;- 22/26",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-la-edad-de-la-ra√≠z",
    "href": "chapters/u1_intro_diversification_3.html#definir-la-edad-de-la-ra√≠z",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Definir la Edad de la Ra√≠z",
    "text": "Definir la Edad de la Ra√≠z\nEl modelo Fossilized Birth-Death Process (FBDP) necesita un par√°metro de edad de la ra√≠z (rootAge).\nDado que usamos un √°rbol fijo, podemos extraer directamente la edad de la ra√≠z desde el √°rbol cargado:\nroot_time &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#especificar-el-√°rbol-temporal",
    "href": "chapters/u1_intro_diversification_3.html#especificar-el-√°rbol-temporal",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Especificar el √Årbol Temporal",
    "text": "Especificar el √Årbol Temporal\nCon todos los par√°metros listos, podemos definir el nodo estoc√°stico que representa el √°rbol temporal usando el modelo Episodic Fossilized Birth-Death (dnFBDP):\ntimetree ~ dnFBDP(rootAge = T.rootAge(), timeline = interval_times, lambda = speciation_rate, mu = extinction_rate, phi = fossilization_rate, Mu = mass_extinction_probabilities, Phi = sampling_at_present, condition = \"time\", taxa = taxa, initialTree = T)\nüîπ ¬øQu√© representa cada par√°metro?\n\n\n\n\n\n\n\nPar√°metro\nDescripci√≥n\n\n\n\n\nrootAge\nEdad de la ra√≠z del √°rbol.\n\n\ntimeline\nDivisi√≥n del tiempo en intervalos.\n\n\nlambda\nTasa de especiaci√≥n (cambiante en el tiempo).\n\n\nmu\nTasa de extinci√≥n (cambiante en el tiempo).\n\n\nphi\nTasa de fosilizaci√≥n.\n\n\nMu\nProbabilidad de que ocurra una extinci√≥n masiva en cada intervalo.\n\n\nPhi\nProporci√≥n de especies muestreadas.\n\n\ncondition=\"time\"\nSe asume que el proceso ocurre en el tiempo (puede cambiarse si queremos condicionar en el muestreo de la ra√≠z).\n\n\ntaxa\nLista de taxones en el an√°lisis.\n\n\ninitialTree\n√Årbol inicial para comenzar la inferencia.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#fijarlo-a-los-datos-observados",
    "href": "chapters/u1_intro_diversification_3.html#fijarlo-a-los-datos-observados",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Fijarlo a los datos observados",
    "text": "Fijarlo a los datos observados\nUna vez que hemos definido el √°rbol temporal (timetree), debemos fijarlo a los datos observados. Esto significa que no estamos infiriendo la filogenia, sino que usamos un √°rbol previamente estimado.\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-el-modelo-completo",
    "href": "chapters/u1_intro_diversification_3.html#definir-el-modelo-completo",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Definir el Modelo Completo",
    "text": "Definir el Modelo Completo\nAhora encapsulamos todo el modelo dentro de un objeto de workspace, lo que permite a RevBayes reconocer todas las variables y relaciones definidas.\nmymodel = model(speciation_rate)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#configurar-los-monitores",
    "href": "chapters/u1_intro_diversification_3.html#configurar-los-monitores",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Configurar los Monitores",
    "text": "Configurar los Monitores\nLos monitores en RevBayes permiten registrar el estado de los par√°metros durante la ejecuci√≥n del MCMC.\nDefinimos varios tipos de monitores:\n1Ô∏è‚É£ Monitor principal (mnModel): Guarda el estado de todos los par√°metros del modelo.\n2Ô∏è‚É£ Monitores de archivo (mnFile): Almacenan par√°metros espec√≠ficos en archivos separados para facilitar el an√°lisis posterior.\n3Ô∏è‚É£ Monitor de pantalla (mnScreen): Muestra valores clave en la consola durante la ejecuci√≥n.\n\nMonitor Principal\nEste monitor guarda todas las variables del modelo en un solo archivo. Se ejecutar√° cada 10 generaciones.\nmonitors.append( mnModel(filename=\"output/eupomphini_EFBDME.log\", printgen=10, separator=TAB) )\n\n\nMonitores de Archivo para Par√°metros Espec√≠ficos\nPara visualizar mejor los resultados, registramos las tasas de especiaci√≥n, extinci√≥n, fosilizaci√≥n y extinci√≥n masiva en archivos separados.\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_speciation_rates.log\", printgen=10, separator=TAB, speciation_rate) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_speciation_rate_times.log\", printgen=10, separator=TAB, interval_times) )\n\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_extinction_rates.log\", printgen=10, separator=TAB, extinction_rate) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_extinction_rate_times.log\", printgen=10, separator=TAB, interval_times) )\n\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_fossilization_rates.log\", printgen=10, separator=TAB, fossilization_rate) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_fossilization_rate_times.log\", printgen=10, separator=TAB, interval_times) )\n\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_mass_extinction_probabilities.log\", printgen=10, separator=TAB, mass_extinction_probabilities) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_mass_extinction_times.log\", printgen=10, separator=TAB, interval_times) )\n\n\nMonitor de Consola\nEste monitor muestra valores clave en pantalla cada 1000 generaciones, permitiendo hacer un seguimiento del MCMC en tiempo real.\nmonitors.append( mnScreen(printgen=1000, speciation_rate_global_scale, extinction_rate_global_scale, fossilization_rate_global_scale) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#inicializar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_3.html#inicializar-y-ejecutar-el-mcmc",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Inicializar y Ejecutar el MCMC",
    "text": "Inicializar y Ejecutar el MCMC\nCon el modelo y los monitores listos, creamos el objeto MCMC e iniciamos la simulaci√≥n.\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_3.html#ejecutar-el-mcmc",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=30000, tuningInterval=200)\n¬øQu√© significa esto?\n\nCorre 30,000 generaciones, con m√°s generaciones puede tomar varias horas dependiendo del hardware.\ntuningInterval=200 ajusta los movimientos cada 200 iteraciones para mejorar la eficiencia.\nSi el MCMC tarda demasiado, puedes probar con menos generaciones (100,000 o 50,000) y revisar si los par√°metros convergen antes de ejecutar una corrida m√°s larga.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#evaluar-el-soporte-para-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#evaluar-el-soporte-para-extinciones-masivas",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "Evaluar el Soporte para Extinciones Masivas",
    "text": "Evaluar el Soporte para Extinciones Masivas\nUna vez finalizada la ejecuci√≥n del MCMC, los archivos de salida contienen las muestras de la distribuci√≥n posterior.\nüìå Objetivo: Evaluar qu√© tan fuertemente respaldada est√° la hip√≥tesis de que ocurrieron eventos de extinci√≥n masivaen ciertos intervalos de tiempo.\nüîπ ¬øC√≥mo lo hacemos?\n\nExaminamos la probabilidad posterior de cada evento de extinci√≥n masiva.\nCalculamos factores de Bayes para determinar si hay soporte significativo.\nVisualizamos los resultados con RevGadgets en R.\n\nAn√°lisis en R con RevGadgets\nEjecuta este c√≥digo en R:\n\n# Cargar la librer√≠a\nlibrary(RevGadgets)\n\n# Leer las probabilidades de extinci√≥n masiva desde el archivo de salida\nmass_extinction_probabilities &lt;- readTrace(\"../docs/u1_PatDiv/output/CRFBD/eupomphini_EFBDME_mass_extinction_probabilities.log\", burnin = 0.25)\n\n# Establecer la probabilidad a priori de una extinci√≥n masiva en cualquier tiempo\nprior_n_expected &lt;- 0.1  # N√∫mero esperado de eventos de extinci√≥n masiva\nn_intervals &lt;- 10       # N√∫mero de intervalos de tiempo en el modelo\nprior_prob &lt;- prior_n_expected / (n_intervals - 1)\n\n# Definir los tiempos en los que se permitieron eventos de extinci√≥n masiva\ntree_age &lt;- 19.5829128  # Edad del √°rbol en millones de a√±os\ninterval_times &lt;- tree_age * seq(1/n_intervals, (n_intervals-1)/n_intervals, 1/n_intervals)\n\n# Graficar los resultados\np &lt;- plotMassExtinctions(\n  mass_extinction_trace = mass_extinction_probabilities,\n  mass_extinction_times = interval_times,\n  mass_extinction_name = \"mass_extinction_probabilities\",\n  prior_prob = prior_prob\n)\n\np",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#qu√©-significa-el-factor-de-bayes",
    "href": "chapters/u1_intro_diversification_3.html#qu√©-significa-el-factor-de-bayes",
    "title": "Estimaci√≥n de Eventos de Extinci√≥n Masiva",
    "section": "¬øQu√© significa el Factor de Bayes?",
    "text": "¬øQu√© significa el Factor de Bayes?\nEl Factor de Bayes (BF) compara dos modelos:\n\nHip√≥tesis Nula (H‚ÇÄ): No hubo un evento de extinci√≥n masiva en un intervalo de tiempo.\nHip√≥tesis Alternativa (H‚ÇÅ): S√≠ hubo un evento de extinci√≥n masiva en ese intervalo.\n\nEl log(Bayes Factor) se calcula como:\n\\(2log(BF)\\) = \\(2(logP(D|H_1)- logP(D|H_0))\\)\nDonde:\n\n\\(P(D|H_1)\\) es la probabilidad de los datos asumiendo que hubo una extinci√≥n masiva.\n\\(P(D|H_0)\\) es la probabilidad de los datos asumiendo que no hubo una extinci√≥n masiva.\n\nUn 2 log BF ‚â• 10 indica fuerte evidencia a favor de una extinci√≥n masiva en ese tiempo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>8</span>¬† <span class='chapter-title'>Estimaci√≥n de Eventos de Extinci√≥n Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html",
    "href": "chapters/u1_intro_diversification_4.html",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "",
    "text": "Presentaci√≥n: Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)\nHaz clic en la imagen para ver el PDF de la presentaci√≥n\nAnalizaremos si las tasas de diversificaci√≥n est√°n asociadas al tipo de hospedero en los escarabajos meloidos (Meloidae). Las subfamilias Nemognathinae y Meloinae presentan un ciclo de vida complejo, caracterizado por m√∫ltiples metamorfosis y estrategias de parasitoidismo. La mayor√≠a de los g√©neros y tribus dentro de estas subfamilias son parasitoides de abejas, incluyendo especies for√©ticas y no for√©ticas. Sin embargo, dos tribus han adoptado una estrategia distinta, aliment√°ndose de huevos de saltamontes. Estas diferencias en las estrategias de vida est√°n asociadas con marcadas variaciones en la riqueza de especies entre clados (L√≥pez-Estrada et al., 2019).",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#descarga-del-√°rbol-filogen√©tico-y-la-matriz-codificada",
    "href": "chapters/u1_intro_diversification_4.html#descarga-del-√°rbol-filogen√©tico-y-la-matriz-codificada",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Descarga del √Årbol Filogen√©tico y la matriz codificada",
    "text": "Descarga del √Årbol Filogen√©tico y la matriz codificada\nüì• Puedes descargar el archivo .tre con el √°rbol en el siguiente enlace:\nüì• Descargar √Årbol Filogen√©tico\nüì• Puedes descargar el archivo .nex con la matriz codificada en el siguiente enlace:\nüì• Descargar Matriz Codificada\nGuarda los archivos en la carpeta correspondiente y verifica su ubicaci√≥n antes de continuar.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos",
    "href": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Carga de la filogenia y los datos",
    "text": "Carga de la filogenia y los datos\nCrea un script .Rev y copia el codigo de la siguiente secci√≥n:\n# Leer el arbol\nT &lt;- readTrees(\"../data/ConLyttini.tre\")[1]\n\n# Leer la matriz de caracteres\ndatos &lt;- readCharacterData(\"../data/Traits_conLyttini_01.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-n√∫mero-de-estados-en-los-modelos-bisse",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-n√∫mero-de-estados-en-los-modelos-bisse",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir el n√∫mero de estados en los modelos BISSE",
    "text": "Definir el n√∫mero de estados en los modelos BISSE\nNUM_STATES = 2",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "href": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#valores-de-la-log-normal",
    "href": "chapters/u1_intro_diversification_4.html#valores-de-la-log-normal",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Valores de la log-normal",
    "text": "Valores de la log-normal\nDe acuerdo con Nee et al.¬†(1994) el n√∫mero esperado de linajes en la corona de un clado con n taxones bajo un proceso de nacimiento y muerte en el tiempo t es:\n\\((\\lambda - \\mu) = \\frac{In(n)/2}{t}\\)\nEn donde: n = es el n√∫mero de especies y t = es la edad de la filogenia\n# Definimos una a priori log normal\nrate_mean &lt;- ln(ln(3000.0/2.0) / T.rootAge())\n\n# Con una varianza que es amplia\nrate_sd &lt;- 0.587405\n\nfor (i in 1:NUM_STATES) {\n# lognormales de las especiaciones\n  log_speciation[i] ~ dnNormal(mean=rate_mean, sd=rate_sd) \n  speciation[i] := exp(log_speciation[i])\n  moves.append(mvSlide(log_speciation[i], delta=0.20, tune=true, weight=3.0))\n\n# lognormales de las extinciones\n  log_extinction[i] ~ dnNormal(mean=rate_mean, sd=rate_sd)  \n  extinction[i] := exp(log_extinction[i])\n  moves.append(mvSlide(log_extinction[i], delta=0.20, tune=true, weight=3.0))\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-tasas-de-transici√≥n-entre-los-estados-del-car√°cter",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-tasas-de-transici√≥n-entre-los-estados-del-car√°cter",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la matriz de tasas de transici√≥n entre los estados del car√°cter",
    "text": "Definir la matriz de tasas de transici√≥n entre los estados del car√°cter\n# Calcula la suma de todas las longitudes de las ramas del √°rbol filogen√©tico\n# Dividido por 10: Esto asume que en promedio ocurren 10 cambios de estado a lo largo del √°rbol\nrate_pr := T.treeLength() / 10",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definici√≥n-de-las-tasas-de-transici√≥n",
    "href": "chapters/u1_intro_diversification_4.html#definici√≥n-de-las-tasas-de-transici√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definici√≥n de las tasas de transici√≥n",
    "text": "Definici√≥n de las tasas de transici√≥n\n# Tasa de transici√≥n de estado 1 ‚Üí estado 2 \nrate_12 ~ dnExp(rate_pr)\n\n# Tasa de transici√≥n de estado 2 ‚Üí estado 1 \nrate_21 ~ dnExp(rate_pr)\n\n# Definici√≥n de movimientos \nmoves.append(mvScale(rate_12, weight=2))\nmoves.append(mvScale(rate_21, weight=2))\n¬øPor qu√© usar una exponencial?\n\nLa distribuci√≥n exponencial es adecuada para modelar tasas de transici√≥n porque impone la condici√≥n de que siempre sean positivas.\nTambi√©n asigna mayor probabilidad a valores peque√±os, lo que significa que los cambios de estado no ocurren demasiado r√°pido.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#creaci√≥n-de-la-matriz-de-tasas-de-transici√≥n",
    "href": "chapters/u1_intro_diversification_4.html#creaci√≥n-de-la-matriz-de-tasas-de-transici√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Creaci√≥n de la matriz de tasas de transici√≥n",
    "text": "Creaci√≥n de la matriz de tasas de transici√≥n\nrate_matrix := fnFreeBinary([rate_12, rate_21 ], rescaled=false)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#frecuencias-del-estado-en-la-ra√≠z",
    "href": "chapters/u1_intro_diversification_4.html#frecuencias-del-estado-en-la-ra√≠z",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Frecuencias del estado en la ra√≠z",
    "text": "Frecuencias del estado en la ra√≠z\nrate_category_prior ~ dnDirichlet(rep(1,NUM_STATES))\nmoves.append(mvDirichletSimplex(rate_category_prior, tune=true, weight=2))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#fijar-la-edad-de-la-ra√≠z",
    "href": "chapters/u1_intro_diversification_4.html#fijar-la-edad-de-la-ra√≠z",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Fijar la edad de la ra√≠z",
    "text": "Fijar la edad de la ra√≠z\nroot &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-rho-proporci√≥n-de-especies-muestreadas",
    "href": "chapters/u1_intro_diversification_4.html#definir-rho-proporci√≥n-de-especies-muestreadas",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir \\(\\rho\\) : Proporci√≥n de especies muestreadas",
    "text": "Definir \\(\\rho\\) : Proporci√≥n de especies muestreadas\nrho &lt;- T.ntips()/3000",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#construcci√≥n-del-√°rbol-evolutivo-generado-a-partir-de-un-proceso-de-nacimiento-y-muerte-dependiente-del-car√°cter",
    "href": "chapters/u1_intro_diversification_4.html#construcci√≥n-del-√°rbol-evolutivo-generado-a-partir-de-un-proceso-de-nacimiento-y-muerte-dependiente-del-car√°cter",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Construcci√≥n del √°rbol evolutivo generado a partir de un proceso de nacimiento y muerte dependiente del car√°cter",
    "text": "Construcci√≥n del √°rbol evolutivo generado a partir de un proceso de nacimiento y muerte dependiente del car√°cter\ntimetree ~ dnCDBDP(rootAge = root, speciationRates = speciation, extinctionRates = extinction, Q = rate_matrix, pi = rate_category_prior, delta = 1.0, rho = rho, condition = \"time\")\nüîπ Par√°metros del proceso de nacimiento y muerte (dnCDBDP):\n\nrootAge = root ‚Üí Se fija la edad de la ra√≠z usando root = T.rootAge().\nspeciationRates = speciation ‚Üí Se usa la tasa de especiaci√≥n (Œª).\nextinctionRates = extinction ‚Üí Se usa la tasa de extinci√≥n (Œº).\nQ = rate_matrix ‚Üí Usa la matriz de tasas de transici√≥n de caracteres (rate_12, rate_21).\npi = rate_category_prior ‚Üí Usa la distribuci√≥n a priori de los estados en la ra√≠z.\ndelta = 1.0 ‚Üí Par√°metro de ajuste para la distribuci√≥n de tiempos de especiaci√≥n/extinci√≥n.\nrho = rho ‚Üí Probabilidad de muestreo de especies (rho = T.ntips()/3000).\ncondition = \"time\" ‚Üí Condiciona el proceso a un tiempo de ra√≠z fijo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#fijar-clamp-los-datos-observados",
    "href": "chapters/u1_intro_diversification_4.html#fijar-clamp-los-datos-observados",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Fijar (clamp) los datos observados",
    "text": "Fijar (clamp) los datos observados\ntimetree.clamp(T)\ntimetree.clampCharData(datos)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#creaci√≥n-del-modelo",
    "href": "chapters/u1_intro_diversification_4.html#creaci√≥n-del-modelo",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Creaci√≥n del modelo",
    "text": "Creaci√≥n del modelo\n### workspace model wrapper ###\nmymodel = model(rate_matrix)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#configuraci√≥n-de-los-monitores",
    "href": "chapters/u1_intro_diversification_4.html#configuraci√≥n-de-los-monitores",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Configuraci√≥n de los monitores",
    "text": "Configuraci√≥n de los monitores\nLos monitores guardan los resultados en archivos o los imprimen en pantalla.\nmonitors.append(mnModel(filename=\"../out/Bisse/mitos_BiSSE_clyttini.log\", printgen=1))\nmonitors.append(mnJointConditionalAncestralState(tree=timetree, cdbdp=timetree, type=\"Standard\", printgen=1, withTips=true, withStartStates=false, filename=\"../out/Bisse/anc_states_MITOS_BiSSE_clyttini.log\"))\nmonitors.append(mnStochasticCharacterMap(cdbdp=timetree, printgen=10, filename=\".../out/Bisse/SCHM_BiSSE_clyttini.log\"))\nmonitors.append(mnScreen(printgen=10, rate_12, rate_21, speciation, extinction))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#inicializar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#inicializar-y-ejecutar-el-mcmc",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Inicializar y Ejecutar el MCMC",
    "text": "Inicializar y Ejecutar el MCMC\nCon el modelo y los monitores listos, creamos el objeto MCMC e iniciamos la simulaci√≥n.\nmymcmc = mcmc(mymodel, monitors, moves, nruns=1, moveschedule=\"random\")\n\nmymodel: hace referencia al modelo que est√°s analizando.\nmonitors: son las variables que se registrar√°n en el archivo de salida.\nmoves: operadores MCMC que proponen cambios en los par√°metros del modelo.\nnruns=1: solo una cadena MCMC (puedes usar m√°s si deseas una inferencia m√°s robusta).\nmoveschedule=\"random\": ejecuta los operadores en orden aleatorio para evitar sesgos en la exploraci√≥n del espacio de par√°metros.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=40000)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#generar-un-√°rbol-anotado-con-los-estados-ancestrales-map",
    "href": "chapters/u1_intro_diversification_4.html#generar-un-√°rbol-anotado-con-los-estados-ancestrales-map",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Generar un √°rbol anotado con los estados ancestrales (MAP)",
    "text": "Generar un √°rbol anotado con los estados ancestrales (MAP)\nanc_states = readAncestralStateTrace(\"../out/Bisse/anc_states_MITOS_BiSSE_clyttini.log\")\n\nanc_tree = ancestralStateTree(tree=T, ancestral_state_trace_vector=anc_states, include_start_states=false, file=\"../out/Bisse/mitos_bisse_anc_states_results.tree\", burnin=0.2, summary_statistic=\"MAP\", site=1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#generar-un-mapeo-estoc√°stico-de-caracteres-stochastic-character-mapping",
    "href": "chapters/u1_intro_diversification_4.html#generar-un-mapeo-estoc√°stico-de-caracteres-stochastic-character-mapping",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Generar un mapeo estoc√°stico de caracteres (Stochastic Character Mapping)",
    "text": "Generar un mapeo estoc√°stico de caracteres (Stochastic Character Mapping)\nanc_state_trace = readAncestralStateTrace(\"../out/Bisse/SCHM_BiSSE_clyttini.log\")\n\ncharacterMapTree(tree=T, ancestral_state_trace_vector=anc_state_trace, character_file=\"../out/Bisse/mitos_bisse_stoch_map_character.tree\", posterior_file=\"../out/Bisse/mitos_bisse_stoch_map_posterior.tree\", burnin=0.2, reconstruction=\"marginal\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#visualizaci√≥n-en-r-con-revgadgets",
    "href": "chapters/u1_intro_diversification_4.html#visualizaci√≥n-en-r-con-revgadgets",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Visualizaci√≥n en R con RevGadgets",
    "text": "Visualizaci√≥n en R con RevGadgets\n\nlibrary(tidyverse)\nlibrary(RevGadgets)\n\n# Cargar el archivo de estados ancestrales\nbisse_file &lt;- paste0(\"../docs/u1_PatDiv/output/bisse/mitos_bisse_anc_states_results.tree\")\np_anc &lt;- processAncStates(bisse_file)\n\n\n  |                                              \n  |                                        |   0%\n  |                                              \n  |========================================| 100%\n\n# Definir paleta de colores personalizada\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\")  # Rojo para estado 0, azul para estado 1\n\n# Generar el gr√°fico con estados ancestrales\nplot &lt;- plotAncStatesMAP(p_anc,\n        tree_layout = \"rect\",\n        tip_labels_size = 1) +\n        # Aplicar la paleta de colores\n        scale_color_manual(values = traitcols) +\n        scale_fill_manual(values = traitcols) +\n        # Modificar leyenda y otros elementos de ggplot2\n        theme(legend.position = c(0.1, 0.85),\n              legend.key.size = unit(0.3, 'cm'), # Tama√±o de la clave de la leyenda\n              legend.title = element_text(size = 6), # Tama√±o del t√≠tulo de la leyenda\n              legend.text = element_text(size = 4))  # Tama√±o del texto de la leyenda\n\n# Mostrar el gr√°fico\nplot",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-transici√≥n",
    "href": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-transici√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar las tasas de transici√≥n",
    "text": "Graficar las tasas de transici√≥n\n\nlibrary(tidyverse)\n\n# Leer el archivo de salida de RevBayes\nbisse &lt;- read.table(\"../docs/u1_PatDiv/output/bisse/mitos_BiSSE_clyttini.log\", header = TRUE)\n\n# Definir colores para los estados 0 y 1\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\")  \n\n# Crear un dataframe con solo las tasas de transici√≥n\ntransition_rates &lt;- data.frame(\n  dens = c(bisse$rate_12, bisse$rate_21), \n  rate = rep(c(\"0\", \"1\"), each = length(bisse$rate_12))\n)\n\n# Crear un gr√°fico de viol√≠n para las tasas de transici√≥n\nviolin_transitions &lt;- ggplot(transition_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Transici√≥n\", x = \"Estado\", y = \"Tasa\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_transitions",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificaci√≥n-neta",
    "href": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificaci√≥n-neta",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar las tasas de diversificaci√≥n neta",
    "text": "Graficar las tasas de diversificaci√≥n neta\n\n# Calcular la tasa de diversificaci√≥n neta: especiaci√≥n - extinci√≥n\nnetdiversification_rates &lt;- data.frame(\n  dens = c(bisse$speciation.1. - bisse$extinction.1.,\n           bisse$speciation.2. - bisse$extinction.2.),\n  rate = rep(c(\"0\", \"1\"), each = length(bisse$speciation.1.))\n)\n\n# Convertir la variable de estado en factor\nnetdiversification_rates$rate &lt;- factor(netdiversification_rates$rate, levels = c(\"0\", \"1\"))\n\n# Crear el gr√°fico de viol√≠n para tasas de diversificaci√≥n neta\nviolin_diversification &lt;- ggplot(netdiversification_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Diversificaci√≥n Neta\", x = \"Estado\", y = \"Tasa\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_diversification",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiaci√≥n",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiaci√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar tasas de especiaci√≥n",
    "text": "Graficar tasas de especiaci√≥n\n\n# Crear un dataframe con tasas de especiaci√≥n para cada estado\nspeciation_rates &lt;- data.frame(\n  dens = c(bisse$speciation.1.,  bisse$speciation.2.), \n  rate = rep(c(\"0\", \"1\"), each = length(bisse$speciation.1.))\n)\n\n# Crear gr√°fico de viol√≠n para las tasas de especiaci√≥n\nviolin_speciation &lt;- ggplot(speciation_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Especiaci√≥n\", x = \"Estado\", y = \"Tasa de Especiaci√≥n\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_speciation",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinci√≥n",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinci√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar tasas de extinci√≥n",
    "text": "Graficar tasas de extinci√≥n\n\n# Crear un dataframe con tasas de extinci√≥n para cada estado\nextinction_rates &lt;- data.frame(\n  dens = c(bisse$extinction.1., bisse$extinction.2.), \n  rate = rep(c(\"0\", \"1\"), each = length(bisse$extinction.1.))\n)\n\n# Crear gr√°fico de viol√≠n para tasas de extinci√≥n\nviolin_extinction &lt;- ggplot(extinction_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Extinci√≥n\", x = \"Estado\", y = \"Tasa de Extinci√≥n\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_extinction",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos-1",
    "href": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos-1",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Carga de la filogenia y los datos",
    "text": "Carga de la filogenia y los datos\nCrea un script .Rev y copia el codigo de la siguiente secci√≥n:\n# Leer el arbol\nT &lt;- readTrees(\"../data/ConLyttini.tre\")[1]\n\n# Leer la matriz de caracteres\ndatos &lt;- readCharacterData(\"../data/Traits_conLyttini_01.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-n√∫mero-de-estados-en-los-modelos-hisse-y-paremetros-globales",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-n√∫mero-de-estados-en-los-modelos-hisse-y-paremetros-globales",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir el n√∫mero de estados en los modelos HISSE y paremetros globales",
    "text": "Definir el n√∫mero de estados en los modelos HISSE y paremetros globales\nNUM_TOTAL_SPECIES     = 3000.0\nNUM_STATES            = 2\nNUM_HIDDEN            = 2\nNUM_RATES             = NUM_STATES * NUM_HIDDEN\nH                     = 0.587405\n# Expansi√≥n de los Datos para Incluir Estados Ocultos \ndata_exp &lt;- datos.expandCharacters(NUM_HIDDEN)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.-1",
    "href": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.-1",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#extraer-informaci√≥n-del-√°rbol-filogen√©tico",
    "href": "chapters/u1_intro_diversification_4.html#extraer-informaci√≥n-del-√°rbol-filogen√©tico",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Extraer informaci√≥n del √°rbol filogen√©tico",
    "text": "Extraer informaci√≥n del √°rbol filogen√©tico\ntaxa &lt;- T.taxa()\ntree_length &lt;- T.treeLength()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-media-de-las-tasas-de-especiaci√≥n-y-extinci√≥n",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-media-de-las-tasas-de-especiaci√≥n-y-extinci√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Media de las Tasas de Especiaci√≥n y Extinci√≥n",
    "text": "Definir la Media de las Tasas de Especiaci√≥n y Extinci√≥n\nrate_mean &lt;- (NUM_TOTAL_SPECIES - 2) / tree_length\n‚úÖ Calcula la media esperada de las tasas de especiaci√≥n y extinci√≥n basada en el n√∫mero total de especies y la longitud del √°rbol.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#especiaci√≥n-y-extinci√≥n-oculta-hidden-speciation-rates",
    "href": "chapters/u1_intro_diversification_4.html#especiaci√≥n-y-extinci√≥n-oculta-hidden-speciation-rates",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Especiaci√≥n y Extinci√≥n Oculta (Hidden Speciation Rates)",
    "text": "Especiaci√≥n y Extinci√≥n Oculta (Hidden Speciation Rates)\nln_speciation_hidden_mean &lt;- ln(1.0)\nln_extinction_hidden_mean &lt;- ln(1.0)\n‚úÖ Define la media logar√≠tmica de las tasas ocultas de especiaci√≥n como 1.0 en una escala relativa. ‚úîÔ∏è Esto significa que los valores generados ser√°n proporcionales, y no absolutos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#variaci√≥n-en-las-tasas-ocultas-de-especiaci√≥n-y-extinci√≥n",
    "href": "chapters/u1_intro_diversification_4.html#variaci√≥n-en-las-tasas-ocultas-de-especiaci√≥n-y-extinci√≥n",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Variaci√≥n en las Tasas Ocultas de Especiaci√≥n y Extinci√≥n",
    "text": "Variaci√≥n en las Tasas Ocultas de Especiaci√≥n y Extinci√≥n\nspeciation_hidden_sd ~ dnExponential(1.0 / H)\nextinction_hidden_sd ~ dnExponential(1.0 / H)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#movimiento-mcmc-para-optimizar-la-desviaci√≥n-est√°ndar",
    "href": "chapters/u1_intro_diversification_4.html#movimiento-mcmc-para-optimizar-la-desviaci√≥n-est√°ndar",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Movimiento MCMC para Optimizar la Desviaci√≥n Est√°ndar",
    "text": "Movimiento MCMC para Optimizar la Desviaci√≥n Est√°ndar\nmoves.append(mvScale(speciation_hidden_sd, lambda=1, tune=true, weight=2.0))\nmoves.append(mvScale(extinction_hidden_sd, lambda=1, tune=true, weight=2.0))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-distribuci√≥n-de-las-tasas-ocultas",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-distribuci√≥n-de-las-tasas-ocultas",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Distribuci√≥n de las Tasas Ocultas",
    "text": "Definir la Distribuci√≥n de las Tasas Ocultas\nspeciation_hidden_unormalized := fnDiscretizeDistribution(dnLognormal(ln_speciation_hidden_mean, speciation_hidden_sd), NUM_HIDDEN)\nextinction_hidden_unormalized := fnDiscretizeDistribution(dnLognormal(ln_extinction_hidden_mean, extinction_hidden_sd), NUM_HIDDEN)\n‚úÖ Se genera un conjunto de tasas ocultas de especiaci√≥n a partir de una distribuci√≥n lognormal.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#normalizaci√≥n-de-las-tasas-ocultas",
    "href": "chapters/u1_intro_diversification_4.html#normalizaci√≥n-de-las-tasas-ocultas",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Normalizaci√≥n de las Tasas Ocultas",
    "text": "Normalizaci√≥n de las Tasas Ocultas\nspeciation_hidden := speciation_hidden_unormalized / mean(speciation_hidden_unormalized)\nextinction_hidden := extinction_hidden_unormalized / mean(extinction_hidden_unormalized)\n‚úÖ Se normalizan las tasas ocultas dividi√©ndolas por su media, para que el promedio sea 1.0. ‚úîÔ∏è Esto garantiza que los valores sean relativos y comparables entre estados.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-tasas-de-especiaci√≥n-para-estados-observables",
    "href": "chapters/u1_intro_diversification_4.html#definir-tasas-de-especiaci√≥n-para-estados-observables",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir Tasas de Especiaci√≥n para Estados Observables",
    "text": "Definir Tasas de Especiaci√≥n para Estados Observables\nfor (i in 1:NUM_STATES) {\n    speciation_observed[i] ~ dnLoguniform( 1E-6, 1E2)\n    speciation_observed[i].setValue( (NUM_TOTAL_SPECIES-2) / tree_length )\n    moves.append( mvScale(speciation_observed[i], lambda=1.0, tune=true, weight=3.0) )\n        ### Create a loguniform distributed variable for the extinction rate\n    extinction_observed[i] ~ dnLoguniform( 1E-6, 1E2)\n    extinction_observed[i].setValue( speciation_observed[i] / 10.0 )\n    moves.append( mvScale(extinction_observed[i], lambda=1.0, tune=true, weight=3.0) )\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#c√°lculo-de-las-tasas-combinadas",
    "href": "chapters/u1_intro_diversification_4.html#c√°lculo-de-las-tasas-combinadas",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "C√°lculo de las Tasas Combinadas",
    "text": "C√°lculo de las Tasas Combinadas\nfor (j in 1:NUM_HIDDEN) {\n    for (i in 1:NUM_STATES) {\n        index = i+(j*NUM_STATES)-NUM_STATES\n        speciation[index] := speciation_observed[i] * speciation_hidden[j]\n        extinction[index] := extinction_observed[i] * extinction_hidden[j]\n    }\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transici√≥n-entre-estados-observables",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transici√≥n-entre-estados-observables",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Matriz de Transici√≥n entre Estados Observables",
    "text": "Definir la Matriz de Transici√≥n entre Estados Observables\nrate_pr := T.treeLength() / 10\nfor ( i in 1:(NUM_STATES*(NUM_STATES-1)) ) {\n    transition_rates[i] ~ dnExp(rate_pr)\n    moves.append( mvScale(transition_rates[i], lambda=0.50, tune=true, weight=3.0) )\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transici√≥n-entre-estados-ocultos",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transici√≥n-entre-estados-ocultos",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Matriz de Transici√≥n entre Estados Ocultos",
    "text": "Definir la Matriz de Transici√≥n entre Estados Ocultos\nhidden_rate ~ dnExponential(rate_pr)\nmoves.append( mvScale(hidden_rate, lambda=0.5, tune=true, weight=5) )\nfor (i in 1:(NUM_HIDDEN * (NUM_HIDDEN - 1))) {\n    R[i] := hidden_rate\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#crear-la-matriz-de-transici√≥n-q-combinada",
    "href": "chapters/u1_intro_diversification_4.html#crear-la-matriz-de-transici√≥n-q-combinada",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Crear la Matriz de Transici√≥n Q Combinada",
    "text": "Crear la Matriz de Transici√≥n Q Combinada\nrate_matrix := fnHiddenStateRateMatrix(transition_rates, R, rescaled=false)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-distribuci√≥n-de-los-estados-en-la-ra√≠z",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-distribuci√≥n-de-los-estados-en-la-ra√≠z",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Distribuci√≥n de los Estados en la Ra√≠z",
    "text": "Definir la Distribuci√≥n de los Estados en la Ra√≠z\nrate_category_prior ~ dnDirichlet( rep(1,NUM_RATES) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#optimizaci√≥n-con-movimientos-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#optimizaci√≥n-con-movimientos-mcmc",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Optimizaci√≥n con Movimientos MCMC",
    "text": "Optimizaci√≥n con Movimientos MCMC\nmoves.append( mvBetaSimplex(rate_category_prior, tune=true, weight=2) )\nmoves.append( mvDirichletSimplex(rate_category_prior, tune=true, weight=2) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-edad-de-la-ra√≠z-del-√°rbol",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-edad-de-la-ra√≠z-del-√°rbol",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Edad de la Ra√≠z del √Årbol",
    "text": "Definir la Edad de la Ra√≠z del √Årbol\nroot &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-probabilidad-de-muestreo-de-especies-rho",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-probabilidad-de-muestreo-de-especies-rho",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir la Probabilidad de Muestreo de Especies (\\(\\rho\\))",
    "text": "Definir la Probabilidad de Muestreo de Especies (\\(\\rho\\))\nrho &lt;- T.ntips()/3000.0",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-√°rbol-bajo-un-proceso-de-diversificaci√≥n-dependiente-del-estado",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-√°rbol-bajo-un-proceso-de-diversificaci√≥n-dependiente-del-estado",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir el √Årbol Bajo un Proceso de Diversificaci√≥n Dependiente del Estado",
    "text": "Definir el √Årbol Bajo un Proceso de Diversificaci√≥n Dependiente del Estado\ntimetree ~ dnCDBDP( rootAge = root, speciationRates = speciation, extinctionRates = extinction, Q = rate_matrix, delta = 1.0, pi = rate_category_prior, rho = rho, condition = \"survival\")\n‚úîÔ∏è Par√°metros clave:\n\nrootAge = root ‚Üí La edad de la ra√≠z se fija a la edad del √°rbol observado.\nspeciationRates = speciation ‚Üí Tasas de especiaci√≥n combinadas (Œª), que incluyen efectos de los estados ocultos.\nextinctionRates = extinction ‚Üí Tasas de extinci√≥n combinadas (Œº), modeladas de la misma manera.\nQ = rate_matrix ‚Üí Matriz de tasas de transici√≥n entre estados (0A ‚ÜîÔ∏é 1A, 0B ‚ÜîÔ∏é 1B, etc.).\ndelta = 1.0 ‚Üí Modelo est√°ndar en el que las tasas de diversificaci√≥n dependen completamente del estado.\npi = rate_category_prior ‚Üí Prior de las probabilidades de estado en la ra√≠z.\nrho = rho ‚Üí Ajuste por sesgo de muestreo de especies.\ncondition = \"survival\" ‚Üí Se modela solo en √°rboles que han sobrevivido hasta el presente.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-la-filogenia-observada",
    "href": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-la-filogenia-observada",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Ajustar el Modelo a la Filogenia Observada",
    "text": "Ajustar el Modelo a la Filogenia Observada\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-los-datos-de-caracteres",
    "href": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-los-datos-de-caracteres",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Ajustar el Modelo a los Datos de Caracteres",
    "text": "Ajustar el Modelo a los Datos de Caracteres\ntimetree.clampCharData(data_exp)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-modelo-en-revbayes",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-modelo-en-revbayes",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir el Modelo en RevBayes",
    "text": "Definir el Modelo en RevBayes\nmymodel = model(rate_matrix)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#configurar-monitores-para-guardar-resultados",
    "href": "chapters/u1_intro_diversification_4.html#configurar-monitores-para-guardar-resultados",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Configurar Monitores para Guardar Resultados",
    "text": "Configurar Monitores para Guardar Resultados\n# Monitor Principal del Modelo\nmonitors.append( mnModel(filename=\"../out/Hisse/mitos_HiSSE_clyttini_TUTscript.log\", printgen=1) )\n\n# Monitor de Estados Ancestrales\nmonitors.append(mnJointConditionalAncestralState(tree=timetree, cdbdp=timetree, type=\"NaturalNumbers\", printgen=1, withTips=true, withStartStates=false, filename=\"../out/Hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.log\"))\n\n# Monitor de Mapeo Estoc√°stico de Caracteres\nmonitors.append(mnStochasticCharacterMap(cdbdp=timetree, printgen=10, filename=\"../out/Hisse/stoch_char_map_mitos_HiSSE_clyttini_TUTscript.log\", include_simmap=true))\n\n# Monitor en Pantalla\nmonitors.append(mnScreen(printgen=10, speciation_observed, extinction_observed))",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#configurar-el-algoritmo-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#configurar-el-algoritmo-mcmc",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Configurar el Algoritmo MCMC",
    "text": "Configurar el Algoritmo MCMC\n### workspace mcmc\nmymcmc = mcmc(mymodel, monitors, moves, nruns=1, moveschedule=\"random\", combine=\"mixed\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc-1",
    "href": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc-1",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=400)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#cargar-la-trazabilidad-de-los-estados-ancestrales",
    "href": "chapters/u1_intro_diversification_4.html#cargar-la-trazabilidad-de-los-estados-ancestrales",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Cargar la Trazabilidad de los Estados Ancestrales",
    "text": "Cargar la Trazabilidad de los Estados Ancestrales\nanc_states2 = readAncestralStateTrace(\"../out/Hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.log\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#construcci√≥n-del-√°rbol-con-estados-ancestrales",
    "href": "chapters/u1_intro_diversification_4.html#construcci√≥n-del-√°rbol-con-estados-ancestrales",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Construcci√≥n del √Årbol con Estados Ancestrales",
    "text": "Construcci√≥n del √Årbol con Estados Ancestrales\nanc_tree = ancestralStateTree(tree=T, ancestral_state_trace_vector = anc_states2, include_start_states=false, file = \"../out/Hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.tree\", burnin = 2, summary_statistic = \"MAP\", site=1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-par√°metros-para-la-resumir-estados-ancestrales",
    "href": "chapters/u1_intro_diversification_4.html#definir-par√°metros-para-la-resumir-estados-ancestrales",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Definir Par√°metros para la Resumir Estados Ancestrales",
    "text": "Definir Par√°metros para la Resumir Estados Ancestrales\nburnin=10\nn_time_slices = 500\n‚úÖ burnin = 25 ‚Üí Descarta las primeras 25 iteraciones del MCMC antes de hacer el resumen.\n‚úÖ n_time_slices = 500 ‚Üí Divide el √°rbol en 500 segmentos de tiempo para interpolar los cambios de estado.",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#leer-la-historia-del-car√°cter-inferida-por-mapeo-estoc√°stico",
    "href": "chapters/u1_intro_diversification_4.html#leer-la-historia-del-car√°cter-inferida-por-mapeo-estoc√°stico",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Leer la Historia del Car√°cter Inferida por Mapeo Estoc√°stico",
    "text": "Leer la Historia del Car√°cter Inferida por Mapeo Estoc√°stico\nanc_states_SCHM = readAncestralStateTrace(\"../out/Hisse/stoch_char_map_mitos_HiSSE_clyttini_TUTscript.log\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#crear-el-√°rbol-de-mapeo-estoc√°stico-de-caracteres",
    "href": "chapters/u1_intro_diversification_4.html#crear-el-√°rbol-de-mapeo-estoc√°stico-de-caracteres",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Crear el √Årbol de Mapeo Estoc√°stico de Caracteres",
    "text": "Crear el √Årbol de Mapeo Estoc√°stico de Caracteres\nchar_map_tree = characterMapTree(tree=T, \n                 ancestral_state_trace_vector=anc_states_SCHM, \n                 character_file=\"../out/Hisse/stoch_mitos_HiSSE_clyttini_TUTscriptmarginal_char.tree\", \n                 posterior_file=\"../out/Hisse/stoch_mitos_HiSSE_clyttini_TUTscriptmarginal_post.tree\", \n                 burnin=burnin, \n                 num_time_slices=n_time_slices)\n\n# Cargar el archivo de estados ancestrales\nhisse_file &lt;- paste0(\"../docs/u1_PatDiv/output/hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.tree\")\n\np_anc_hisse &lt;- processAncStates(hisse_file)\n\n\n  |                                              \n  |                                        |   0%\n  |                                              \n  |========================================| 100%\n\n# Definir paleta de colores personalizada\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\", \"red\", \"blue\")  # Rojo para estado 0, azul para estado 1\n\n# Generar el gr√°fico con estados ancestrales\nplot_hisse &lt;- plotAncStatesMAP(p_anc_hisse,\n        tree_layout = \"rect\",\n        tip_labels_size = 1) +\n        # Aplicar la paleta de colores\n        scale_color_manual(values = traitcols) +\n        scale_fill_manual(values = traitcols) +\n        # Modificar leyenda y otros elementos de ggplot2\n        theme(legend.position = c(0.1, 0.85),\n              legend.key.size = unit(0.3, 'cm'), # Tama√±o de la clave de la leyenda\n              legend.title = element_text(size = 6), # Tama√±o del t√≠tulo de la leyenda\n              legend.text = element_text(size = 4))  # Tama√±o del texto de la leyenda\n\n# Mostrar el gr√°fico\nplot_hisse",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificaci√≥n-neta-1",
    "href": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificaci√≥n-neta-1",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar las tasas de diversificaci√≥n neta",
    "text": "Graficar las tasas de diversificaci√≥n neta\n\n# Leer el archivo de salida de RevBayes\nhisse &lt;- read.table(\"../docs/u1_PatDiv/output/hisse/mitos_HiSSE_clyttini_TUTscript.log\", header = TRUE)\n\n# Definir paleta de colores personalizada\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\", \"red\", \"blue\")  # Rojo para estado 0, azul para estado 1\n\n# Calcular la tasa de diversificaci√≥n neta: especiaci√≥n - extinci√≥n\nnetdiversification_rates &lt;- data.frame(\n  dens = c(hisse$speciation_observed.1. - hisse$extinction_observed.1.,\n           hisse$speciation_observed.2. - hisse$extinction_observed.2.,\n           hisse$speciation_hidden.1. - hisse$extinction_hidden.1.,\n           hisse$speciation_hidden.2. - hisse$extinction_hidden.2.),\n  rate = rep(c(\"0A\", \"1A\", \"0B\", \"1B\"), each = length(hisse$speciation_observed.1.))\n  )\n\n# Convertir la variable de estado en factor\nnetdiversification_rates$rate &lt;- factor(netdiversification_rates$rate, levels = c(\"0A\", \"1A\", \"0B\", \"1B\"))\n\n# Crear el gr√°fico de viol√≠n para tasas de diversificaci√≥n neta\nviolin_diversification &lt;- ggplot(netdiversification_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Diversificaci√≥n Neta\", x = \"Estado\", y = \"Tasa\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_diversification",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiaci√≥n-1",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiaci√≥n-1",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar tasas de especiaci√≥n",
    "text": "Graficar tasas de especiaci√≥n\n\n# Crear un dataframe con tasas de especiaci√≥n para cada estado\nspeciation_rates &lt;- data.frame(\n  dens = c(hisse$speciation_observed.1.,  hisse$speciation_observed.2.,\n           hisse$speciation_hidden.1., hisse$speciation_hidden.2.), \n  rate = rep(c(\"0A\", \"1A\", \"0B\", \"1B\"), each = length(hisse$speciation_observed.1.))\n)\n\n# Crear gr√°fico de viol√≠n para las tasas de especiaci√≥n\nviolin_speciation &lt;- ggplot(speciation_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Especiaci√≥n\", x = \"Estado\", y = \"Tasa de Especiaci√≥n\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_speciation",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinci√≥n-1",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinci√≥n-1",
    "title": "Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)",
    "section": "Graficar tasas de extinci√≥n",
    "text": "Graficar tasas de extinci√≥n\n\n# Crear un dataframe con tasas de extinci√≥n para cada estado\nextinction_rates &lt;- data.frame(\n  dens = c(hisse$extinction_observed.1., hisse$extinction_observed.2.,\n           hisse$extinction_hidden.1., hisse$extinction_hidden.2.), \n  rate = rep(c(\"0A\", \"1A\", \"0B\", \"1B\"), each = length(hisse$extinction_observed.1.))\n)\n\n# Crear gr√°fico de viol√≠n para tasas de extinci√≥n\nviolin_extinction &lt;- ggplot(extinction_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Extinci√≥n\", x = \"Estado\", y = \"Tasa de Extinci√≥n\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gr√°fica\nviolin_extinction",
    "crumbs": [
      "Unidad 1: Patrones de diversificaci√≥n",
      "<span class='chapter-number'>9</span>¬† <span class='chapter-title'>Introducci√≥n a modelos State Speciaction-Extinci√≥n (SSE)</span>"
    ]
  }
]