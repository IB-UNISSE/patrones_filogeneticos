[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Patrones filogenéticos: macroevolución y adaptación",
    "section": "",
    "text": "Presentación del Curso: Patrones Filogenéticos, Macroevolución y Adaptación\nHaz clic en la imagen para ver el PDF de la presentación del curso",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "index.html#unidad-1-patrones-de-diversificación",
    "href": "index.html#unidad-1-patrones-de-diversificación",
    "title": "Patrones filogenéticos: macroevolución y adaptación",
    "section": "Unidad 1: Patrones de diversificación",
    "text": "Unidad 1: Patrones de diversificación\n\nIntroducción al proceso de diversificación parte 1\nIntroducción al proceso de diversificación parte 2",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "chapters/install.html",
    "href": "chapters/install.html",
    "title": "Instalación de Software",
    "section": "",
    "text": "Introducción\nEste es el manual para la instalación de los programas que se utilizarán durante el curso Patrones filogenéticos: macroevolución y adaptación. Los programas seleccionados son herramientas esenciales para el desarrollo de análisis y actividades dentro del curso.\nLos programas a instalar incluyen:\nA continuación, se presentan las instrucciones detalladas para instalar y configurar cada uno de estos programas, asegurando que los participantes cuenten con todas las herramientas necesarias para aprovechar al máximo el curso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción",
    "href": "chapters/install.html#descripción",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nVisual Studio Code (VS Code) es un editor de código fuente ligero pero potente, desarrollado por Microsoft. Es compatible con varios lenguajes de programación y ofrece características como autocompletado de código, depuración integrada, control de versiones con Git y una amplia variedad de extensiones que permiten personalizar y ampliar su funcionalidad.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalación",
    "href": "chapters/install.html#pasos-de-instalación",
    "title": "Instalación de Software",
    "section": "Pasos de instalación",
    "text": "Pasos de instalación\n\nDescargar el instalador:\n\nVe al sitio oficial de Visual Studio Code: https://code.visualstudio.com/.\nHaz clic en el botón para descargar el archivo ejecutable.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado (por lo general, estará en la carpeta Descargas).\nHaz doble clic en el archivo para iniciar el asistente de instalación.\n\nConfigurar las opciones de instalación:\n\nAcepta los términos y condiciones.\nElige una carpeta de instalación o deja la predeterminada.\nSelecciona las opciones adicionales como:\n\nCrear un ícono en el escritorio.\nAgregar “Code” al menú contextual para abrir archivos y carpetas.\nRegistrar el programa como editor por defecto de ciertos archivos.\n\n\nCompletar la instalación:\n\nHaz clic en “Instalar”.\nEspera a que el proceso finalice y haz clic en “Finalizar” para abrir Visual Studio Code.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción-1",
    "href": "chapters/install.html#descripción-1",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nR es un lenguaje de programación y software para el análisis estadístico y la visualización de datos. RStudio es un entorno de desarrollo integrado (IDE) que facilita trabajar con R gracias a su interfaz amigable y herramientas adicionales como depuración de código, manejo de proyectos y soporte para Markdown.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalación-1",
    "href": "chapters/install.html#pasos-de-instalación-1",
    "title": "Instalación de Software",
    "section": "Pasos de instalación",
    "text": "Pasos de instalación\n\nInstalación de R\n\nDescargar el instalador:\n\nVe al sitio oficial de CRAN: https://cran.r-project.org/.\nSelecciona “Download R for Windows” y luego “base”.\nHaz clic en el enlace para descargar el instalador más reciente.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente, aceptando los valores predeterminados a menos que necesites personalizar la instalación.\n\nCompletar la instalación:\n\nHaz clic en “Finalizar” al terminar el proceso.\n\n\n\n\nInstalación de RStudio\n\nDescargar el instalador:\n\nVe al sitio oficial de RStudio: https://posit.co/download/rstudio-desktop/.\nDescarga la versión gratuita de RStudio Desktop.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente de instalación.\n\nCompletar la instalación:\n\nHaz clic en “Finalizar” al terminar el proceso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción-2",
    "href": "chapters/install.html#descripción-2",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nRevBayes es un software diseñado para realizar análisis filogenéticos avanzados utilizando métodos bayesianos. Ofrece flexibilidad para modelar procesos evolutivos complejos y es ampliamente utilizado en investigaciones de filogenética y macroevolución.\nPara instalar RevBayes en Windows, utilizaremos Ubuntu mediante Windows Subsystem for Linux (WSL).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-la-virtualización-está-habilitada",
    "href": "chapters/install.html#verificar-si-la-virtualización-está-habilitada",
    "title": "Instalación de Software",
    "section": "1. Verificar si la virtualización está habilitada",
    "text": "1. Verificar si la virtualización está habilitada\n\nAbrir el Administrador de Tareas:\n\nPresiona Ctrl + Shift + Esc para abrir el Administrador de Tareas.\nVe a la pestaña Rendimiento y selecciona CPU.\nEn la esquina inferior derecha, verifica si la opción “Virtualización” está habilitada.\n\n\n\n\n\n\nHabilitar la virtualización (si está deshabilitada):\n\nReinicia tu computadora y accede al BIOS/UEFI.\nPara procesadores Intel, busca una opción como “Intel Virtualization Technology” o “VT-x” y actívala.\nPara procesadores AMD, busca “SVM Mode” o una opción similar y actívala.\nGuarda los cambios y reinicia.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-wsl-está-instalado-y-actualizado",
    "href": "chapters/install.html#verificar-si-wsl-está-instalado-y-actualizado",
    "title": "Instalación de Software",
    "section": "2. Verificar si WSL está instalado y actualizado",
    "text": "2. Verificar si WSL está instalado y actualizado\n\nAbrir PowerShell como administrador\n\nPresiona Win + X y selecciona “Windows PowerShell (Admin)”.\nEjecuta el siguiente comando para verificar si WSL está instalado y funcionando:\nwsl --status\nSi el comando muestra un error o indica que WSL no está disponible, sigue el Paso 3 para instalarlo desde cero.\nSi WSL ya está habilitado, pasa al Paso 4 para actualizarlo y asegurarte de que esté en la versión 2.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-wsl-desde-cero-si-no-está-disponible",
    "href": "chapters/install.html#instalar-wsl-desde-cero-si-no-está-disponible",
    "title": "Instalación de Software",
    "section": "3. Instalar WSL desde cero (si no está disponible)",
    "text": "3. Instalar WSL desde cero (si no está disponible)\nSi wsl --status muestra un error, sigue estos pasos para habilitar WSL desde cero:\n\nAbrir PowerShell como administrador y ejecutar los siguientes comandos:\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\nReiniciar la computadora para aplicar los cambios.\nVerificar la instalación:\n\nEjecuta nuevamente:\nwsl --status\nSi el comando muestra que WSL está instalado correctamente puedes proceder con el paso 4.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#actualizar-wsl-y-establecer-la-versión-por-defecto",
    "href": "chapters/install.html#actualizar-wsl-y-establecer-la-versión-por-defecto",
    "title": "Instalación de Software",
    "section": "4. Actualizar WSL y establecer la versión por defecto",
    "text": "4. Actualizar WSL y establecer la versión por defecto\nSi WSL ya estaba habilitado, sigue estos pasos para actualizarlo y asegurarte de que esté en la versión 2:\n\nActualizar el kernel de WSL 2 (en caso de que se necesite)\n\nDescarga la actualización oficial desde Microsoft: Descargar actualización de WSL-2\nGuarda el archivo wsl_update_x64.msi en tu computadora.\nEjecuta el archivo descargado y sigue las instrucciones de instalación.\nUna vez instalado, reinicia tu computadora.\n\nConfigurar WSL para usar la versión 2\n\nAbre PowerShell como administrador y ejecuta:\nwsl --set-default-version 2\nEsto asegurará que todas las distribuciones nuevas de Linux usen WSL 2 por defecto.\n\nInstalación de Ubuntu:\n\nUna vez reiniciado el equipo, abre PowerShell como administrador y ejecuta:\nwsl --install -d Ubuntu\nEsto instalará automáticamente WSL2 y descargará la distribución de Ubuntu más reciente,\nEn caso de que no se instale, descarga Ubuntu (se recomienda la versión 22.04) desde la aplicación de Microsoft Store e instálala manualmente.\n\nEstablecer el usuario por defecto en WSL\n\nAsegúrate de que WSL esté configurado para que siempre uses tu usuario por defecto y no root:\nwsl -d Ubuntu --user tu_usuario\nSi no recuerdas que verion de Ubuntu tines instalada, usa:\nwsl -l -v\nSi no recuerdas tu usuario en WSL, usa:\nwhoami\n\nConfigurar Ubuntu:\n\nAbre Ubuntu desde el menú de inicio.\nCrea un nombre de usuario y contraseña cuando se te solicite.\n\n\n\n\n\n\nAcceder a la carpeta de usuario de Windows:\n\nVerifica si la ruta existe:\n\nls \"/mnt/c/Users/\"\n\nVerifica tu nombre de usuario:\n\nls \"/mnt/c/Users/mi_usuario\"\n\nCrear un alias en ~/.bashrc:\n\nnano ~/.bashrc\n\nAgrega esta línea al final del archivo:\n\nalias homepatron='cd \"/mnt/c/Users/mi_usuario\"'\n\nGuarda (CTRL + X, luego Y y Enter) y actualiza:\n\nsource ~/.bashrc\n\nAhora podrás ejecutar:\n\nhomepatron",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "href": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "title": "Instalación de Software",
    "section": "Instalar RevBayes en Ubuntu",
    "text": "Instalar RevBayes en Ubuntu\n\nActualizar paquetes:\n\nEjecuta:\nsudo apt update && sudo apt upgrade -y\n\nDescargar RevBayes:\n\nUsa el siguiente comando para descargar la versión 1.2.5:\nwget https://github.com/revbayes/revbayes/releases/download/v1.2.5/revbayes-v1.2.5-linux64.tar.gz\n\nInstalar RevBayes:\n\nExtrae el archivo descargado y navega a la carpeta:\ntar -xzf revbayes-v1.2.5-linux64.tar.gz\ncd revbayes-v1.2.5/bin\nHaz que el ejecutable sea ejecutable:\nchmod +x rb\n\nAgregar RevBayes al PATH:\n\nPara que rb esté disponible en cualquier sesión de Ubuntu, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/revbayes-v1.2.5/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto permitirá ejecutar rb desde cualquier directorio en futuras sesiones de terminal.\n\nVerificar la instalación:\n\nEjecuta el programa:\nrb\nDeberías ver la interfaz de línea de comandos de RevBayes.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción-3",
    "href": "chapters/install.html#descripción-3",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nBAMM es un software diseñado para analizar tasas de diversificación y evolución de rasgos en filogenias de gran tamaño. Utiliza métodos bayesianos para estimar patrones heterogéneos de evolución y es ampliamente utilizado en estudios de macroevolución.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalación-de-bamm-en-ubuntu-wsl-o-nativo",
    "href": "chapters/install.html#instalación-de-bamm-en-ubuntu-wsl-o-nativo",
    "title": "Instalación de Software",
    "section": "Instalación de BAMM en Ubuntu (WSL o nativo)",
    "text": "Instalación de BAMM en Ubuntu (WSL o nativo)\n\nActualizar el sistema y dependencias:\n\nEjecuta los siguientes comandos para asegurarte de que el sistema esté actualizado y las dependencias necesarias estén instaladas:\nsudo apt update && sudo apt upgrade -y\nsudo apt install git build-essential cmake libgsl-dev -y\n\nClonar el repositorio de BAMM:\n\nClona el repositorio oficial de BAMM desde GitHub:\ngit clone https://github.com/macroevolution/bamm.git\n\nCrear el directorio de compilación:\n\nNavega al directorio raíz del proyecto, crea un directorio llamado build y accede a él:\ncd bamm\nmkdir build\ncd build\n\nCompilar BAMM:\n\nEjecuta los siguientes comandos para compilar BAMM:\ncmake ..\nmake -j\nEl ejecutable final se generará con el nombre bamm dentro del directorio build.\n\nAgregar BAMM al PATH:\n\nPara que el ejecutable bamm esté disponible desde cualquier directorio, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/bamm/build:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto asegurará que puedas ejecutar bamm desde cualquier lugar en futuras sesiones.\n\nVerificar la instalación:\n\nAsegúrate de que BAMM esté correctamente instalado ejecutando:\nbamm -h\nDeberías ver la pantalla de ayuda de BAMM.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html",
    "href": "chapters/commandline.html",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "",
    "text": "Comandos básicos en Bash",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#navegación-en-el-sistema-de-archivos",
    "href": "chapters/commandline.html#navegación-en-el-sistema-de-archivos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "1. Navegación en el sistema de archivos",
    "text": "1. Navegación en el sistema de archivos\n\n\n\n\n\n\npwd → Muestra el directorio actual.\npwd\nls → Lista los archivos y carpetas en el directorio actual.\nls -l     # Muestra detalles (permisos, dueño, tamaño, fecha)\nls -a     # Muestra archivos ocultos\nls -h     # Muestra tamaños en formato legible \ncd → Cambia de directorio.\ncd /   # Ir a la raiz\ncd /home/usuario/proyecto/data # ir a la carpeta data ruta absoluta\ncd data/ # ir a la carpeta data ruta relativa\ncd ..      # Subir un nivel",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#manipulación-de-archivos-y-directorios",
    "href": "chapters/commandline.html#manipulación-de-archivos-y-directorios",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "2. Manipulación de archivos y directorios",
    "text": "2. Manipulación de archivos y directorios\n\nmkdir → Crea un directorio.\nmkdir nueva_carpeta\nrm → Borra archivos y carpetas.\nrm archivo.txt        # Borra un archivo\nrm -r carpeta         # Borra una carpeta y su contenido\nrm -i archivo.txt     # Pregunta antes de borrar\ncp → Copia archivos o carpetas.\ncp archivo.txt copia.txt   # Copia un archivo\ncp -r carpeta destino/     # Copia una carpeta\nmv → Mueve o renombra archivos y carpetas.\nmv archivo.txt nueva_ubicacion/\nmv archivo.txt nuevo_nombre.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#visualización-y-edición-de-archivos",
    "href": "chapters/commandline.html#visualización-y-edición-de-archivos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "3. Visualización y edición de archivos",
    "text": "3. Visualización y edición de archivos\n\ncat → Muestra el contenido de un archivo.\ncat archivo.txt\nless → Permite visualizar archivos grandes de manera interactiva.\nless archivo.txt   # Usa las teclas ↑ ↓ para moverte, \"q\" para salir\nnano → Editor de texto en terminal.\nnano archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#limpiar-la-terminal",
    "href": "chapters/commandline.html#limpiar-la-terminal",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "4. Limpiar la terminal",
    "text": "4. Limpiar la terminal\n\nclear → Borra la pantalla de la terminal, pero no elimina procesos ni historial.\nclear\nCtrl + L → Hace lo mismo que clear, pero sin ejecutar un comando explícito.\n\nEn macOS: Cmd + K también limpia la terminal.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#historial-de-comandos",
    "href": "chapters/commandline.html#historial-de-comandos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "5. Historial de comandos",
    "text": "5. Historial de comandos\n\nCómo moverse en el historial\n\n↑ (Flecha arriba) → Muestra el último comando ejecutado.\n↓ (Flecha abajo) → Avanza en la lista de comandos previos.\nCtrl + R → Búsqueda rápida en el historial. Escribe parte del comando y pulsa Enter cuando encuentres el que necesitas.\n\nEjemplo: Presiona Ctrl + R y escribe nano, mostrará el último comando que usaste con nano.\n\n\nhistory → Muestra los últimos comandos ejecutados.\nhistory\nBuscar en el historial rápidamente con grep\nhistory | grep ls   # Filtra los comandos que contienen \"ls\"\nhistory | grep nano # Filtra los comandos con \"nano\"",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "href": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "6. Permisos y propiedades de archivos",
    "text": "6. Permisos y propiedades de archivos\n\nchmod → Cambia permisos de ejecucion.\nchmod +x script.Rev  # Permisos de ejecución\nchown → Cambia el dueño de un archivo.\nsudo chown usuario archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "href": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "Iniciar Ubuntu en la terminal de VS Code.",
    "text": "Iniciar Ubuntu en la terminal de VS Code.\n\nAbre VS Code y ve a Extensions (Ctrl + Shift + X)\n\n\n\n\n\nBusca WSL e instala la extensión oficial de Microsoft.\n\n\n\n\n\nTeclea el comando Ctrl + Shift + P y selecciona WSL: Connect to WSL\n\n\n\n\n\nSe abrirá una nueva ventana, ve a **Terminal** y selecciona una nueva **Terminal**\n\n\n\n\n\nEn la parte inferior se abrirá la terminal de Ubuntu",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html",
    "href": "chapters/Rstudio.html",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "¿Qué es R y qué es RStudio?",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#qué-es-r-y-qué-es-rstudio",
    "href": "chapters/Rstudio.html#qué-es-r-y-qué-es-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "R es un lenguaje de programación enfocado en el análisis de datos y estadísticas.\nRStudio es un entorno de desarrollo integrado (IDE) que facilita el trabajo con R y permite organiza los proyectos y facilita la ejecución de código, la visualización de gráficos y la gestión de paquetes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#partes-de-rstudio",
    "href": "chapters/Rstudio.html#partes-de-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Partes de RStudio",
    "text": "Partes de RStudio\nRStudio tiene cuatro paneles principales:\n\nConsole: Donde se ejecuta el código en tiempo real.\n\n\n\n\n\nEditor de scripts: Para escribir y guardar código en archivos .r, .R o .Rmd.\n\n\n\n\n\nEnvironment/History: Muestra variables y comandos previos.\n\n\n\n\n\nFiles/Plots/Packages/Help: Para manejar archivos, visualizar gráficos, instalar programas y acceder a documentación.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#creación-de-un-proyecto-en-rstudio",
    "href": "chapters/Rstudio.html#creación-de-un-proyecto-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Creación de un Proyecto en RStudio",
    "text": "Creación de un Proyecto en RStudio\nBeneficios de trabajar con proyectos:\n\nOrganización de archivos y código.\nFacilita la reproducibilidad.\nEvita problemas con rutas de archivos.\n\nPara crear un proyecto:\n\nEn RStudio, ir a File &gt; New Project.\n\n\n\n\n\nElegir un directorio nuevo o existente.\n\n\n\n\n\nTrabajar siempre dentro del proyecto para evitar problemas de rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#organización-de-proyectos-en-rstudio",
    "href": "chapters/Rstudio.html#organización-de-proyectos-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Organización de Proyectos en RStudio",
    "text": "Organización de Proyectos en RStudio\nMantener una estructura organizada en los proyectos es clave para la reproducibilidad y eficiencia. Se recomienda la siguiente estructura de carpetas:\nproyecto/\n│── data/         # Datos crudos y procesados\n│── scripts/      # Código fuente en R\n│── output/       # Resultados y gráficos\n│── reports/      # Documentación y reportes\n│── README.md     # Descripción del proyecto\nAdemás, para lograr una nomenclatura eficiente y consistente en archivos, se pueden seguir algunas pautas:\n\nConsistencia: Usar un esquema de nombres consistente en todo el proyecto.\nEvitar Espacios: Usar guiones bajos (_) o guiones (-) en lugar de espacios.\nPrefijos y Sufijos: Usar prefijos y sufijos estandarizados para identificar el estado o versión del archivo.\nEvitar Acentos y Caracteres Especiales: No utilizar acentos, eñes ni caracteres especiales que puedan causar problemas de compatibilidad en diferentes sistemas operativos o herramientas de software.\n\nEjemplos:\nbears_cytb.nex\ntree_BD.Rev\nmultifig.R\nqw_feature2.csv",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "href": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Rutas Absolutas y Relativas",
    "text": "Rutas Absolutas y Relativas\nLas rutas de archivos en R pueden ser absolutas o relativas:\n\nRuta absoluta: Define la ubicación exacta de un archivo, por ejemplo:\nread.csv(\"C:/Users/TuUsuario/Documents/data/datos.csv\")\nRuta relativa: Se basa en la ubicación del proyecto:\nread.csv(\"data/datos.csv\")\n\nSiempre es recomendable usar proyectos para evitar errores con rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#principales-objetos-en-r",
    "href": "chapters/Rstudio.html#principales-objetos-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Principales Objetos en R",
    "text": "Principales Objetos en R\n\nVectores\nx &lt;- c(1, 2, 3, 4, 5)\nprint(x)\n\n\nMatrices\nm &lt;- matrix(1:9, nrow=3)\nprint(m)\n\n\nData Frames\ndf &lt;- data.frame(Nombre=c(\"A\", \"B\", \"C\"), Edad=c(25, 30, 22))\nprint(df)\n\n\nListas\nlista &lt;- list(Nombre=\"Juan\", Edad=30, Notas=c(8, 9, 10))\nprint(lista)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#asignación-de-variables",
    "href": "chapters/Rstudio.html#asignación-de-variables",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Asignación de Variables",
    "text": "Asignación de Variables\nDiferencia entre &lt;- y =:\na &lt;- 10   # Recomendado para asignaciones\nb = 20    # También funciona, pero es mejor evitarlo",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "href": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Uso de Funciones en R",
    "text": "Uso de Funciones en R\nEjemplo de funciones básicas:\nnumeros &lt;- c(1, 2, 3, 4, 5)\nmean(numeros)  # Media\nsummary(numeros)  # Resumen estadístico",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#instalación-y-uso-de-paquetes",
    "href": "chapters/Rstudio.html#instalación-y-uso-de-paquetes",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Instalación y Uso de Paquetes",
    "text": "Instalación y Uso de Paquetes\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\nhelp(ggplot2)  # Consultar documentación",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "href": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Acceder a los archivos de Ubuntu en RStudio",
    "text": "Acceder a los archivos de Ubuntu en RStudio\n\nEjecuta el siguiente comando en PowerShell:\nwsl.exe wslpath -w ~\nMostrará una dirección como la que se muestra:\n\\\\wsl.localhost\\Ubuntu\\home\\tu_usuario\nEn RStudio puedes establecer el directorio de trabajo en la carpeta de Ubuntu (WSL) usando setwd(). Ten cuidado en las diuagonales, en powershell las diagonales son invertidas * y cuando las utilices en R utiliza las diagonales normales /*:\nsetwd(\"//wsl.localhost/Ubuntu/home/tu_usuario/mi_proyecto\")",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html",
    "href": "chapters/revbayes.html",
    "title": "Apuntes sobre RevBayes",
    "section": "",
    "text": "Introducción a la Inferencia Bayesiana\nLa inferencia bayesiana es un enfoque de la estadística que permite actualizar nuestras creencias sobre un parámetro desconocido a medida que obtenemos nueva información. Se basa en el Teorema de Bayes, que nos dice cómo combinar la información previa con la evidencia observada.\nEl Teorema de Bayes se expresa matemáticamente como:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nEl objetivo de la inferencia bayesiana es calcular la distribución posterior, que nos proporciona una estimación más precisa del parámetro \\(\\theta\\) al incorporar tanto datos como conocimiento previo.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#por-qué-se-necesita-mcmc",
    "href": "chapters/revbayes.html#por-qué-se-necesita-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¿Por qué se necesita MCMC?",
    "text": "¿Por qué se necesita MCMC?\nEn inferencia bayesiana, la distribución posterior de un parámetro \\(\\theta\\) se calcula usando:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nPero en la práctica, el denominador \\(P(D)\\) es difícil de calcular, ya que requiere integrar sobre todos los valores posibles de \\(\\theta\\):\n\\[\nP(D) = \\int P(D | \\theta) P(\\theta) d\\theta\n\\]\nCuando el espacio de parámetros es muy grande, esta integral es imposible de resolver analíticamente. MCMC nos ayuda a aproximar la distribución posterior sin necesidad de calcular \\(P(D)\\).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#cómo-funciona-mcmc",
    "href": "chapters/revbayes.html#cómo-funciona-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¿Cómo funciona MCMC?",
    "text": "¿Cómo funciona MCMC?\nMCMC simula valores de los parámetros siguiendo estos pasos:\n\nEmpieza en un valor inicial .\nPropone un nuevo valor basado en una distribución de transición.\nDecide si acepta o rechaza según la regla de aceptación.\nRepite el proceso muchas veces para construir una cadena de valores que sigan la distribución posterior.\n\n🔹 Importante:\nCon suficientes iteraciones, la cadena converge a la distribución posterior, permitiendo estimar parámetros de manera precisa.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#métodos-populares-de-mcmc",
    "href": "chapters/revbayes.html#métodos-populares-de-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "Métodos populares de MCMC",
    "text": "Métodos populares de MCMC\nExisten varias formas de implementar MCMC. Las más comunes son:\n✅ 1. Algoritmo de Metropolis-Hastings\n\nPropone un nuevo valor \\(\\theta^*\\).\nDecide si lo acepta o no comparando la razón de aceptación:\n\\[\nr = \\frac{P(D | \\theta^*) P(\\theta^*)}{P(D | \\theta) P(\\theta)}\n\\]\n\nSi \\(r \\geq 1\\), acepta \\(\\theta^*\\).\nSi \\(r &lt; 1\\), acepta \\(\\theta^*\\) con probabilidad \\(r\\).\n\n\nSe usa cuando no se conoce la forma exacta de la distribución posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#cómo-saber-si-una-cadena-ha-convergido",
    "href": "chapters/revbayes.html#cómo-saber-si-una-cadena-ha-convergido",
    "title": "Apuntes sobre RevBayes",
    "section": "¿Cómo saber si una cadena ha convergido?",
    "text": "¿Cómo saber si una cadena ha convergido?\n\n\n\n\n\nAlgunas técnicas comunes para evaluar la convergencia incluyen:\n\nInspección visual de trazas: un gráfico de trazas muestra si la cadena ha alcanzado un comportamiento estable sin tendencias obvias.\nTamaño de muestra efectivo (Effective Sample Size, ESS): Dado que las muestras en MCMC están correlacionadas, el número real de muestras independientes es menor que el número total de iteraciones. El tamaño de muestra efectivo (ESS) estima cuántas muestras independientes equivalentes hay en la cadena.\n\nSe calcula como:\n\\[\nESS = \\frac{N}{1 + 2 \\sum \\rho_k}\n\\]\nDonde \\(N\\) es el número total de iteraciones y \\(\\rho_k\\) es la autocorrelación en el retraso \\(k\\). Un ESS alto (\\(ESS &gt; 200\\)) indica que la cadena ha explorado bien el espacio de parámetros y proporciona estimaciones confiables.\nUn ESS bajo sugiere que las muestras están altamente correlacionadas y que se necesitan más iteraciones o una mejor parametrización del algoritmo para obtener estimaciones más precisas.\nPara visualizar estos valores y generar gráficos, se puede utilizar Tracer, una herramienta que facilita el análisis de convergencia de cadenas MCMC. Se puede descargar en el siguiente enlace:\nTracer v1.7.2",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "href": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "Tipos de Nodos en RevBayes",
    "text": "Tipos de Nodos en RevBayes\n\n👉 Nodos Constantes\nSon valores fijos dentro del modelo. No tienen incertidumbre.\nn = 10  # Número de observaciones\n\n\n👉 Nodos Estocásticos\nRepresentan variables aleatorias con una distribución. Son los parámetros del modelo.\ntheta ~ dnBeta(2,2)  # Prior Beta(2,2)\nEn este caso, theta es una variable aleatoria con una distribución Beta.\n\n\n👉 Nodos Deterministas\nSon valores calculados a partir de otros nodos.\nmu := theta * n  # Media esperada\nAquí, mu se calcula a partir de theta y n.\n\n\n👉 Nodos Clamped (Observados)\nSe utilizan para fijar valores observados en el modelo.\nD ~ dnBinomial(n, theta)  # Modelo Binomial\nD.clamp(7)  # Observamos 7 éxitos\nEn este caso, D es una variable aleatoria Binomial, pero la fijamos en 7.\n\n\n👉 Nodos Plate\nLos plates se usan para repetir estructuras en modelos jerárquicos.\nfor (i in 1:10) {\n    theta[i] ~ dnBeta(2,2)\n}\nAquí, estamos creando 10 valores de theta, cada uno con una distribución Beta(2,2).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "href": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "🔹 1. Definiendo el Modelo en RevBayes",
    "text": "🔹 1. Definiendo el Modelo en RevBayes\n\n📌 Distribución Prior\nAntes de ver los datos, asumimos una creencia previa sobre la probabilidad ( p ).\nUtilizamos una distribución Beta(8,2), basada en la suposición de que aproximadamente el 80% de las personas disfrutarán del ambiente.\n\\[\np \\sim \\text{Beta}(8,2)\n\\]\nPágina para visualizar las distribuciones para RevBayes, pega el siguiente código en Rev code:\nx ~ dnBeta(8, 2)\nLa media de esta distribución es:\n\\[\nE[p] = \\frac{\\alpha}{\\alpha + \\beta} = \\frac{8}{8+2} = 0.8\n\\]\n\n\n\n📌 Verosimilitud (Likelihood)\nLa verosimilitud describe la probabilidad de observar los datos dados un valor específico de ( p ).\nComo cada estudiante puede estar satisfecho (éxito) o insatisfecho (fracaso), usamos una distribución Binomial:\n\\[\nk \\sim \\text{Binomial}(n = 10, p)\n\\]\nDonde: - ( k = 7 ) es el número de estudiantes satisfechos observados. - ( n = 10 ) es el número total de encuestados.\n\n\n\n📌 Posterior Bayesiana\nAplicamos el Teorema de Bayes:\n\\[\nP(p | D) \\propto P(D | p) P(p)\n\\]\nDado que usamos un prior Beta y una verosimilitud Binomial, la posterior también sigue una distribución Beta con parámetros actualizados:\n\\[\np | D \\sim \\text{Beta}(8+7, 2+3) = \\text{Beta}(15,5)\n\\]\nLa media de la posterior nos da la mejor estimación después de observar los datos:\n\\[\nE[p] = \\frac{15}{15 + 5} = 0.75\n\\]\nEsto significa que, después de observar que 7 de 10 estudiantes disfrutaron el ambiente, nuestra mejor estimación de la probabilidad de que tú disfrutes del ambiente es 75%.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#código-en-revbayes",
    "href": "chapters/revbayes.html#código-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "🔹 2. Código en RevBayes",
    "text": "🔹 2. Código en RevBayes\nA continuación, presentamos el código en RevBayes para implementar este modelo y ejecutar un análisis MCMC.\n\n\n\n\n\n# ------------------------------------------------\n# RevBayes - Algoritmo de Metropolis-Hastings para estimar\n# la probabilidad de disfrutar el ambiente en las micheladas de Tepito\n# ------------------------------------------------\n\n# Datos observados\ntotal_clientes &lt;- 10  # Número total de encuestados\nsatisfechos &lt;- 7      # Número de estudiantes que disfrutaron el ambiente\n\n# Especificar la distribución prior\nalpha &lt;- 8   # Basado en la creencia previa de 80% satisfacción\nbeta  &lt;- 2   # Complemento del prior\np ~ dnBeta(alpha, beta)  # Prior Beta(8,2)\n\n# Definir la propuesta de MCMC con Metropolis-Hastings\nmoves[1] = mvSlide(p, delta=0.1, weight=1)  # Movimiento en la distribución de p\n\n# Especificar el modelo de verosimilitud (distribución Binomial)\nk ~ dnBinomial(p, total_clientes)\nk.clamp(satisfechos)  # Fijar la observación de 7 estudiantes satisfechos\n\n# Crear el modelo\nmy_model = model(p)\n\n# Definir monitores para el MCMC\nmonitors[1] = mnModel(filename=\"micheladas_MH.log\", printgen=10, separator = TAB)  # Guardar resultados\nmonitors[2] = mnScreen(printgen=100, p)  # Mostrar progreso cada 100 generaciones\n\n# Crear el análisis MCMC con Metropolis-Hastings\nanalysis = mcmc(my_model, monitors, moves)\n\n# Ejecutar el MCMC con 100,000 iteraciones\nanalysis.run(100000)\n\n# Mostrar el resumen de los operadores de MCMC\nanalysis.operatorSummary()",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#mini-ejercicio",
    "href": "chapters/revbayes.html#mini-ejercicio",
    "title": "Apuntes sobre RevBayes",
    "section": "Mini-ejercicio",
    "text": "Mini-ejercicio\n\nCrea un script para RevBayes (.Rev) utilizando Visual Studio Code y copia el codigo.\nModifica el prior dnBeta(alpha, beta) con los valores que reflejen tu creencia sobre la probabilidad de satisfacción.\nGuarda el archivo micheladas_MH.log en la carpeta asiganada para guardar resultados.\nGuarda el script en la carpeta de scripts.\nEjecuta el análisis MCMC en RevBayes.\nVisualiza los resultados usando Tracer para observar la distribución posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html",
    "href": "chapters/u1_intro_diversification.html",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "",
    "text": "Presentación: Introducción al proceso de diversificación parte 1\nHaz clic en la imagen para ver el PDF de la presentación",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "href": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "1.- Mediante la liberia remotes",
    "text": "1.- Mediante la liberia remotes\n\n# Instalar remotes si no está instalado\nif (!requireNamespace(\"remotes\", quietly = TRUE)) {\n  install.packages(\"remotes\")\n}\n\n# Instalar TreePar\nremotes::install_github(\"tanja819/TreePar\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "href": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "2.- Descargar el paquete TreePar",
    "text": "2.- Descargar el paquete TreePar\n\nPuedes descargar el paquete desde el siguiente enlace:\n📥 Descargar TreePar 3.3\nGuarda el archivo en una carpeta de tu elección (por ejemplo, en ~/Descargas/ o C:/Users/TuUsuario/Downloads/).\n\n\n\nInstalar TreePar desde el archivo descargado\nUna vez que hayas descargado el archivo TreePar_3.3.tar.gz, abre R y ejecuta el siguiente código para instalarlo:\n# Definir la ruta donde se descargó el archivo\nruta_archivo &lt;- \"~/Descargas/TreePar_3.3.tar.gz\"  # Cambia esta ruta según tu sistema operativo\n\n# Instalar el paquete desde el archivo .tar.gz\ninstall.packages(ruta_archivo, repos = NULL, type = \"source\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descarga-del-árbol-filogenético",
    "href": "chapters/u1_intro_diversification.html#descarga-del-árbol-filogenético",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Descarga del Árbol Filogenético",
    "text": "Descarga del Árbol Filogenético\n📥 Puedes descargar el archivo NEXUS con el árbol de estudio en el siguiente enlace:\n📥 Descargar Árbol Filogenético\nGuarda el archivo en la carpeta correspondiente y verifica su ubicación antes de continuar.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-árbol-en-r",
    "href": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-árbol-en-r",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Cargar y Visualizar el Árbol en R",
    "text": "Cargar y Visualizar el Árbol en R\nEjecuta el siguiente código en R para cargar el archivo y visualizar el árbol completo:\n\n# Cargar los paquetes necesarios\nlibrary(ape)\nlibrary(ggtree)\nlibrary(treeio)\nlibrary(tidyverse)\n\n# Definir la ruta del archivo NEXUS\narchivo_nexus &lt;- \"../docs/u1_PatDiv/allSamples.tre\"  # Asegúrate de cambiar esta ruta si es necesario\n\n# Cargar el árbol\narbol &lt;- read.nexus(archivo_nexus)\n\n# Calcular el Límite Máximo del Eje X\nmax_edge_length &lt;- max(arbol$edge.length, na.rm = TRUE)\n\n# Graficar el árbol\nggtree(arbol) +\n  geom_tiplab(size = 3) +\n  geom_text2(aes(subset = !isTip, label = node), hjust = -0.3) +  # Etiquetar nodos internos\n  xlim(-0.5, max_edge_length * 1.4) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-específico",
    "href": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-específico",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Extraer los nombres de las terminales de un nodo específico:",
    "text": "Extraer los nombres de las terminales de un nodo específico:\nUtilizar la función getDescendants para obtener los nombres de todas la terminales del nodo interno 61:\n\nlibrary(phytools)\n\nnodo_interes &lt;- 61  # Reemplaza este valor por el nodo de tu interés\n\n# Obtener los índices de los nodos descendientes\nnodos_internos &lt;- getDescendants(arbol, nodo_interes)\n\n# Filtrar solo los índices que corresponden a las terminales (tips)\nindices_tips &lt;- nodos_internos[nodos_internos &lt;= length(arbol$tip.label)]\n\n# Obtener los nombres de las terminales\nnombres_tips &lt;- arbol$tip.label[indices_tips]\n\n# Mostrar los nombres de las terminales\nprint(nombres_tips)\n\n [1] \"06166_50_120_Phod_marmorata\" \"KRN15_107_Phod_marmorata\"   \n [3] \"KRN52_Phod_alticeps\"         \"KRN10_118_Phod_alticeps\"    \n [5] \"KRN14_Phod_alticeps\"         \"KRN24_Cyste_armatus\"        \n [7] \"KRN02_Cyste_armatus\"         \"KRN25_Cyste_armatus\"        \n [9] \"KRN28_Cyste_wislizeni\"       \"KRN03_Cyste_wislizeni\"      \n[11] \"KRN26_Cyste_wislizeni\"       \"KRN100_101_Tegro_aloga\"     \n[13] \"KRN96_97_98_Tegro_aloga\"     \"KRN11_Tegro_erosa\"          \n[15] \"KRN12_Tegro_erosa\"           \"KRN13_Tegro_latecincta\"     \n[17] \"KRN53_Tegro_latecincta\"      \"KRN01_Cordy_opaca\"          \n[19] \"KRN112_Cordy_opaca\"          \"KRN111_Cordy_fulleri\"       \n[21] \"KRN23_Cordy_fulleri\"         \"KRN09_Mege_vittata\"         \n[23] \"KRN08_Mege_puncta\"           \"KRN07_133_Mege_cancell\"     \n[25] \"KRN129_Mege_cancell_h\"       \"KRN51_Pleu_reticulata\"      \n[27] \"KRN48_Pleu_mirabilis\"        \"KRN47_119_Pleu_mirabilis\"   \n[29] \"KRN49_Pleu_mirabilis\"        \"KRN19_Eup_sulciphrons\"      \n[31] \"KRN131_Eup_schwarzi\"         \"KRN88_89_Eup_histrionica\"   \n[33] \"KRN90_Eup_histrionica\"       \"KRN43_108_Eup_fissiceps\"    \n[35] \"KRN45_Eup_fissiceps\"         \"KRN44_Eup_fissiceps\"        \n[37] \"KRN54_121_Eup_fissiceps\"     \"KRN20_Eup_imperialis\"       \n[39] \"KRN06_Eup_imperialis\"        \"KRN42_Eup_imperialis\"       \n[41] \"KRN30_113_Eup_elegans\"       \"KRN38_115_Eup_elegans_p\"    \n[43] \"KRN29_Eup_elegans_p\"         \"KRN21_114_Eup_elegans_p\"    \n[45] \"KRN40_Eup_elegans_p\"         \"KRN92_93_Eup_edmundsi\"      \n[47] \"KRN18_135_Eup_viridis\"       \"KRN59_Eup_viridis\"",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-subárboles-filogenéticos",
    "href": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-subárboles-filogenéticos",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Uso de getMRCA y extract.clade para extraer Subárboles Filogenéticos",
    "text": "Uso de getMRCA y extract.clade para extraer Subárboles Filogenéticos\n\n# Obtener el nodo más reciente en común del ingroup\nmrca_ingroup &lt;- getMRCA(arbol, nombres_tips)\n\n# Extraer el subárbol del ingroup\nsubarbol &lt;- extract.clade(arbol, mrca_ingroup)\n\n# Calcular la longitud máxima de las ramas del subárbol\nmax_edge_length &lt;- max(subarbol$edge.length, na.rm = TRUE)\n\n# Graficar el subárbol\nggtree(subarbol) +\n  geom_tiplab(size = 3) +\n  xlim(-0.5, max_edge_length * 2) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "href": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Remover especies duplicadas",
    "text": "Remover especies duplicadas\n\n# Separar los nombres de las especies (asumiendo el formato \"ID_Especie\")\nspecies_info &lt;- data.frame(\n  tip_label = nombres_tips,\n  species = str_extract(nombres_tips, \"[A-Za-z]+_[A-Za-z]+(?:_[A-Za-z]+)?$\")\n)\n\n# Eliminar las ssp _h y _p\n# Seleccionar solo una muestra por especie\nunique_species &lt;- species_info %&gt;%\n  filter(!str_detect(species, \"_[hp]$\")) %&gt;%\n  group_by(species) %&gt;% \n  slice(1) %&gt;%  # Selecciona solo la primera aparición de cada especie\n  ungroup()\n\n# Extraer los nombres de los tips que queremos conservar\nselected_tips &lt;- unique_species$tip_label\n\n# Remover duplicados\nsubarbol_final &lt;- drop.tip(subarbol, setdiff(subarbol$tip.label, selected_tips))\n\nggtree(subarbol_final) + \n  geom_tiplab(size = 3) + \n  xlim(-0.5, max(subarbol_final$edge.length) * 2)  # Expande el espacio a la izquierda",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#guardar-el-árbol-resultante-en-formato-nexus",
    "href": "chapters/u1_intro_diversification.html#guardar-el-árbol-resultante-en-formato-nexus",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Guardar el árbol resultante en formato NEXUS",
    "text": "Guardar el árbol resultante en formato NEXUS\n\nwrite.nexus(subarbol_final, file=\"../docs/u1_PatDiv/subarbol_ingroup.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#carga-del-árbol-filogenético",
    "href": "chapters/u1_intro_diversification.html#carga-del-árbol-filogenético",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Carga del Árbol Filogenético",
    "text": "Carga del Árbol Filogenético\n\n# Carga de paquetes\nlibrary(subplex)\nlibrary(TreeSim)\nlibrary(deSolve)\nlibrary(ape)       \nlibrary(TreePar)\n\n# Cargar el árbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el árbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtención-de-los-tiempos-de-especiación",
    "href": "chapters/u1_intro_diversification.html#obtención-de-los-tiempos-de-especiación",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Obtención de los Tiempos de Especiación",
    "text": "Obtención de los Tiempos de Especiación\nExtraeremos y ordenaremos los tiempos de especiación (tiempos de ramificación) del árbol:\n\n# Obtener y ordenar los tiempos de especiación\n# La función getx() extrae los tiempos de ramificación del árbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulación.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configuración-de-parámetros-para-el-análisis",
    "href": "chapters/u1_intro_diversification.html#configuración-de-parámetros-para-el-análisis",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Configuración de Parámetros para el Análisis",
    "text": "Configuración de Parámetros para el Análisis\nDefiniremos los parámetros necesarios para el análisis de cambios en las tasas de diversificación:\n\nrho &lt;- 22/26  # Proporción de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tamaño de la grilla de búsqueda de cambios de tasa (en millones de años)\nstart &lt;- min(times) + 1.5  # Tiempo inicial para la búsqueda de cambios de tasa\nend &lt;- max(times) - 1.5    # Tiempo final para la búsqueda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#ejecución-del-análisis-con-bd.shifts.optim",
    "href": "chapters/u1_intro_diversification.html#ejecución-del-análisis-con-bd.shifts.optim",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Ejecución del Análisis con bd.shifts.optim",
    "text": "Ejecución del Análisis con bd.shifts.optim\nUtilizaremos la función bd.shifts.optim para estimar las tasas de especiación y extinción, así como los puntos en el tiempo donde ocurren cambios significativos en estas tasas:\n\n# Ejecutar el análisis de cambios en las tasas de diversificación\nresult_shifts &lt;- bd.shifts.optim(times, rho, grid, start, end, yule=TRUE)\n\n[1] \"startest\"\n[1] \"test\"\n\n# Mostrar los resultados\nresult_shifts[[2]][[1]]\n\n[1] 70.02138042  0.08912957\n\n\nA continuación se presentan los valores obtenidos en la estimación de la tasa de diversificación. Dado que el modelo Yule asume que no hay extinción, la tasa de extinción no está definida en este análisis.\n\nValor de la función de verosimilitud negativa: 70.02138\nTasa de especiación \\(\\lambda\\): 0.08913\n\nEn este contexto:\nEstos valores indican que la tasa de especiación estimada (\\(\\lambda\\)) es aproximadamente 0.08913.\nEl valor de la función de verosimilitud negativa (70.02138) proporciona una medida del ajuste del modelo a los datos, donde valores más bajos generalmente indican un mejor ajuste.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "href": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "text": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "href": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Cargar el archivo NEXUS",
    "text": "Cargar el archivo NEXUS\n# Cargar la filogenia desde el archivo NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Obtener la lista de taxones en la filogenia\ntaxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "href": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Inicializar los vectores de moves y monitors",
    "text": "Inicializar los vectores de moves y monitors\n# Inicializar un vector vacío para los movimientos (moves)\nmoves = VectorMoves()\n\n# Inicializar un vector vacío para los monitores (monitors)\nmonitors = VectorMonitors()\n\n\n\n\n\nRepresentación del modelo gráfico para el proceso Yule (Pure-Birth) en RevBayes, donde la tasa de especiación (\\(\\lambda\\)) es tratada como una variable aleatoria extraída de una distribución uniforme.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiación-lambda",
    "href": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiación-lambda",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Especificar la tasa de especiación (\\(\\lambda\\))",
    "text": "Especificar la tasa de especiación (\\(\\lambda\\))\n# Especificar la tasa de especiación λ con una distribución uniforme\nbirth_rate ~ dnUniform(0, 100.0)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiación",
    "href": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiación",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Asignar un movimiento MCMC a la tasa de especiación",
    "text": "Asignar un movimiento MCMC a la tasa de especiación\n# Agregar un movimiento MCMC para la tasa de especiación\nmoves.append( mvScale(birth_rate, lambda=1.0, tune=true, weight=3.0) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-proporción-de-especies-muestreadas-rho",
    "href": "chapters/u1_intro_diversification.html#especificar-la-proporción-de-especies-muestreadas-rho",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Especificar la proporción de especies muestreadas (\\(\\rho\\))",
    "text": "Especificar la proporción de especies muestreadas (\\(\\rho\\))\n# Obtener el número de taxones en la filogenia\nnum_taxa &lt;- T.ntips()\n\n# Estimar la proporción de especies muestreadas\nrho &lt;- num_taxa / 26",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-raíz",
    "href": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-raíz",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Obtener la edad de la raíz",
    "text": "Obtener la edad de la raíz\n# Obtener la edad de la raíz del árbol\nroot_time &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiación",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiación",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Definir el modelo de tiempo de especiación",
    "text": "Definir el modelo de tiempo de especiación\nEl modelo Yule (pure-birth) en RevBayes se define con el proceso de nacimiento y muerte (dnBDP), pero con la tasa de extinción (mu) fijada en 0.\n# Definir el modelo de diversificación usando un proceso de nacimiento-muerte (BDP)\ntimetree ~ dnBDP(lambda=birth_rate, mu=0.0, rho=rho, rootAge=root_time, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)\nExplicación\n\nlambda = birth_rate → Tasa de especiación es una variable aleatoria con dnUniform(0, 100.0).\nmu = 0.0 → Asumimos que no hay extinción (modelo Yule).\nrho = rho → Se ajusta según el número de especies muestreadas.\nrootAge = root_time → Condicionamos el modelo en la edad de la raíz.\nsamplingStrategy = \"uniform\" → Asumimos muestreo uniforme.\ncondition = \"survival\" → Solo analizamos árboles que sobrevivieron hasta el presente.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "href": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Fijar la filogenia observada",
    "text": "Fijar la filogenia observada\n# Fijar la filogenia observada\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-gráfico",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-gráfico",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Definir el modelo gráfico",
    "text": "Definir el modelo gráfico\n# Crear el objeto de modelo\nmymodel = model(birth_rate)\nEsto crea un modelo gráfico dirigido acíclico (DAG) donde birth_rate es el nodo principal, y RevBayes automáticamente encuentra todos los otros nodos conectados.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "href": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Especificar los Monitores",
    "text": "Especificar los Monitores\n# Monitor para registrar los estados del modelo en un archivo de salida\nmonitors.append( mnModel(filename=\"output/diversification_Yule.log\", printgen=10, separator=TAB) )\n\n# Monitor para imprimir la tasa de especiación en la pantalla cada 1000 generaciones\nmonitors.append( mnScreen(printgen=1000, birth_rate) )\nExplicación\n\nmnModel guarda el registro de la ejecución en \"output/diversification_Yule.log\", escribiendo cada 10 generaciones.\nmnScreen imprime la tasa de especiación (birth_rate) en la consola cada 1000 generaciones.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Configurar y ejecutar el MCMC",
    "text": "Configurar y ejecutar el MCMC\n# Inicializar el MCMC con dos cadenas combinadas en un solo análisis\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\n\n# Ejecutar el MCMC por 50,000 generaciones, ajustando los movimientos cada 200 generaciones\nmymcmc.run(generations=50000, tuningInterval=200)\nExplicación\n\nnruns=2 → Corre dos cadenas independientes.\ncombine=\"mixed\" → Combina las cadenas en un solo conjunto de muestras.\ngenerations=50000 → Ejecuta la simulación por 50,000 generaciones.\ntuningInterval=200 → Ajusta los movimientos cada 200 generaciones para mejorar la eficiencia del muestreo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "href": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Cargar los resultados en RevGadgets",
    "text": "Cargar los resultados en RevGadgets\nDespués de correr el MCMC en RevBayes, usar RevGadgets en R para analizar la distribución posterior:\n\n# Cargar librerías necesarias\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC\nmcmc_trace &lt;- readTrace(\"../docs/u1_PatDiv/output/diversification_Yule.log\")\n\n# Visualizar la distribución posterior de birth_rate\nplotTrace(mcmc_trace, vars=\"birth_rate\")\n\n[[1]]",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "href": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Calcular la media y el intervalo de HPD (Highest Posterior Density)",
    "text": "Calcular la media y el intervalo de HPD (Highest Posterior Density)\n\n# Calcular la media posterior y el HPD del 95%\nsummary_stats &lt;- summarizeTrace(mcmc_trace, vars=\"birth_rate\")\nprint(summary_stats)\n\n$birth_rate\n$birth_rate$trace_1\n         mean        median           MAP  quantile_2.5 quantile_97.5 \n   0.09313312    0.09214016    0.09140298    0.05919603    0.13341000",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#comparar-la-distribución-previa-y-posterior",
    "href": "chapters/u1_intro_diversification.html#comparar-la-distribución-previa-y-posterior",
    "title": "Introducción al proceso de diversificación parte 1",
    "section": "Comparar la distribución previa y posterior",
    "text": "Comparar la distribución previa y posterior\n\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC combinando las dos cadenas\nposterior_trace &lt;- readTrace(c(\"../docs/u1_PatDiv/output/diversification_Yule_run_1.log\", \"../docs/u1_PatDiv/output/diversification_Yule_run_2.log\"))\n\n# Extraer el primer conjunto de muestras (lista de data frames)\nyule_posterior &lt;- posterior_trace[[1]]\n\n# Simular 10,000 valores de la distribución previa\nyule_prior &lt;- data.frame(birth_rate = runif(10000, min=0, max=100))\n\n# Agregar la columna de la distribución previa en el posterior\nyule_posterior$birth_rate_prior &lt;- sample(yule_prior$birth_rate, size = nrow(yule_posterior), replace = TRUE)\n\n# Graficar la comparación\nplotTrace(list(yule_posterior), vars = c(\"birth_rate\", \"birth_rate_prior\"))[[1]] +\n  theme(legend.position = c(0.80, 0.80),  # Ubicación de la leyenda\n        legend.text = element_text(size =20),  # Tamaño del texto de la leyenda\n        legend.title = element_text(size = 22)) +  # Tamaño del título de la leyenda\n  xlim(0, 1)  # Ajusta el límite según los valores observados",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 1</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html",
    "href": "chapters/u1_intro_diversification_2.html",
    "title": "Introducción al proceso de diversificación parte 2",
    "section": "",
    "text": "Presentación: Introducción al proceso de diversificación parte 2\nHaz clic en la imagen para ver el PDF de la presentación",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducción",
    "href": "chapters/u1_intro_diversification_2.html#introducción",
    "title": "Introducción al proceso de diversificación parte 2",
    "section": "Introducción",
    "text": "Introducción\nEn estudios filogenéticos, los modelos de nacimiento-muerte (birth-death models) permiten inferir cómo han cambiado las tasas de especiación () y extinción () a lo largo del tiempo. Sin embargo, estas tasas no son siempre constantes. Diversos eventos evolutivos, como la aparición de nuevas adaptaciones o cambios ambientales, pueden causar variaciones en la dinámica de diversificación de un linaje.\nEl paquete TreePar permite ajustar modelos de diversificación con cambios en la tasa mediante la función bd.shifts.optim(). Esta función estima la mejor combinación de tasas de especiación y extinción en diferentes periodos de tiempo, según la estructura de una filogenia dada.\nCargar librerías y el árbol filogenético\n\n# Cargar las librerías necesarias\nlibrary(ape)       \nlibrary(TreePar)\nlibrary(tidyverse)\nlibrary(ggtree)\n\n# Cargar el árbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el árbol\nggtree(tree) + theme_tree()\n\n\n\n\n\n\n\n\nObtención de los Tiempos de Especiación\nExtraeremos y ordenaremos los tiempos de especiación (tiempos de ramificación) del árbol:\n\n# Obtener y ordenar los tiempos de especiación\n# La función getx() extrae los tiempos de ramificación del árbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulación.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293\n\n\nConfiguración de Parámetros para el Análisis\nDefiniremos los parámetros necesarios para el análisis de cambios en las tasas de diversificación:\n\nrho &lt;- 22/26  # Proporción de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tamaño de la grilla de búsqueda de cambios de tasa (en millones de años)\nstart &lt;- min(times)   # Tiempo inicial para la búsqueda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la búsqueda de cambios de tasa\n\nModelo de nacimiento-muerte sin cambios en la tasa\n\nresbd &lt;- bd.shifts.optim(times, rho, grid, start, end)\n\n[1] \"startest\"\n[1] \"test\"\n\nresbd[[2]]  # Verosimilitud del modelo\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n\nModelo con un cambio en la tasa\nAquí probamos un modelo en el que la tasa cambia en un tiempo \\(t_{1}\\)\n\n\n\n\n\n\n\nParámetro\nSignificado\n\n\n\n\ntime\nEdades de los nodos terminales\n\n\nc(0.8, 1)\nProporción de especies muestreadas en cada periodo\n\n\ngrid\nIntervalo de discretización del tiempo\n\n\nstart, end\nRango de tiempo para el análisis\n\n\nME=FALSE\nNo se consideran eventos de extinción masiva\n\n\nsurvival=1\nSe asume que todas las especies sobrevivientes han sido muestreadas\n\n\n\n\nresoneshift &lt;- bd.shifts.optim(times, c(rho, 1), grid, start, end, ME=FALSE, survival=1)\nresoneshift[[2]]  # Verosimilitud del modelo con un cambio en la tasa\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.295893e+01 9.952613e-01 8.527988e-02 1.001768e-04 1.594866e-01\n[6] 6.125229e+00\n\n\nInterpretación\n\nVerosimilitud:\n\n\n\n\n\n\n\n\n\nÍndice\nParámetro estimado\nDescripción\n\n\n\n\n1\n62.95893\nVerosimilitud (log-likelihood)\n\n\n2\n0.99526\nProporción de especies muestreadas en el tiempo más reciente (\\(\\rho\\))\n\n\n3\n0.08528\nTasa de especiación (\\(\\lambda_1\\)) antes del cambio de tasa\n\n\n4\n0.00010\nTasa de extinción (\\(\\mu_1\\)) antes del cambio de tasa\n\n\n5\n0.15949\nTiempo del cambio en la tasa (\\(t_1\\))\n\n\n6\n6.12523\nNueva tasa de especiación (\\(\\lambda_2\\)) después del cambio\n\n\n\nModelo con dos cambios en la tasa (2 shifts)\n\nrestwoshift &lt;- bd.shifts.optim(times, c(0.8,1,1), grid, start, end, ME=FALSE, survival=1)\nrestwoshift[[2]]\n\n\n\n[[1]]\n[1] 6.984598e+01 2.752173e-07 9.230017e-02\n\n[[2]]\n[1] 6.300085e+01 3.082460e-02 9.309168e-08 1.887393e-02 1.612077e-01\n[6] 6.125229e+00\n\n[[3]]\n[1]  6.045200e+01  7.427444e-08  1.840255e-02  1.040200e+00  2.028774e-02\n[6]  1.244237e-01 -2.968324e-02  6.125229e+00  1.472523e+01",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#resultados-del-segundo-cambio-en-la-tasa-restwoshift3",
    "href": "chapters/u1_intro_diversification_2.html#resultados-del-segundo-cambio-en-la-tasa-restwoshift3",
    "title": "Introducción al proceso de diversificación parte 2",
    "section": "Resultados del segundo cambio en la tasa (restwoshift[[3]])",
    "text": "Resultados del segundo cambio en la tasa (restwoshift[[3]])\n\n\n\n\n\n\n\n\nÍndice\nValor\nDescripción\n\n\n\n\n1\n60.45200\nVerosimilitud (log-likelihood)\n\n\n2\n7.427444e-08\nProporción de especies muestreadas en este periodo\n\n\n3\n0.01840\nTasa de especiación (\\(\\lambda_2\\)) antes del segundo cambio\n\n\n4\n1.04020\nTasa de extinción (\\(\\mu_2\\)) antes del segundo cambio\n\n\n5\n0.02028\nNuevo tiempo del segundo cambio en la tasa (\\(t_2\\))\n\n\n6\n0.12442\nTasa de especiación (\\(\\lambda_3\\)) después del segundo cambio\n\n\n7\n-0.02968\nUn parámetro auxiliar de optimización\n\n\n8\n6.12523\nSe repite el valor de especiación de un periodo anterior\n\n\n9\n14.72523\nMomento en el tiempo en el que ocurre el segundo cambio (\\(\\(t_2\\))\n\n\n\nComparación de modelos usando Likelihood Ratio Test (LRT)\n¿Qué es la prueba LRT? Es una prueba estadística para comparar modelos anidados, es decir, modelos donde uno es una versión simplificada del otro (por ejemplo, el modelo de nacimiento-muerte puro vs. un modelo con cambios en la tasa).\nSe calcula con la siguiente fórmula:\n\\(LR = 2 * (\\mathcal{L}_{modelo más simple} - \\mathcal{L}_{modelo más complejo})\\)\nDonde: - Un p-valor menor a 0.05 indica que el modelo más complejo es significativamente mejor que el más simple.\nObtener las Verosimilitudes de cada modelo\n\n## Verosimilitud birth-death\nresbd[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death un cambio\nresoneshift[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death dos cambios\nrestwoshift[[2]][[1]][1]\n\n[1] 69.84598\n\n\nComparación BD vs BD un cambio\n\nChiSq1 = 2 * (resbd[[2]][[1]][1] - resoneshift[[2]][[1]][1])\nChiSq1\n\n[1] 0\n\npchiSq1 &lt;- pchisq(ChiSq1, df=3)\npchiSq1\n\n[1] 0\n\n\nResultados:\n\n\\(LR = 0\\) → No hay diferencia en la verosimilitud entre el modelo BD y BD con un cambio.\n\\(p_{valor} = 0\\) → Indica que no hay mejora significativa en el modelo con un cambio en la tasa.\n\nComparación BD un cambio vs BD dos cambios\n\nChiSq2 = 2 * (resoneshift[[2]][[1]][1] - restwoshift[[2]][[1]][1])\nChiSq2\n\n[1] 0.3508041\n\npchiSq2 &lt;- pchisq(ChiSq2, df=3)\npchiSq2\n\n[1] 0.04979325\n\n\nResultados:\n\n\\(LR = 0.3508\\) → Hay una pequeña diferencia en la verosimilitud entre el modelo BD con un cambio y el modelo BD con dos cambios.\n\\(p_{valor} = 0.0498\\) → Justo en el límite del umbral de significancia \\((0.05)\\), lo que indica que el modelo con dos cambios podría ser significativamente mejor.\n\nGenerar el gráfico con bd.shifts.plot()\nGraficar el modelo con un cambio en la tasa\n\nbd.shifts.plot(list(resoneshift[[2]]), shifts = 1, timemax = max(times), ratemin = 0, ratemax = 0.2)\n\n\n\n\n\n\n\n\nGraficar el modelo con un cambio en la tasa\n\nbd.shifts.plot(list(restwoshift[[2]]), shifts = 2, timemax = max(times), ratemin = -0.1, ratemax = 0.2)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducción-1",
    "href": "chapters/u1_intro_diversification_2.html#introducción-1",
    "title": "Introducción al proceso de diversificación parte 2",
    "section": "Introducción",
    "text": "Introducción\nEl modelo de nacimiento-muerte epísodico es un proceso en el cual las tasas de diversificación varían epísodicamente a lo largo del tiempo y se modelan como tasas constantes por intervalos de tiempo (Stadler 2011; Höhna 2015). Siguiendo el tutorial oficial Episodic Diversification Rate Estimation.\nAsumimos que las tasas transformadas logarítmicamente siguen una distribución previa de campo aleatorio de Markov en forma de herradura (Horseshoe Markov random field, HSMRF) según Magee et al. (2020).\n\nTasas transformadas logarítmicamente:\n\nEn muchos modelos evolutivos, las tasas de especiación y extinción pueden variar en órdenes de magnitud.\nPara modelar mejor estos cambios, se toma el logaritmo de las tasas en lugar de usarlas directamente.\nEsto ayuda a evitar valores negativos y hace que la distribución de las tasas sea más manejable.\n\nDistribución previa (prior) de campo aleatorio de Markov en forma de herradura (HSMRF):\n\nDistribución previa (prior): En un enfoque bayesiano, los parámetros desconocidos (como las tasas de especiación/extinción) tienen distribuciones previas que reflejan nuestras creencias antes de ver los datos.\nCampo aleatorio de Markov (Markov Random Field, MRF): Este término indica que las tasas en un intervalo de tiempo dependen de las tasas en el intervalo anterior. En otras palabras, las tasas están autocorrelacionadas temporalmente.\nForma de herradura (Horseshoe): Es un tipo de distribución previa diseñada para manejar datos donde algunos valores pueden ser cercanos a cero (relativamente constantes), pero también permite valores extremos (cambios bruscos en las tasas).\n¿Por qué se usa? El HSMRF permite capturar patrones donde las tasas cambian lentamente la mayor parte del tiempo, pero ocasionalmente pueden dar saltos grandes, lo cual es biológicamente realista en muchos sistemas evolutivos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 2</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#lectura-del-árbol",
    "href": "chapters/u1_intro_diversification_2.html#lectura-del-árbol",
    "title": "Introducción al proceso de diversificación parte 2",
    "section": "Lectura del árbol",
    "text": "Lectura del árbol\nComenzamos cargando el árbol filogenético previamente filtrado.\n# Cargar el árbol filogenético desde un archivo en formato NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Extraer la información taxonómica del árbol\n taxa &lt;- T.taxa()\nDefinir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()\nDefinir el número de intervalos en los que dividiremos el tiempo para modelar la diversificación.\nNUM_INTERVALS = 10  # Número total de intervalos de tiempo\nNUM_BREAKS := NUM_INTERVALS - 1  # Número de puntos de cambio entre intervalos\n\n\n\n\n\n\n\n\n\nDefinimos distribuciones previas sobre las tasas dentro del modelo HSMRF de nacimiento-muerte. Parámetros globales de escala\n# Hiperprior para controlar la variabilidad global de las tasas de especiación y extinción\nspeciation_global_scale_hyperprior &lt;- 0.044\nextinction_global_scale_hyperprior &lt;- 0.044\nEstos hiperpriors controlan la variabilidad global de las tasas de especiación y extinción:\n\nUn valor mayor permite más cambios abruptos entre intervalos.\nUn valor menor suaviza las tasas a lo largo del tiempo.\n\nFunción setMRFGlobalScaleHyperpriorNShifts() del paquete RevGadgets en R para calcular el hiperprior automáticamente.\n\n### Ejecutar en R, no agregar a RevBayes!!!\n### Calcula el hiperprior que utilizaremos en RevBayes\nlibrary(RevGadgets)\n## 10 numero intervalos\n## \"HSMRF\" Horseshoe Markov random field \nsetMRFGlobalScaleHyperpriorNShifts(10, \"HSMRF\")\n\n[1] 0.04446432\n\n\nAsignar distribuciones previas Half-Cauchy (dnHalfCauchy(0,1)) a los parámetros de escala global, permite valores pequeños pero también acepta valores más grandes ocasionalmente.\n# Distribuciones previas de Cauchy truncadas para los parámetros de escala global\nspeciation_global_scale ~ dnHalfCauchy(0,1)\nextinction_global_scale ~ dnHalfCauchy(0,1)\nEn esta sección se definen las tasas iniciales de especiación y extinción en el modelo HSMRF. En este enfoque, comenzamos con la tasa de especiación y extinción en el presente y luego modelamos cómo cambian hacia el pasado.\n# Definir tasas iniciales de especiación y extinción en el presente\nlog_speciation_at_present ~ dnUniform(-10.0,10.0)\nlog_speciation_at_present.setValue(0.0)\nlog_extinction_at_present ~ dnUniform(-10.0,10.0)\nlog_extinction_at_present.setValue(-1.0)\n\n¿Por qué se usa dnUniform(-10.0,10.0)?\nSe establece una distribución uniforme como prior para las tasas iniciales de especiación y extinción.\n\nComo estamos modelando las tasas en escala logarítmica, esto implica que los valores de especiación/extinción reales estarán entre:\n\n(e^{-10}) (casi 0, evolución extremadamente lenta)\n(e^{10}) (tasa de diversificación muy rápida)\n\nPermitir este rango amplio cubre la mayoría de los valores posibles sin asumir un conocimiento previo específico sobre la tasa de diversificación en el presente.\n\n\n\n¿Por qué los valores iniciales 0.0 y -1.0?\n\nlog_speciation_at_present.setValue(0.0): Equivale a establecer la tasa inicial de especiación en ( e^0 = 1.0 ), lo cual es un punto razonable para comenzar.\nlog_extinction_at_present.setValue(-1.0): Equivale a una tasa inicial de extinción de ( e^{-1}  approx 0.37 ), lo que implica que la extinción es menor que la especiación en el punto de partida.\n\nMovimientos eficientes en MCMC para explorar estas tasas\nmoves.append( mvScaleBactrian(log_speciation_at_present,weight=5))\nmoves.append( mvScaleBactrian(log_extinction_at_present,weight=5))\nEn el código de RevBayes para modelar la diversificación episódica, se utiliza un bucle for para definir los cambios en las tasas de especiación y extinción en cada intervalo de tiempo.\nfor (i in 1:NUM_BREAKS) {\n  # Variabilidad local en cada intervalo\n  sigma_speciation[i] ~ dnHalfCauchy(0,1)\n  sigma_extinction[i] ~ dnHalfCauchy(0,1)\n\n  # Se inicializan valores aleatorios en un rango de 0.005 a 0.1, para evitar valores extremos en el inicio del MCMC\n  sigma_speciation[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_extinction[i].setValue(runif(1,0.005,0.1)[1])\n\n  # Especificar los cambios en log-especiación y log-extinción mediante una distribución normal\n  delta_log_speciation[i] ~ dnNormal( mean=0, sd=sigma_speciation[i]*speciation_global_scale*speciation_global_scale_hyperprior )\n  delta_log_extinction[i] ~ dnNormal( mean=0, sd=sigma_extinction[i]*extinction_global_scale*extinction_global_scale_hyperprior )\n}\nCalcular las tasas de especiación y extinción a lo largo del tiempo a partir de los cambios en log-escala.\nspeciation := fnassembleContinuousMRF(log_speciation_at_present, delta_log_speciation, initialValueIsLogScale=TRUE, order=1)\nextinction := fnassembleContinuousMRF(log_extinction_at_present, delta_log_extinction, initialValueIsLogScale=TRUE, order=1)\nMovimientos de MCMC para el Modelo HSMRF\n# Movimiento para los cambios en log-escala de especiación y extinción\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_speciation, weight=5, tune=FALSE))\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_extinction, weight=5, tune=FALSE))\n\n# Movimiento Gibbs para los hiperparámetros globales y locales\nmoves.append(mvHSRFHyperpriorsGibbs(speciation_global_scale, sigma_speciation , delta_log_speciation , speciation_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\nmoves.append(mvHSRFHyperpriorsGibbs(extinction_global_scale, sigma_extinction , delta_log_extinction , extinction_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\n\n# Movimiento de intercambio entre intervalos adyacentes\nmoves.append(mvHSRFIntervalSwap(delta_log_speciation, sigma_speciation, weight=5))\nmoves.append(mvHSRFIntervalSwap(delta_log_extinction, sigma_extinction, weight=5))\nSe utilizan tres tipos principales de movimientos en este código:\n\nMuestreo Elíptico Slice (mvEllipticalSliceSamplingSimple)\n\nOptimiza la exploración de los cambios en log-escala de las tasas de especiación y extinción.\nFunciona bien en modelos con alta correlación entre parámetros.\n\nMuestreo Gibbs (mvHSRFHyperpriorsGibbs)\n\nSe usa para actualizar los hiperparámetros globales y locales del modelo.\nPermite ajustes eficientes en la escala de variabilidad de las tasas.\n\nIntercambio de intervalos (mvHSRFIntervalSwap)\n\nIntercambia valores entre intervalos de tiempo adyacentes.\nAyuda a evitar que la cadena de MCMC se quede atrapada en un estado subóptimo.\n\n\nConfiguración de los Intervalos de Tiempo\ninterval_times &lt;- abs(T.rootAge() * seq(1, NUM_BREAKS, 1)/NUM_INTERVALS)\n\nT.rootAge() → Obtiene la edad de la raíz del árbol filogenético (es decir, el tiempo en el pasado en que el linaje común más reciente existió).\nseq(1, NUM_BREAKS, 1) → Genera una secuencia de números del 1 al NUM_BREAKS (el número de puntos de cambio entre intervalos).\nMultiplica la raíz del árbol T.rootAge() por esta secuencia para escalar los intervalos al tiempo evolutivo real.\nDivide entre NUM_INTERVALS para normalizar y hacer que los intervalos sean de igual tamaño.\nabs(...) → Convierte los valores a positivos porque las edades van en dirección del presente al pasado.\n\nCorrección por Muestreo Incompleto\nrho &lt;- T.ntips()/26\nInicializando el Nodo Estocástico del Árbol de Tiempos\ntimetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)\nAsignando Datos Observados al Árbol\ntimetree.clamp(T)\nCreando el Modelo Completo, Encuentra todas las conexiones en la red bayesiana y las agrupa en un solo objeto model()\nmymodel = model(rho)\nConfiguración de los Monitores\nmonitors.append(mnModel(filename=\"../output/Eupomphini_EBD.log\", printgen=10, separator = TAB))\nCrea un monitor (mnModel) que guarda los valores de todos los parámetros del modelo.\n✔ Guarda los resultados en el archivo \"output/primates_EBD.log\".\n✔ printgen=10 → Especifica que se guardará un estado cada 10 generaciones.\n✔ separator=TAB → Usa tabulaciones para separar los valores en el archivo de salida.\nCreación de Monitores para las Tasas de Especiación y Extinción\n# Tasas de especiación\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_rates.log\", printgen=10, separator = TAB, speciation))\n\n# Intervalos de tiempo de especiación\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_times.log\", printgen=10, separator = TAB, interval_times))\n\n# Tasas de extinción\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_rates.log\", printgen=10, separator = TAB, extinction))\n\n#Intervalos de tiempo de extinción\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_times.log\", printgen=10, separator = TAB, interval_times))\nCreación de un Monitor en Pantalla\nmonitors.append(mnScreen(printgen=1000, extinction_global_scale, speciation_global_scale))\nConfiguración del MCMC\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\nCrea el objeto MCMC mymcmc que utilizará:\n\nmymodel → El modelo definido anteriormente.\nmonitors → Los monitores configurados.\nmoves → Los movimientos de MCMC definidos antes.\nnruns=2 → Ejecuta dos cadenas independientes de MCMC.\ncombine=\"mixed\" → Mezcla las cadenas al final del proceso para mejorar la estimación de parámetros.\n\nEjecutar el MCMC\nmymcmc.run(generations=50000, tuningInterval=200)\nVisualización de las tasas de diversificación\nFinalmente, generamos un gráfico que muestra cómo las tasas de especiación y extinción han cambiado a lo largo del tiempo.\n\nlibrary(RevGadgets)\n\n# Especificar la ruta de los archivos de salida \nspeciation_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_times.log\"\nspeciation_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_rates.log\"\nextinction_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_times.log\"\nextinction_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_rates.log\"\n\n# Leer y procesar los datos\nrates &lt;- processDivRates(speciation_time_log = speciation_time_file,\n                         speciation_rate_log = speciation_rate_file,\n                         extinction_time_log = extinction_time_file,\n                         extinction_rate_log = extinction_rate_file,\n                         burnin = 0.25, # Se descarta el 25% inicial de las iteraciones como burn-in\n                         summary = \"median\")  # Se toman las tasas medianas como resumen\n\n# Graficar las tasas atravez del tiempo\np &lt;- plotDivRates(rates = rates) +\n  xlab(\"Millions of years ago\") +\n  ylab(\"Rate per million years\")\n\np",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Introducción al proceso de diversificación parte 2</span>"
    ]
  }
]