[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Patrones filogenéticos: macroevolución y adaptación",
    "section": "",
    "text": "Presentación del Curso: Patrones Filogenéticos, Macroevolución y Adaptación\nHaz clic en la imagen para ver el PDF de la presentación del curso",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "index.html#unidad-1-patrones-de-diversificación",
    "href": "index.html#unidad-1-patrones-de-diversificación",
    "title": "Patrones filogenéticos: macroevolución y adaptación",
    "section": "Unidad 1: Patrones de diversificación",
    "text": "Unidad 1: Patrones de diversificación\n\nIntroducción al proceso de diversificación\nModelos con cambios en las Tasas de diversificación\nEstimación de Eventos de Extinción Masiva\nIntroducción a modelos State Speciaction-Extinción (SSE)",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Inicio</span>"
    ]
  },
  {
    "objectID": "chapters/install.html",
    "href": "chapters/install.html",
    "title": "Instalación de Software",
    "section": "",
    "text": "Introducción\nEste es el manual para la instalación de los programas que se utilizarán durante el curso Patrones filogenéticos: macroevolución y adaptación. Los programas seleccionados son herramientas esenciales para el desarrollo de análisis y actividades dentro del curso.\nLos programas a instalar incluyen:\nA continuación, se presentan las instrucciones detalladas para instalar y configurar cada uno de estos programas, asegurando que los participantes cuenten con todas las herramientas necesarias para aprovechar al máximo el curso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción",
    "href": "chapters/install.html#descripción",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nVisual Studio Code (VS Code) es un editor de código fuente ligero pero potente, desarrollado por Microsoft. Es compatible con varios lenguajes de programación y ofrece características como autocompletado de código, depuración integrada, control de versiones con Git y una amplia variedad de extensiones que permiten personalizar y ampliar su funcionalidad.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalación",
    "href": "chapters/install.html#pasos-de-instalación",
    "title": "Instalación de Software",
    "section": "Pasos de instalación",
    "text": "Pasos de instalación\n\nDescargar el instalador:\n\nVe al sitio oficial de Visual Studio Code: https://code.visualstudio.com/.\nHaz clic en el botón para descargar el archivo ejecutable.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado (por lo general, estará en la carpeta Descargas).\nHaz doble clic en el archivo para iniciar el asistente de instalación.\n\nConfigurar las opciones de instalación:\n\nAcepta los términos y condiciones.\nElige una carpeta de instalación o deja la predeterminada.\nSelecciona las opciones adicionales como:\n\nCrear un ícono en el escritorio.\nAgregar “Code” al menú contextual para abrir archivos y carpetas.\nRegistrar el programa como editor por defecto de ciertos archivos.\n\n\nCompletar la instalación:\n\nHaz clic en “Instalar”.\nEspera a que el proceso finalice y haz clic en “Finalizar” para abrir Visual Studio Code.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción-1",
    "href": "chapters/install.html#descripción-1",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nR es un lenguaje de programación y software para el análisis estadístico y la visualización de datos. RStudio es un entorno de desarrollo integrado (IDE) que facilita trabajar con R gracias a su interfaz amigable y herramientas adicionales como depuración de código, manejo de proyectos y soporte para Markdown.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#pasos-de-instalación-1",
    "href": "chapters/install.html#pasos-de-instalación-1",
    "title": "Instalación de Software",
    "section": "Pasos de instalación",
    "text": "Pasos de instalación\n\nInstalación de R\n\nDescargar el instalador:\n\nVe al sitio oficial de CRAN: https://cran.r-project.org/.\nSelecciona “Download R for Windows” y luego “base”.\nHaz clic en el enlace para descargar el instalador más reciente.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente, aceptando los valores predeterminados a menos que necesites personalizar la instalación.\n\nCompletar la instalación:\n\nHaz clic en “Finalizar” al terminar el proceso.\n\n\n\n\nInstalación de RStudio\n\nDescargar el instalador:\n\nVe al sitio oficial de RStudio: https://posit.co/download/rstudio-desktop/.\nDescarga la versión gratuita de RStudio Desktop.\n\nEjecutar el instalador:\n\nLocaliza el archivo descargado y haz doble clic para ejecutarlo.\nSigue las instrucciones del asistente de instalación.\n\nCompletar la instalación:\n\nHaz clic en “Finalizar” al terminar el proceso.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción-2",
    "href": "chapters/install.html#descripción-2",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nRevBayes es un software diseñado para realizar análisis filogenéticos avanzados utilizando métodos bayesianos. Ofrece flexibilidad para modelar procesos evolutivos complejos y es ampliamente utilizado en investigaciones de filogenética y macroevolución.\nPara instalar RevBayes en Windows, utilizaremos Ubuntu mediante Windows Subsystem for Linux (WSL).",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-la-virtualización-está-habilitada",
    "href": "chapters/install.html#verificar-si-la-virtualización-está-habilitada",
    "title": "Instalación de Software",
    "section": "1. Verificar si la virtualización está habilitada",
    "text": "1. Verificar si la virtualización está habilitada\n\nAbrir el Administrador de Tareas:\n\nPresiona Ctrl + Shift + Esc para abrir el Administrador de Tareas.\nVe a la pestaña Rendimiento y selecciona CPU.\nEn la esquina inferior derecha, verifica si la opción “Virtualización” está habilitada.\n\n\n\n\n\n\nHabilitar la virtualización (si está deshabilitada):\n\nReinicia tu computadora y accede al BIOS/UEFI.\nPara procesadores Intel, busca una opción como “Intel Virtualization Technology” o “VT-x” y actívala.\nPara procesadores AMD, busca “SVM Mode” o una opción similar y actívala.\nGuarda los cambios y reinicia.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#verificar-si-wsl-está-instalado-y-actualizado",
    "href": "chapters/install.html#verificar-si-wsl-está-instalado-y-actualizado",
    "title": "Instalación de Software",
    "section": "2. Verificar si WSL está instalado y actualizado",
    "text": "2. Verificar si WSL está instalado y actualizado\n\nAbrir PowerShell como administrador\n\nPresiona Win + X y selecciona “Windows PowerShell (Admin)”.\nEjecuta el siguiente comando para verificar si WSL está instalado y funcionando:\nwsl --status\nSi el comando muestra un error o indica que WSL no está disponible, sigue el Paso 3 para instalarlo desde cero.\nSi WSL ya está habilitado, pasa al Paso 4 para actualizarlo y asegurarte de que esté en la versión 2.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-wsl-desde-cero-si-no-está-disponible",
    "href": "chapters/install.html#instalar-wsl-desde-cero-si-no-está-disponible",
    "title": "Instalación de Software",
    "section": "3. Instalar WSL desde cero (si no está disponible)",
    "text": "3. Instalar WSL desde cero (si no está disponible)\nSi wsl --status muestra un error, sigue estos pasos para habilitar WSL desde cero:\n\nAbrir PowerShell como administrador y ejecutar los siguientes comandos:\ndism.exe /online /enable-feature /featurename:Microsoft-Windows-Subsystem-Linux /all /norestart\ndism.exe /online /enable-feature /featurename:VirtualMachinePlatform /all /norestart\nReiniciar la computadora para aplicar los cambios.\nVerificar la instalación:\n\nEjecuta nuevamente:\nwsl --status\nSi el comando muestra que WSL está instalado correctamente puedes proceder con el paso 4.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#actualizar-wsl-y-establecer-la-versión-por-defecto",
    "href": "chapters/install.html#actualizar-wsl-y-establecer-la-versión-por-defecto",
    "title": "Instalación de Software",
    "section": "4. Actualizar WSL y establecer la versión por defecto",
    "text": "4. Actualizar WSL y establecer la versión por defecto\nSi WSL ya estaba habilitado, sigue estos pasos para actualizarlo y asegurarte de que esté en la versión 2:\n\nActualizar el kernel de WSL 2 (en caso de que se necesite)\n\nDescarga la actualización oficial desde Microsoft: Descargar actualización de WSL-2\nGuarda el archivo wsl_update_x64.msi en tu computadora.\nEjecuta el archivo descargado y sigue las instrucciones de instalación.\nUna vez instalado, reinicia tu computadora.\n\nConfigurar WSL para usar la versión 2\n\nAbre PowerShell como administrador y ejecuta:\nwsl --set-default-version 2\nEsto asegurará que todas las distribuciones nuevas de Linux usen WSL 2 por defecto.\n\nInstalación de Ubuntu:\n\nUna vez reiniciado el equipo, abre PowerShell como administrador y ejecuta:\nwsl --install -d Ubuntu\nEsto instalará automáticamente WSL2 y descargará la distribución de Ubuntu más reciente,\nEn caso de que no se instale, descarga Ubuntu (se recomienda la versión 22.04) desde la aplicación de Microsoft Store e instálala manualmente.\n\nEstablecer el usuario por defecto en WSL\n\nAsegúrate de que WSL esté configurado para que siempre uses tu usuario por defecto y no root:\nwsl -d Ubuntu --user tu_usuario\nSi no recuerdas que verion de Ubuntu tines instalada, usa:\nwsl -l -v\nSi no recuerdas tu usuario en WSL, usa:\nwhoami\n\nConfigurar Ubuntu:\n\nAbre Ubuntu desde el menú de inicio.\nCrea un nombre de usuario y contraseña cuando se te solicite.\n\n\n\n\n\n\nAcceder a la carpeta de usuario de Windows:\n\nVerifica si la ruta existe:\n\nls \"/mnt/c/Users/\"\n\nVerifica tu nombre de usuario:\n\nls \"/mnt/c/Users/mi_usuario\"\n\nCrear un alias en ~/.bashrc:\n\nnano ~/.bashrc\n\nAgrega esta línea al final del archivo:\n\nalias homepatron='cd \"/mnt/c/Users/mi_usuario\"'\n\nGuarda (CTRL + X, luego Y y Enter) y actualiza:\n\nsource ~/.bashrc\n\nAhora podrás ejecutar:\n\nhomepatron",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "href": "chapters/install.html#instalar-revbayes-en-ubuntu",
    "title": "Instalación de Software",
    "section": "Instalar RevBayes en Ubuntu",
    "text": "Instalar RevBayes en Ubuntu\n\nActualizar paquetes:\n\nEjecuta:\nsudo apt update && sudo apt upgrade -y\n\nDescargar RevBayes:\n\nUsa el siguiente comando para descargar la versión 1.2.5:\nwget https://github.com/revbayes/revbayes/releases/download/v1.2.5/revbayes-v1.2.5-linux64.tar.gz\n\nInstalar RevBayes:\n\nExtrae el archivo descargado y navega a la carpeta:\ntar -xzf revbayes-v1.2.5-linux64.tar.gz\ncd revbayes-v1.2.5/bin\nHaz que el ejecutable sea ejecutable:\nchmod +x rb\n\nAgregar RevBayes al PATH:\n\nPara que rb esté disponible en cualquier sesión de Ubuntu, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/revbayes-v1.2.5/bin:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto permitirá ejecutar rb desde cualquier directorio en futuras sesiones de terminal.\n\nVerificar la instalación:\n\nEjecuta el programa:\nrb\nDeberías ver la interfaz de línea de comandos de RevBayes.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#descripción-3",
    "href": "chapters/install.html#descripción-3",
    "title": "Instalación de Software",
    "section": "Descripción",
    "text": "Descripción\nBAMM es un software diseñado para analizar tasas de diversificación y evolución de rasgos en filogenias de gran tamaño. Utiliza métodos bayesianos para estimar patrones heterogéneos de evolución y es ampliamente utilizado en estudios de macroevolución.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/install.html#instalación-de-bamm-en-ubuntu-wsl-o-nativo",
    "href": "chapters/install.html#instalación-de-bamm-en-ubuntu-wsl-o-nativo",
    "title": "Instalación de Software",
    "section": "Instalación de BAMM en Ubuntu (WSL o nativo)",
    "text": "Instalación de BAMM en Ubuntu (WSL o nativo)\n\nActualizar el sistema y dependencias:\n\nEjecuta los siguientes comandos para asegurarte de que el sistema esté actualizado y las dependencias necesarias estén instaladas:\nsudo apt update && sudo apt upgrade -y\nsudo apt install git build-essential cmake libgsl-dev -y\n\nClonar el repositorio de BAMM:\n\nClona el repositorio oficial de BAMM desde GitHub:\ngit clone https://github.com/macroevolution/bamm.git\n\nCrear el directorio de compilación:\n\nNavega al directorio raíz del proyecto, crea un directorio llamado build y accede a él:\ncd bamm\nmkdir build\ncd build\n\nCompilar BAMM:\n\nEjecuta los siguientes comandos para compilar BAMM:\ncmake ..\nmake -j\nEl ejecutable final se generará con el nombre bamm dentro del directorio build.\n\nAgregar BAMM al PATH:\n\nPara que el ejecutable bamm esté disponible desde cualquier directorio, agrega su ruta al archivo ~/.bashrc:\necho 'export PATH=\"$HOME/bamm/build:$PATH\"' &gt;&gt; ~/.bashrc\nsource ~/.bashrc\nEsto asegurará que puedas ejecutar bamm desde cualquier lugar en futuras sesiones.\n\nVerificar la instalación:\n\nAsegúrate de que BAMM esté correctamente instalado ejecutando:\nbamm -h\nDeberías ver la pantalla de ayuda de BAMM.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Instalación de Software</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html",
    "href": "chapters/commandline.html",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "",
    "text": "Comandos básicos en Bash",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#navegación-en-el-sistema-de-archivos",
    "href": "chapters/commandline.html#navegación-en-el-sistema-de-archivos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "1. Navegación en el sistema de archivos",
    "text": "1. Navegación en el sistema de archivos\n\n\n\n\n\n\npwd → Muestra el directorio actual.\npwd\nls → Lista los archivos y carpetas en el directorio actual.\nls -l     # Muestra detalles (permisos, dueño, tamaño, fecha)\nls -a     # Muestra archivos ocultos\nls -h     # Muestra tamaños en formato legible \ncd → Cambia de directorio.\ncd /   # Ir a la raiz\ncd /home/usuario/proyecto/data # ir a la carpeta data ruta absoluta\ncd data/ # ir a la carpeta data ruta relativa\ncd ..      # Subir un nivel",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#manipulación-de-archivos-y-directorios",
    "href": "chapters/commandline.html#manipulación-de-archivos-y-directorios",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "2. Manipulación de archivos y directorios",
    "text": "2. Manipulación de archivos y directorios\n\nmkdir → Crea un directorio.\nmkdir nueva_carpeta\nrm → Borra archivos y carpetas.\nrm archivo.txt        # Borra un archivo\nrm -r carpeta         # Borra una carpeta y su contenido\nrm -i archivo.txt     # Pregunta antes de borrar\ncp → Copia archivos o carpetas.\ncp archivo.txt copia.txt   # Copia un archivo\ncp -r carpeta destino/     # Copia una carpeta\nmv → Mueve o renombra archivos y carpetas.\nmv archivo.txt nueva_ubicacion/\nmv archivo.txt nuevo_nombre.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#visualización-y-edición-de-archivos",
    "href": "chapters/commandline.html#visualización-y-edición-de-archivos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "3. Visualización y edición de archivos",
    "text": "3. Visualización y edición de archivos\n\ncat → Muestra el contenido de un archivo.\ncat archivo.txt\nless → Permite visualizar archivos grandes de manera interactiva.\nless archivo.txt   # Usa las teclas ↑ ↓ para moverte, \"q\" para salir\nnano → Editor de texto en terminal.\nnano archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#limpiar-la-terminal",
    "href": "chapters/commandline.html#limpiar-la-terminal",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "4. Limpiar la terminal",
    "text": "4. Limpiar la terminal\n\nclear → Borra la pantalla de la terminal, pero no elimina procesos ni historial.\nclear\nCtrl + L → Hace lo mismo que clear, pero sin ejecutar un comando explícito.\n\nEn macOS: Cmd + K también limpia la terminal.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#historial-de-comandos",
    "href": "chapters/commandline.html#historial-de-comandos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "5. Historial de comandos",
    "text": "5. Historial de comandos\n\nCómo moverse en el historial\n\n↑ (Flecha arriba) → Muestra el último comando ejecutado.\n↓ (Flecha abajo) → Avanza en la lista de comandos previos.\nCtrl + R → Búsqueda rápida en el historial. Escribe parte del comando y pulsa Enter cuando encuentres el que necesitas.\n\nEjemplo: Presiona Ctrl + R y escribe nano, mostrará el último comando que usaste con nano.\n\n\nhistory → Muestra los últimos comandos ejecutados.\nhistory\nBuscar en el historial rápidamente con grep\nhistory | grep ls   # Filtra los comandos que contienen \"ls\"\nhistory | grep nano # Filtra los comandos con \"nano\"",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "href": "chapters/commandline.html#permisos-y-propiedades-de-archivos",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "6. Permisos y propiedades de archivos",
    "text": "6. Permisos y propiedades de archivos\n\nchmod → Cambia permisos de ejecucion.\nchmod +x script.Rev  # Permisos de ejecución\nchown → Cambia el dueño de un archivo.\nsudo chown usuario archivo.txt",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "href": "chapters/commandline.html#iniciar-ubuntu-en-la-terminal-de-vs-code.",
    "title": "Apuntes sobre comandos básicos en Bash",
    "section": "Iniciar Ubuntu en la terminal de VS Code.",
    "text": "Iniciar Ubuntu en la terminal de VS Code.\n\nAbre VS Code y ve a Extensions (Ctrl + Shift + X)\n\n\n\n\n\nBusca WSL e instala la extensión oficial de Microsoft.\n\n\n\n\n\nTeclea el comando Ctrl + Shift + P y selecciona WSL: Connect to WSL\n\n\n\n\n\nSe abrirá una nueva ventana, ve a **Terminal** y selecciona una nueva **Terminal**\n\n\n\n\n\nEn la parte inferior se abrirá la terminal de Ubuntu",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Apuntes sobre comandos básicos en Bash</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html",
    "href": "chapters/Rstudio.html",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "¿Qué es R y qué es RStudio?",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#qué-es-r-y-qué-es-rstudio",
    "href": "chapters/Rstudio.html#qué-es-r-y-qué-es-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "",
    "text": "R es un lenguaje de programación enfocado en el análisis de datos y estadísticas.\nRStudio es un entorno de desarrollo integrado (IDE) que facilita el trabajo con R y permite organiza los proyectos y facilita la ejecución de código, la visualización de gráficos y la gestión de paquetes.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#partes-de-rstudio",
    "href": "chapters/Rstudio.html#partes-de-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Partes de RStudio",
    "text": "Partes de RStudio\nRStudio tiene cuatro paneles principales:\n\nConsole: Donde se ejecuta el código en tiempo real.\n\n\n\n\n\nEditor de scripts: Para escribir y guardar código en archivos .r, .R o .Rmd.\n\n\n\n\n\nEnvironment/History: Muestra variables y comandos previos.\n\n\n\n\n\nFiles/Plots/Packages/Help: Para manejar archivos, visualizar gráficos, instalar programas y acceder a documentación.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#creación-de-un-proyecto-en-rstudio",
    "href": "chapters/Rstudio.html#creación-de-un-proyecto-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Creación de un Proyecto en RStudio",
    "text": "Creación de un Proyecto en RStudio\nBeneficios de trabajar con proyectos:\n\nOrganización de archivos y código.\nFacilita la reproducibilidad.\nEvita problemas con rutas de archivos.\n\nPara crear un proyecto:\n\nEn RStudio, ir a File &gt; New Project.\n\n\n\n\n\nElegir un directorio nuevo o existente.\n\n\n\n\n\nTrabajar siempre dentro del proyecto para evitar problemas de rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#organización-de-proyectos-en-rstudio",
    "href": "chapters/Rstudio.html#organización-de-proyectos-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Organización de Proyectos en RStudio",
    "text": "Organización de Proyectos en RStudio\nMantener una estructura organizada en los proyectos es clave para la reproducibilidad y eficiencia. Se recomienda la siguiente estructura de carpetas:\nproyecto/\n│── data/         # Datos crudos y procesados\n│── scripts/      # Código fuente en R\n│── output/       # Resultados y gráficos\n│── reports/      # Documentación y reportes\n│── README.md     # Descripción del proyecto\nAdemás, para lograr una nomenclatura eficiente y consistente en archivos, se pueden seguir algunas pautas:\n\nConsistencia: Usar un esquema de nombres consistente en todo el proyecto.\nEvitar Espacios: Usar guiones bajos (_) o guiones (-) en lugar de espacios.\nPrefijos y Sufijos: Usar prefijos y sufijos estandarizados para identificar el estado o versión del archivo.\nEvitar Acentos y Caracteres Especiales: No utilizar acentos, eñes ni caracteres especiales que puedan causar problemas de compatibilidad en diferentes sistemas operativos o herramientas de software.\n\nEjemplos:\nbears_cytb.nex\ntree_BD.Rev\nmultifig.R\nqw_feature2.csv",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "href": "chapters/Rstudio.html#rutas-absolutas-y-relativas",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Rutas Absolutas y Relativas",
    "text": "Rutas Absolutas y Relativas\nLas rutas de archivos en R pueden ser absolutas o relativas:\n\nRuta absoluta: Define la ubicación exacta de un archivo, por ejemplo:\nread.csv(\"C:/Users/TuUsuario/Documents/data/datos.csv\")\nRuta relativa: Se basa en la ubicación del proyecto:\nread.csv(\"data/datos.csv\")\n\nSiempre es recomendable usar proyectos para evitar errores con rutas.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#principales-objetos-en-r",
    "href": "chapters/Rstudio.html#principales-objetos-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Principales Objetos en R",
    "text": "Principales Objetos en R\n\nVectores\nx &lt;- c(1, 2, 3, 4, 5)\nprint(x)\n\n\nMatrices\nm &lt;- matrix(1:9, nrow=3)\nprint(m)\n\n\nData Frames\ndf &lt;- data.frame(Nombre=c(\"A\", \"B\", \"C\"), Edad=c(25, 30, 22))\nprint(df)\n\n\nListas\nlista &lt;- list(Nombre=\"Juan\", Edad=30, Notas=c(8, 9, 10))\nprint(lista)",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#asignación-de-variables",
    "href": "chapters/Rstudio.html#asignación-de-variables",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Asignación de Variables",
    "text": "Asignación de Variables\nDiferencia entre &lt;- y =:\na &lt;- 10   # Recomendado para asignaciones\nb = 20    # También funciona, pero es mejor evitarlo",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "href": "chapters/Rstudio.html#uso-de-funciones-en-r",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Uso de Funciones en R",
    "text": "Uso de Funciones en R\nEjemplo de funciones básicas:\nnumeros &lt;- c(1, 2, 3, 4, 5)\nmean(numeros)  # Media\nsummary(numeros)  # Resumen estadístico",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#instalación-y-uso-de-paquetes",
    "href": "chapters/Rstudio.html#instalación-y-uso-de-paquetes",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Instalación y Uso de Paquetes",
    "text": "Instalación y Uso de Paquetes\ninstall.packages(\"ggplot2\")\nlibrary(ggplot2)\nhelp(ggplot2)  # Consultar documentación",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "href": "chapters/Rstudio.html#acceder-a-los-archivos-de-ubuntu-en-rstudio",
    "title": "Apuntes sobre R y Rstudio",
    "section": "Acceder a los archivos de Ubuntu en RStudio",
    "text": "Acceder a los archivos de Ubuntu en RStudio\n\nEjecuta el siguiente comando en PowerShell:\nwsl.exe wslpath -w ~\nMostrará una dirección como la que se muestra:\n\\\\wsl.localhost\\Ubuntu\\home\\tu_usuario\nEn RStudio puedes establecer el directorio de trabajo en la carpeta de Ubuntu (WSL) usando setwd(). Ten cuidado en las diuagonales, en powershell las diagonales son invertidas * y cuando las utilices en R utiliza las diagonales normales /*:\nsetwd(\"//wsl.localhost/Ubuntu/home/tu_usuario/mi_proyecto\")",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Apuntes sobre R y Rstudio</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html",
    "href": "chapters/revbayes.html",
    "title": "Apuntes sobre RevBayes",
    "section": "",
    "text": "Introducción a la Inferencia Bayesiana\nLa inferencia bayesiana es un enfoque de la estadística que permite actualizar nuestras creencias sobre un parámetro desconocido a medida que obtenemos nueva información. Se basa en el Teorema de Bayes, que nos dice cómo combinar la información previa con la evidencia observada.\nEl Teorema de Bayes se expresa matemáticamente como:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nEl objetivo de la inferencia bayesiana es calcular la distribución posterior, que nos proporciona una estimación más precisa del parámetro \\(\\theta\\) al incorporar tanto datos como conocimiento previo.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#por-qué-se-necesita-mcmc",
    "href": "chapters/revbayes.html#por-qué-se-necesita-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¿Por qué se necesita MCMC?",
    "text": "¿Por qué se necesita MCMC?\nEn inferencia bayesiana, la distribución posterior de un parámetro \\(\\theta\\) se calcula usando:\n\\[\nP(\\theta | D) = \\frac{P(D | \\theta) P(\\theta)}{P(D)}\n\\]\nPero en la práctica, el denominador \\(P(D)\\) es difícil de calcular, ya que requiere integrar sobre todos los valores posibles de \\(\\theta\\):\n\\[\nP(D) = \\int P(D | \\theta) P(\\theta) d\\theta\n\\]\nCuando el espacio de parámetros es muy grande, esta integral es imposible de resolver analíticamente. MCMC nos ayuda a aproximar la distribución posterior sin necesidad de calcular \\(P(D)\\).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#cómo-funciona-mcmc",
    "href": "chapters/revbayes.html#cómo-funciona-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "¿Cómo funciona MCMC?",
    "text": "¿Cómo funciona MCMC?\nMCMC simula valores de los parámetros siguiendo estos pasos:\n\nEmpieza en un valor inicial .\nPropone un nuevo valor basado en una distribución de transición.\nDecide si acepta o rechaza según la regla de aceptación.\nRepite el proceso muchas veces para construir una cadena de valores que sigan la distribución posterior.\n\n🔹 Importante:\nCon suficientes iteraciones, la cadena converge a la distribución posterior, permitiendo estimar parámetros de manera precisa.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#métodos-populares-de-mcmc",
    "href": "chapters/revbayes.html#métodos-populares-de-mcmc",
    "title": "Apuntes sobre RevBayes",
    "section": "Métodos populares de MCMC",
    "text": "Métodos populares de MCMC\nExisten varias formas de implementar MCMC. Las más comunes son:\n✅ 1. Algoritmo de Metropolis-Hastings\n\nPropone un nuevo valor \\(\\theta^*\\).\nDecide si lo acepta o no comparando la razón de aceptación:\n\\[\nr = \\frac{P(D | \\theta^*) P(\\theta^*)}{P(D | \\theta) P(\\theta)}\n\\]\n\nSi \\(r \\geq 1\\), acepta \\(\\theta^*\\).\nSi \\(r &lt; 1\\), acepta \\(\\theta^*\\) con probabilidad \\(r\\).\n\n\nSe usa cuando no se conoce la forma exacta de la distribución posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#cómo-saber-si-una-cadena-ha-convergido",
    "href": "chapters/revbayes.html#cómo-saber-si-una-cadena-ha-convergido",
    "title": "Apuntes sobre RevBayes",
    "section": "¿Cómo saber si una cadena ha convergido?",
    "text": "¿Cómo saber si una cadena ha convergido?\n\n\n\n\n\nAlgunas técnicas comunes para evaluar la convergencia incluyen:\n\nInspección visual de trazas: un gráfico de trazas muestra si la cadena ha alcanzado un comportamiento estable sin tendencias obvias.\nTamaño de muestra efectivo (Effective Sample Size, ESS): Dado que las muestras en MCMC están correlacionadas, el número real de muestras independientes es menor que el número total de iteraciones. El tamaño de muestra efectivo (ESS) estima cuántas muestras independientes equivalentes hay en la cadena.\n\nSe calcula como:\n\\[\nESS = \\frac{N}{1 + 2 \\sum \\rho_k}\n\\]\nDonde \\(N\\) es el número total de iteraciones y \\(\\rho_k\\) es la autocorrelación en el retraso \\(k\\). Un ESS alto (\\(ESS &gt; 200\\)) indica que la cadena ha explorado bien el espacio de parámetros y proporciona estimaciones confiables.\nUn ESS bajo sugiere que las muestras están altamente correlacionadas y que se necesitan más iteraciones o una mejor parametrización del algoritmo para obtener estimaciones más precisas.\nPara visualizar estos valores y generar gráficos, se puede utilizar Tracer, una herramienta que facilita el análisis de convergencia de cadenas MCMC. Se puede descargar en el siguiente enlace:\nTracer v1.7.2",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "href": "chapters/revbayes.html#tipos-de-nodos-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "Tipos de Nodos en RevBayes",
    "text": "Tipos de Nodos en RevBayes\n\n👉 Nodos Constantes\nSon valores fijos dentro del modelo. No tienen incertidumbre.\nn = 10  # Número de observaciones\n\n\n👉 Nodos Estocásticos\nRepresentan variables aleatorias con una distribución. Son los parámetros del modelo.\ntheta ~ dnBeta(2,2)  # Prior Beta(2,2)\nEn este caso, theta es una variable aleatoria con una distribución Beta.\n\n\n👉 Nodos Deterministas\nSon valores calculados a partir de otros nodos.\nmu := theta * n  # Media esperada\nAquí, mu se calcula a partir de theta y n.\n\n\n👉 Nodos Clamped (Observados)\nSe utilizan para fijar valores observados en el modelo.\nD ~ dnBinomial(n, theta)  # Modelo Binomial\nD.clamp(7)  # Observamos 7 éxitos\nEn este caso, D es una variable aleatoria Binomial, pero la fijamos en 7.\n\n\n👉 Nodos Plate\nLos plates se usan para repetir estructuras en modelos jerárquicos.\nfor (i in 1:10) {\n    theta[i] ~ dnBeta(2,2)\n}\nAquí, estamos creando 10 valores de theta, cada uno con una distribución Beta(2,2).",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "href": "chapters/revbayes.html#definiendo-el-modelo-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "🔹 1. Definiendo el Modelo en RevBayes",
    "text": "🔹 1. Definiendo el Modelo en RevBayes\n\n📌 Distribución Prior\nAntes de ver los datos, asumimos una creencia previa sobre la probabilidad ( p ).\nUtilizamos una distribución Beta(8,2), basada en la suposición de que aproximadamente el 80% de las personas disfrutarán del ambiente.\n\\[\np \\sim \\text{Beta}(8,2)\n\\]\nPágina para visualizar las distribuciones para RevBayes, pega el siguiente código en Rev code:\nx ~ dnBeta(8, 2)\nLa media de esta distribución es:\n\\[\nE[p] = \\frac{\\alpha}{\\alpha + \\beta} = \\frac{8}{8+2} = 0.8\n\\]\n\n\n\n📌 Verosimilitud (Likelihood)\nLa verosimilitud describe la probabilidad de observar los datos dados un valor específico de ( p ).\nComo cada estudiante puede estar satisfecho (éxito) o insatisfecho (fracaso), usamos una distribución Binomial:\n\\[\nk \\sim \\text{Binomial}(n = 10, p)\n\\]\nDonde: - ( k = 7 ) es el número de estudiantes satisfechos observados. - ( n = 10 ) es el número total de encuestados.\n\n\n\n📌 Posterior Bayesiana\nAplicamos el Teorema de Bayes:\n\\[\nP(p | D) \\propto P(D | p) P(p)\n\\]\nDado que usamos un prior Beta y una verosimilitud Binomial, la posterior también sigue una distribución Beta con parámetros actualizados:\n\\[\np | D \\sim \\text{Beta}(8+7, 2+3) = \\text{Beta}(15,5)\n\\]\nLa media de la posterior nos da la mejor estimación después de observar los datos:\n\\[\nE[p] = \\frac{15}{15 + 5} = 0.75\n\\]\nEsto significa que, después de observar que 7 de 10 estudiantes disfrutaron el ambiente, nuestra mejor estimación de la probabilidad de que tú disfrutes del ambiente es 75%.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#código-en-revbayes",
    "href": "chapters/revbayes.html#código-en-revbayes",
    "title": "Apuntes sobre RevBayes",
    "section": "🔹 2. Código en RevBayes",
    "text": "🔹 2. Código en RevBayes\nA continuación, presentamos el código en RevBayes para implementar este modelo y ejecutar un análisis MCMC.\n\n\n\n\n\n# ------------------------------------------------\n# RevBayes - Algoritmo de Metropolis-Hastings para estimar\n# la probabilidad de disfrutar el ambiente en las micheladas de Tepito\n# ------------------------------------------------\n\n# Datos observados\ntotal_clientes &lt;- 10  # Número total de encuestados\nsatisfechos &lt;- 7      # Número de estudiantes que disfrutaron el ambiente\n\n# Especificar la distribución prior\nalpha &lt;- 8   # Basado en la creencia previa de 80% satisfacción\nbeta  &lt;- 2   # Complemento del prior\np ~ dnBeta(alpha, beta)  # Prior Beta(8,2)\n\n# Definir la propuesta de MCMC con Metropolis-Hastings\nmoves[1] = mvSlide(p, delta=0.1, weight=1)  # Movimiento en la distribución de p\n\n# Especificar el modelo de verosimilitud (distribución Binomial)\nk ~ dnBinomial(p, total_clientes)\nk.clamp(satisfechos)  # Fijar la observación de 7 estudiantes satisfechos\n\n# Crear el modelo\nmy_model = model(p)\n\n# Definir monitores para el MCMC\nmonitors[1] = mnModel(filename=\"micheladas_MH.log\", printgen=10, separator = TAB)  # Guardar resultados\nmonitors[2] = mnScreen(printgen=100, p)  # Mostrar progreso cada 100 generaciones\n\n# Crear el análisis MCMC con Metropolis-Hastings\nanalysis = mcmc(my_model, monitors, moves)\n\n# Ejecutar el MCMC con 100,000 iteraciones\nanalysis.run(100000)\n\n# Mostrar el resumen de los operadores de MCMC\nanalysis.operatorSummary()",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/revbayes.html#mini-ejercicio",
    "href": "chapters/revbayes.html#mini-ejercicio",
    "title": "Apuntes sobre RevBayes",
    "section": "Mini-ejercicio",
    "text": "Mini-ejercicio\n\nCrea un script para RevBayes (.Rev) utilizando Visual Studio Code y copia el codigo.\nModifica el prior dnBeta(alpha, beta) con los valores que reflejen tu creencia sobre la probabilidad de satisfacción.\nGuarda el archivo micheladas_MH.log en la carpeta asiganada para guardar resultados.\nGuarda el script en la carpeta de scripts.\nEjecuta el análisis MCMC en RevBayes.\nVisualiza los resultados usando Tracer para observar la distribución posterior.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Apuntes sobre RevBayes</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html",
    "href": "chapters/u1_intro_diversification.html",
    "title": "Introducción al proceso de diversificación",
    "section": "",
    "text": "Presentación: Introducción al proceso de diversificación\nHaz clic en la imagen para ver el PDF de la presentación",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "href": "chapters/u1_intro_diversification.html#mediante-la-liberia-remotes",
    "title": "Introducción al proceso de diversificación",
    "section": "1.- Mediante la liberia remotes",
    "text": "1.- Mediante la liberia remotes\n\n# Instalar remotes si no está instalado\nif (!requireNamespace(\"remotes\", quietly = TRUE)) {\n  install.packages(\"remotes\")\n}\n\n# Instalar TreePar\nremotes::install_github(\"tanja819/TreePar\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "href": "chapters/u1_intro_diversification.html#descargar-el-paquete-treepar",
    "title": "Introducción al proceso de diversificación",
    "section": "2.- Descargar el paquete TreePar",
    "text": "2.- Descargar el paquete TreePar\n\nPuedes descargar el paquete desde el siguiente enlace:\n📥 Descargar TreePar 3.3\nGuarda el archivo en una carpeta de tu elección (por ejemplo, en ~/Descargas/ o C:/Users/TuUsuario/Downloads/).\n\n\n\nInstalar TreePar desde el archivo descargado\nUna vez que hayas descargado el archivo TreePar_3.3.tar.gz, abre R y ejecuta el siguiente código para instalarlo:\n# Definir la ruta donde se descargó el archivo\nruta_archivo &lt;- \"~/Descargas/TreePar_3.3.tar.gz\"  # Cambia esta ruta según tu sistema operativo\n\n# Instalar el paquete desde el archivo .tar.gz\ninstall.packages(ruta_archivo, repos = NULL, type = \"source\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#descarga-del-árbol-filogenético",
    "href": "chapters/u1_intro_diversification.html#descarga-del-árbol-filogenético",
    "title": "Introducción al proceso de diversificación",
    "section": "Descarga del Árbol Filogenético",
    "text": "Descarga del Árbol Filogenético\n📥 Puedes descargar el archivo NEXUS con el árbol de estudio en el siguiente enlace:\n📥 Descargar Árbol Filogenético\nGuarda el archivo en la carpeta correspondiente y verifica su ubicación antes de continuar.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-árbol-en-r",
    "href": "chapters/u1_intro_diversification.html#cargar-y-visualizar-el-árbol-en-r",
    "title": "Introducción al proceso de diversificación",
    "section": "Cargar y Visualizar el Árbol en R",
    "text": "Cargar y Visualizar el Árbol en R\nEjecuta el siguiente código en R para cargar el archivo y visualizar el árbol completo:\n\n# Cargar los paquetes necesarios\nlibrary(ape)\nlibrary(ggtree)\nlibrary(treeio)\nlibrary(tidyverse)\n\n# Definir la ruta del archivo NEXUS\narchivo_nexus &lt;- \"../docs/u1_PatDiv/allSamples.tre\"  # Asegúrate de cambiar esta ruta si es necesario\n\n# Cargar el árbol\narbol &lt;- read.nexus(archivo_nexus)\n\n# Calcular el Límite Máximo del Eje X\nmax_edge_length &lt;- max(arbol$edge.length, na.rm = TRUE)\n\n# Graficar el árbol\nggtree(arbol) +\n  geom_tiplab(size = 3) +\n  geom_text2(aes(subset = !isTip, label = node), hjust = -0.3) +  # Etiquetar nodos internos\n  xlim(-0.5, max_edge_length * 1.4) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-específico",
    "href": "chapters/u1_intro_diversification.html#extraer-los-nombres-de-las-terminales-de-un-nodo-específico",
    "title": "Introducción al proceso de diversificación",
    "section": "Extraer los nombres de las terminales de un nodo específico:",
    "text": "Extraer los nombres de las terminales de un nodo específico:\nUtilizar la función getDescendants para obtener los nombres de todas la terminales del nodo interno 61:\n\nlibrary(phytools)\n\nnodo_interes &lt;- 61  # Reemplaza este valor por el nodo de tu interés\n\n# Obtener los índices de los nodos descendientes\nnodos_internos &lt;- getDescendants(arbol, nodo_interes)\n\n# Filtrar solo los índices que corresponden a las terminales (tips)\nindices_tips &lt;- nodos_internos[nodos_internos &lt;= length(arbol$tip.label)]\n\n# Obtener los nombres de las terminales\nnombres_tips &lt;- arbol$tip.label[indices_tips]\n\n# Mostrar los nombres de las terminales\nprint(nombres_tips)\n\n [1] \"06166_50_120_Phod_marmorata\" \"KRN15_107_Phod_marmorata\"   \n [3] \"KRN52_Phod_alticeps\"         \"KRN10_118_Phod_alticeps\"    \n [5] \"KRN14_Phod_alticeps\"         \"KRN24_Cyste_armatus\"        \n [7] \"KRN02_Cyste_armatus\"         \"KRN25_Cyste_armatus\"        \n [9] \"KRN28_Cyste_wislizeni\"       \"KRN03_Cyste_wislizeni\"      \n[11] \"KRN26_Cyste_wislizeni\"       \"KRN100_101_Tegro_aloga\"     \n[13] \"KRN96_97_98_Tegro_aloga\"     \"KRN11_Tegro_erosa\"          \n[15] \"KRN12_Tegro_erosa\"           \"KRN13_Tegro_latecincta\"     \n[17] \"KRN53_Tegro_latecincta\"      \"KRN01_Cordy_opaca\"          \n[19] \"KRN112_Cordy_opaca\"          \"KRN111_Cordy_fulleri\"       \n[21] \"KRN23_Cordy_fulleri\"         \"KRN09_Mege_vittata\"         \n[23] \"KRN08_Mege_puncta\"           \"KRN07_133_Mege_cancell\"     \n[25] \"KRN129_Mege_cancell_h\"       \"KRN51_Pleu_reticulata\"      \n[27] \"KRN48_Pleu_mirabilis\"        \"KRN47_119_Pleu_mirabilis\"   \n[29] \"KRN49_Pleu_mirabilis\"        \"KRN19_Eup_sulciphrons\"      \n[31] \"KRN131_Eup_schwarzi\"         \"KRN88_89_Eup_histrionica\"   \n[33] \"KRN90_Eup_histrionica\"       \"KRN43_108_Eup_fissiceps\"    \n[35] \"KRN45_Eup_fissiceps\"         \"KRN44_Eup_fissiceps\"        \n[37] \"KRN54_121_Eup_fissiceps\"     \"KRN20_Eup_imperialis\"       \n[39] \"KRN06_Eup_imperialis\"        \"KRN42_Eup_imperialis\"       \n[41] \"KRN30_113_Eup_elegans\"       \"KRN38_115_Eup_elegans_p\"    \n[43] \"KRN29_Eup_elegans_p\"         \"KRN21_114_Eup_elegans_p\"    \n[45] \"KRN40_Eup_elegans_p\"         \"KRN92_93_Eup_edmundsi\"      \n[47] \"KRN18_135_Eup_viridis\"       \"KRN59_Eup_viridis\"",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-subárboles-filogenéticos",
    "href": "chapters/u1_intro_diversification.html#uso-de-getmrca-y-extract.clade-para-extraer-subárboles-filogenéticos",
    "title": "Introducción al proceso de diversificación",
    "section": "Uso de getMRCA y extract.clade para extraer Subárboles Filogenéticos",
    "text": "Uso de getMRCA y extract.clade para extraer Subárboles Filogenéticos\n\n# Obtener el nodo más reciente en común del ingroup\nmrca_ingroup &lt;- getMRCA(arbol, nombres_tips)\n\n# Extraer el subárbol del ingroup\nsubarbol &lt;- extract.clade(arbol, mrca_ingroup)\n\n# Calcular la longitud máxima de las ramas del subárbol\nmax_edge_length &lt;- max(subarbol$edge.length, na.rm = TRUE)\n\n# Graficar el subárbol\nggtree(subarbol) +\n  geom_tiplab(size = 3) +\n  xlim(-0.5, max_edge_length * 2) +\n  theme_tree2()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "href": "chapters/u1_intro_diversification.html#remover-especies-duplicadas",
    "title": "Introducción al proceso de diversificación",
    "section": "Remover especies duplicadas",
    "text": "Remover especies duplicadas\n\n# Separar los nombres de las especies (asumiendo el formato \"ID_Especie\")\nspecies_info &lt;- data.frame(\n  tip_label = nombres_tips,\n  species = str_extract(nombres_tips, \"[A-Za-z]+_[A-Za-z]+(?:_[A-Za-z]+)?$\")\n)\n\n# Eliminar las ssp _h y _p\n# Seleccionar solo una muestra por especie\nunique_species &lt;- species_info %&gt;%\n  filter(!str_detect(species, \"_[hp]$\")) %&gt;%\n  group_by(species) %&gt;% \n  slice(1) %&gt;%  # Selecciona solo la primera aparición de cada especie\n  ungroup()\n\n# Extraer los nombres de los tips que queremos conservar\nselected_tips &lt;- unique_species$tip_label\n\n# Remover duplicados\nsubarbol_final &lt;- drop.tip(subarbol, setdiff(subarbol$tip.label, selected_tips))\n\nggtree(subarbol_final) + \n  geom_tiplab(size = 3) + \n  xlim(-0.5, max(subarbol_final$edge.length) * 2)  # Expande el espacio a la izquierda",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#guardar-el-árbol-resultante-en-formato-nexus",
    "href": "chapters/u1_intro_diversification.html#guardar-el-árbol-resultante-en-formato-nexus",
    "title": "Introducción al proceso de diversificación",
    "section": "Guardar el árbol resultante en formato NEXUS",
    "text": "Guardar el árbol resultante en formato NEXUS\n\nwrite.nexus(subarbol_final, file=\"../docs/u1_PatDiv/subarbol_ingroup.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#carga-del-árbol-filogenético",
    "href": "chapters/u1_intro_diversification.html#carga-del-árbol-filogenético",
    "title": "Introducción al proceso de diversificación",
    "section": "Carga del Árbol Filogenético",
    "text": "Carga del Árbol Filogenético\n\n# Carga de paquetes\nlibrary(subplex)\nlibrary(TreeSim)\nlibrary(deSolve)\nlibrary(ape)       \nlibrary(TreePar)\n\n# Cargar el árbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el árbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtención-de-los-tiempos-de-especiación",
    "href": "chapters/u1_intro_diversification.html#obtención-de-los-tiempos-de-especiación",
    "title": "Introducción al proceso de diversificación",
    "section": "Obtención de los Tiempos de Especiación",
    "text": "Obtención de los Tiempos de Especiación\nExtraeremos y ordenaremos los tiempos de especiación (tiempos de ramificación) del árbol:\n\n# Obtener y ordenar los tiempos de especiación\n# La función getx() extrae los tiempos de ramificación del árbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulación.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configuración-de-parámetros-para-el-análisis",
    "href": "chapters/u1_intro_diversification.html#configuración-de-parámetros-para-el-análisis",
    "title": "Introducción al proceso de diversificación",
    "section": "Configuración de Parámetros para el Análisis",
    "text": "Configuración de Parámetros para el Análisis\nDefiniremos los parámetros necesarios para el análisis de cambios en las tasas de diversificación:\n\nrho &lt;- 22/26  # Proporción de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tamaño de la grilla de búsqueda de cambios de tasa (en millones de años)\nstart &lt;- min(times)   # Tiempo inicial para la búsqueda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la búsqueda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#ejecución-del-análisis-con-bd.shifts.optim",
    "href": "chapters/u1_intro_diversification.html#ejecución-del-análisis-con-bd.shifts.optim",
    "title": "Introducción al proceso de diversificación",
    "section": "Ejecución del Análisis con bd.shifts.optim",
    "text": "Ejecución del Análisis con bd.shifts.optim\nUtilizaremos la función bd.shifts.optim para estimar las tasas de especiación y extinción, así como los puntos en el tiempo donde ocurren cambios significativos en estas tasas:\n\n# Ejecutar el análisis de cambios en las tasas de diversificación\nresult_shifts &lt;- bd.shifts.optim(times, rho, grid, start, end, yule=TRUE)\n\n[1] \"startest\"\n[1] \"test\"\n\n# Mostrar los resultados\nresult_shifts[[2]][[1]]\n\n[1] 70.02138042  0.08912957\n\n\nA continuación se presentan los valores obtenidos en la estimación de la tasa de diversificación. Dado que el modelo Yule asume que no hay extinción, la tasa de extinción no está definida en este análisis.\n\nValor de la función de verosimilitud negativa: 70.02138\nTasa de especiación \\(\\lambda\\): 0.08913\n\nEn este contexto:\nEstos valores indican que la tasa de especiación estimada (\\(\\lambda\\)) es aproximadamente 0.08913.\nEl valor de la función de verosimilitud negativa (70.02138) proporciona una medida del ajuste del modelo a los datos, donde valores más bajos generalmente indican un mejor ajuste.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "href": "chapters/u1_intro_diversification.html#crear-un-script-de-revbayes-en-visual-studio-code-divrate.rev",
    "title": "Introducción al proceso de diversificación",
    "section": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "text": "Crear un script de RevBayes en Visual Studio Code: divrate.Rev",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "href": "chapters/u1_intro_diversification.html#cargar-el-archivo-nexus",
    "title": "Introducción al proceso de diversificación",
    "section": "Cargar el archivo NEXUS",
    "text": "Cargar el archivo NEXUS\n# Cargar la filogenia desde el archivo NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Obtener la lista de taxones en la filogenia\ntaxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "href": "chapters/u1_intro_diversification.html#inicializar-los-vectores-de-moves-y-monitors",
    "title": "Introducción al proceso de diversificación",
    "section": "Inicializar los vectores de moves y monitors",
    "text": "Inicializar los vectores de moves y monitors\n# Inicializar un vector vacío para los movimientos (moves)\nmoves = VectorMoves()\n\n# Inicializar un vector vacío para los monitores (monitors)\nmonitors = VectorMonitors()\n\n\n\n\n\nRepresentación del modelo gráfico para el proceso Yule (Pure-Birth) en RevBayes, donde la tasa de especiación (\\(\\lambda\\)) es tratada como una variable aleatoria extraída de una distribución uniforme.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiación-lambda",
    "href": "chapters/u1_intro_diversification.html#especificar-la-tasa-de-especiación-lambda",
    "title": "Introducción al proceso de diversificación",
    "section": "Especificar la tasa de especiación (\\(\\lambda\\))",
    "text": "Especificar la tasa de especiación (\\(\\lambda\\))\n# Especificar la tasa de especiación λ con una distribución uniforme\nbirth_rate ~ dnUniform(0, 100.0)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiación",
    "href": "chapters/u1_intro_diversification.html#asignar-un-movimiento-mcmc-a-la-tasa-de-especiación",
    "title": "Introducción al proceso de diversificación",
    "section": "Asignar un movimiento MCMC a la tasa de especiación",
    "text": "Asignar un movimiento MCMC a la tasa de especiación\n# Agregar un movimiento MCMC para la tasa de especiación\nmoves.append( mvScale(birth_rate, lambda=1.0, tune=true, weight=3.0) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-la-proporción-de-especies-muestreadas-rho",
    "href": "chapters/u1_intro_diversification.html#especificar-la-proporción-de-especies-muestreadas-rho",
    "title": "Introducción al proceso de diversificación",
    "section": "Especificar la proporción de especies muestreadas (\\(\\rho\\))",
    "text": "Especificar la proporción de especies muestreadas (\\(\\rho\\))\n# Obtener el número de taxones en la filogenia\nnum_taxa &lt;- T.ntips()\n\n# Estimar la proporción de especies muestreadas\nrho &lt;- num_taxa / 26",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-raíz",
    "href": "chapters/u1_intro_diversification.html#obtener-la-edad-de-la-raíz",
    "title": "Introducción al proceso de diversificación",
    "section": "Obtener la edad de la raíz",
    "text": "Obtener la edad de la raíz\n# Obtener la edad de la raíz del árbol\nroot_time &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiación",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-de-tiempo-de-especiación",
    "title": "Introducción al proceso de diversificación",
    "section": "Definir el modelo de tiempo de especiación",
    "text": "Definir el modelo de tiempo de especiación\nEl modelo Yule (pure-birth) en RevBayes se define con el proceso de nacimiento y muerte (dnBDP), pero con la tasa de extinción (mu) fijada en 0.\n# Definir el modelo de diversificación usando un proceso de nacimiento-muerte (BDP)\ntimetree ~ dnBDP(lambda=birth_rate, mu=0.0, rho=rho, rootAge=root_time, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)\nExplicación\n\nlambda = birth_rate → Tasa de especiación es una variable aleatoria con dnUniform(0, 100.0).\nmu = 0.0 → Asumimos que no hay extinción (modelo Yule).\nrho = rho → Se ajusta según el número de especies muestreadas.\nrootAge = root_time → Condicionamos el modelo en la edad de la raíz.\nsamplingStrategy = \"uniform\" → Asumimos muestreo uniforme.\ncondition = \"survival\" → Solo analizamos árboles que sobrevivieron hasta el presente.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "href": "chapters/u1_intro_diversification.html#fijar-la-filogenia-observada",
    "title": "Introducción al proceso de diversificación",
    "section": "Fijar la filogenia observada",
    "text": "Fijar la filogenia observada\n# Fijar la filogenia observada\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#definir-el-modelo-gráfico",
    "href": "chapters/u1_intro_diversification.html#definir-el-modelo-gráfico",
    "title": "Introducción al proceso de diversificación",
    "section": "Definir el modelo gráfico",
    "text": "Definir el modelo gráfico\n# Crear el objeto de modelo\nmymodel = model(birth_rate)\nEsto crea un modelo gráfico dirigido acíclico (DAG) donde birth_rate es el nodo principal, y RevBayes automáticamente encuentra todos los otros nodos conectados.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "href": "chapters/u1_intro_diversification.html#especificar-los-monitores",
    "title": "Introducción al proceso de diversificación",
    "section": "Especificar los Monitores",
    "text": "Especificar los Monitores\n# Monitor para registrar los estados del modelo en un archivo de salida\nmonitors.append( mnModel(filename=\"output/diversification_Yule.log\", printgen=10, separator=TAB) )\n\n# Monitor para imprimir la tasa de especiación en la pantalla cada 1000 generaciones\nmonitors.append( mnScreen(printgen=1000, birth_rate) )\nExplicación\n\nmnModel guarda el registro de la ejecución en \"output/diversification_Yule.log\", escribiendo cada 10 generaciones.\nmnScreen imprime la tasa de especiación (birth_rate) en la consola cada 1000 generaciones.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification.html#configurar-y-ejecutar-el-mcmc",
    "title": "Introducción al proceso de diversificación",
    "section": "Configurar y ejecutar el MCMC",
    "text": "Configurar y ejecutar el MCMC\n# Inicializar el MCMC con dos cadenas combinadas en un solo análisis\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\n\n# Ejecutar el MCMC por 50,000 generaciones, ajustando los movimientos cada 200 generaciones\nmymcmc.run(generations=50000, tuningInterval=200)\nExplicación\n\nnruns=2 → Corre dos cadenas independientes.\ncombine=\"mixed\" → Combina las cadenas en un solo conjunto de muestras.\ngenerations=50000 → Ejecuta la simulación por 50,000 generaciones.\ntuningInterval=200 → Ajusta los movimientos cada 200 generaciones para mejorar la eficiencia del muestreo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "href": "chapters/u1_intro_diversification.html#cargar-los-resultados-en-revgadgets",
    "title": "Introducción al proceso de diversificación",
    "section": "Cargar los resultados en RevGadgets",
    "text": "Cargar los resultados en RevGadgets\nDespués de correr el MCMC en RevBayes, usar RevGadgets en R para analizar la distribución posterior:\n\n# Cargar librerías necesarias\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC\nmcmc_trace &lt;- readTrace(\"../docs/u1_PatDiv/output/diversification_Yule.log\")\n\n# Visualizar la distribución posterior de birth_rate\nplotTrace(mcmc_trace, vars=\"birth_rate\")\n\n[[1]]",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "href": "chapters/u1_intro_diversification.html#calcular-la-media-y-el-intervalo-de-hpd-highest-posterior-density",
    "title": "Introducción al proceso de diversificación",
    "section": "Calcular la media y el intervalo de HPD (Highest Posterior Density)",
    "text": "Calcular la media y el intervalo de HPD (Highest Posterior Density)\n\n# Calcular la media posterior y el HPD del 95%\nsummary_stats &lt;- summarizeTrace(mcmc_trace, vars=\"birth_rate\")\nprint(summary_stats)\n\n$birth_rate\n$birth_rate$trace_1\n         mean        median           MAP  quantile_2.5 quantile_97.5 \n   0.09313312    0.09214016    0.09139628    0.05919603    0.13341000",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification.html#comparar-la-distribución-previa-y-posterior",
    "href": "chapters/u1_intro_diversification.html#comparar-la-distribución-previa-y-posterior",
    "title": "Introducción al proceso de diversificación",
    "section": "Comparar la distribución previa y posterior",
    "text": "Comparar la distribución previa y posterior\n\nlibrary(RevGadgets)\nlibrary(ggplot2)\n\n# Leer los datos del MCMC combinando las dos cadenas\nposterior_trace &lt;- readTrace(c(\"../docs/u1_PatDiv/output/diversification_Yule_run_1.log\", \"../docs/u1_PatDiv/output/diversification_Yule_run_2.log\"))\n\n# Extraer el primer conjunto de muestras (lista de data frames)\nyule_posterior &lt;- posterior_trace[[1]]\n\n# Simular 10,000 valores de la distribución previa\nyule_prior &lt;- data.frame(birth_rate = runif(10000, min=0, max=100))\n\n# Agregar la columna de la distribución previa en el posterior\nyule_posterior$birth_rate_prior &lt;- sample(yule_prior$birth_rate, size = nrow(yule_posterior), replace = TRUE)\n\n# Graficar la comparación\nplotTrace(list(yule_posterior), vars = c(\"birth_rate\", \"birth_rate_prior\"))[[1]] +\n  theme(legend.position = c(0.80, 0.80),  # Ubicación de la leyenda\n        legend.text = element_text(size =20),  # Tamaño del texto de la leyenda\n        legend.title = element_text(size = 22)) +  # Tamaño del título de la leyenda\n  xlim(0, 1)  # Ajusta el límite según los valores observados",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Introducción al proceso de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html",
    "href": "chapters/u1_intro_diversification_2.html",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "",
    "text": "Presentación: Modelos con cambios en las tasas de diversificación\nHaz clic en la imagen para ver el PDF de la presentación",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducción",
    "href": "chapters/u1_intro_diversification_2.html#introducción",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Introducción",
    "text": "Introducción\nEn estudios filogenéticos, los modelos de nacimiento-muerte (birth-death models) permiten inferir cómo han cambiado las tasas de diversificación (\\(\\lambda\\)) y extinción (\\(\\mu\\)) a lo largo del tiempo. Sin embargo, estas tasas no son siempre constantes. Diversos eventos evolutivos, como la aparición de nuevas adaptaciones o cambios ambientales, pueden causar variaciones en la dinámica de diversificación de un linaje.\nEl paquete TreePar permite ajustar modelos de diversificación con cambios en la tasa mediante la función bd.shifts.optim(). Esta función estima la mejor combinación de tasas de diversificación y extinción en diferentes periodos de tiempo, según la estructura de una filogenia dada.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#cargar-librerías-y-el-árbol-filogenético",
    "href": "chapters/u1_intro_diversification_2.html#cargar-librerías-y-el-árbol-filogenético",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Cargar librerías y el árbol filogenético",
    "text": "Cargar librerías y el árbol filogenético\n\n# Cargar las librerías necesarias\nlibrary(ape)       \nlibrary(TreePar)\nlibrary(tidyverse)\nlibrary(ggtree)\n\n# Cargar el árbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el árbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#obtención-de-los-tiempos-de-diversificación",
    "href": "chapters/u1_intro_diversification_2.html#obtención-de-los-tiempos-de-diversificación",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Obtención de los tiempos de diversificación",
    "text": "Obtención de los tiempos de diversificación\nExtraeremos y ordenaremos los tiempos de diversificación (tiempos de ramificación) del árbol:\n\n# Obtener y ordenar los tiempos de especiación\n# La función getx() extrae los tiempos de ramificación del árbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulación.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuración-de-parámetros-para-el-análisis",
    "href": "chapters/u1_intro_diversification_2.html#configuración-de-parámetros-para-el-análisis",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Configuración de Parámetros para el Análisis",
    "text": "Configuración de Parámetros para el Análisis\nDefiniremos los parámetros necesarios para el análisis de cambios en las tasas de diversificación:\n\nrho &lt;- 22/26  # Proporción de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tamaño de la grilla de búsqueda de cambios de tasa (en millones de años)\nstart &lt;- min(times)   # Tiempo inicial para la búsqueda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la búsqueda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelo-de-nacimiento-muerte-sin-cambios",
    "href": "chapters/u1_intro_diversification_2.html#modelo-de-nacimiento-muerte-sin-cambios",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Modelo de nacimiento-muerte sin cambios",
    "text": "Modelo de nacimiento-muerte sin cambios\n\nresbd &lt;- bd.shifts.optim(times, rho, grid, start, end)\n\n[1] \"startest\"\n[1] \"test\"\n\nresbd[[2]]  # Verosimilitud del modelo\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelo-con-un-cambio",
    "href": "chapters/u1_intro_diversification_2.html#modelo-con-un-cambio",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Modelo con un cambio",
    "text": "Modelo con un cambio\nAquí probamos un modelo en el que la tasa cambia en un tiempo \\(t_{1}\\)\n\n\n\n\n\n\n\nParámetro\nSignificado\n\n\n\n\ntime\nEdades de los nodos terminales\n\n\nc(0.8, 1)\nc(\\(\\rho\\), Intervalo de discretización del tiempo)\n\n\ngrid\nIntervalo de discretización del tiempo\n\n\nstart, end\nRango de tiempo para el análisis\n\n\nME=FALSE\nNo se consideran eventos de extinción masiva\n\n\nsurvival=1\nSe asume que todas las especies sobrevivientes han sido muestreadas\n\n\n\n\nresoneshift &lt;- bd.shifts.optim(times, c(rho, 1), grid, start, end, ME=FALSE, survival=1)\nresoneshift[[2]]  # Verosimilitud del modelo con un cambio en la tasa\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.295893e+01 9.952613e-01 8.527988e-02 1.001768e-04 1.594866e-01\n[6] 6.125229e+00\n\n\nInterpretación\n\n\n\n\n\n\n\n\nÍndice\nParámetro estimado\nDescripción\n\n\n\n\n1\n62.95893\nVerosimilitud (log-likelihood)\n\n\n2\n0.99526\nTurnover antes del cambio (\\(\\epsilon_0\\))\n\n\n3\n0.08528\nTurnover después del cambio (\\(\\epsilon_1\\))\n\n\n4\n0.00010\nDiversificación antes del cambio (\\(r_0\\))\n\n\n5\n0.15949\nDiversificación después del cambio (\\(r_1\\))\n\n\n6\n6.12523\ntiempo del cambio\n\n\n\nGraficar el modelo con un cambio en la tasa\n\nbd.shifts.plot(list(resoneshift[[2]]), shifts = 1, timemax = max(times), ratemin = 0, ratemax = 1.1, plotturnover = TRUE)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelo-con-dos-cambios",
    "href": "chapters/u1_intro_diversification_2.html#modelo-con-dos-cambios",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Modelo con dos cambios",
    "text": "Modelo con dos cambios\n\nrestwoshift &lt;- bd.shifts.optim(times, c(0.8,1,1), grid, start, end, ME=FALSE, survival=1)\nrestwoshift[[2]]\n\n\n\n[[1]]\n[1] 6.984598e+01 2.752173e-07 9.230017e-02\n\n[[2]]\n[1] 6.300085e+01 3.082460e-02 9.309168e-08 1.887393e-02 1.612077e-01\n[6] 6.125229e+00\n\n[[3]]\n[1]  6.045200e+01  7.427444e-08  1.840255e-02  1.040200e+00  2.028774e-02\n[6]  1.244237e-01 -2.968324e-02  6.125229e+00  1.472523e+01\n\n\nInterpretación\n\n\n\n\n\n\n\n\nÍndice\nValor\nDescripción\n\n\n\n\n1\n60.45200\nVerosimilitud (log-likelihood)\n\n\n2\n7.427444e-08\nTurnover antes del primer cambio (\\(\\epsilon_0\\))\n\n\n3\n0.01840\nTurnover antes del segundo cambio (\\(\\epsilon_1\\))\n\n\n4\n1.04020\nTurnover después del segundo cambio (\\(\\epsilon_2\\))\n\n\n5\n0.02028\nDiversificación antes del primer cambio (\\(r_0\\))\n\n\n6\n0.12442\nDiversificación antes del segundo cambio (\\(r_1\\))\n\n\n7\n-0.02968\nDiversificación despues del segundo cambio (\\(r_2\\))\n\n\n8\n6.12523\nTiempo del primer cambio \\(t_1\\)\n\n\n9\n14.72523\nTiempo del segundo cambio \\(t_1\\)\n\n\n\nGraficar el modelo con dos cambio en la tasa\n\nbd.shifts.plot(list(restwoshift[[2]]), shifts = 2, timemax = max(times), ratemin = -0.1, ratemax = 1.1, plotturnover = TRUE)\n\n\n\n\n\n\n\n\nOpcion con ggtree y ggplot\n\nlibrary(ggplot2)\nlibrary(ggtree)\nlibrary(tidyr)\nlibrary(patchwork) \n\n# Extraer resultados de restwoshift[[2]]\nresultados &lt;- restwoshift[[2]][[3]]\n\n# Crear el gráfico del árbol con `ggtree`\np_tree &lt;- ggtree(tree) + \n  theme_tree() +\n  theme(plot.background = element_blank())\n\n# Crear el data frame con los valores obtenidos\ndf_prueba &lt;- data.frame(\n  turnover = c(resultados[2], resultados[2], resultados[3], resultados[4]),  \n  r = c(resultados[5], resultados[5], resultados[6], resultados[7]),  \n  tiempo = c(start, resultados[8], resultados[9], end)  # Tiempo en sentido inverso (del pasado al presente)\n)\n\n# Transformar datos al formato largo para ggplot2\ndf_long &lt;- pivot_longer(df_prueba, cols = c(turnover, r), \n                        names_to = \"Tasa\", values_to = \"Valor\")\n\n# Crear el gráfico de tasas con `geom_step()`\np_tasas &lt;- ggplot(df_long, aes(x = tiempo, y = Valor, color = rev(Tasa))) +\n  geom_step(size = 1, direction = \"hv\") + \n  geom_point(size = 3) +\n  scale_x_reverse() +  # Invertir el eje X para que el tiempo fluya del pasado al presente\n  labs(x = \"Time\",\n       y = \"Rate\") +\n  theme_minimal()\n\n# Superponer el árbol y el gráfico de tasas con ajuste de proporciones\np_tree + p_tasas + plot_layout(ncol = 1, heights = c(1, 1.5))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#comparación-de-modelos-usando-likelihood-ratio-test-lrt",
    "href": "chapters/u1_intro_diversification_2.html#comparación-de-modelos-usando-likelihood-ratio-test-lrt",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Comparación de modelos usando Likelihood Ratio Test (LRT)",
    "text": "Comparación de modelos usando Likelihood Ratio Test (LRT)\n¿Qué es la prueba LRT? Es una prueba estadística para comparar modelos anidados, es decir, modelos donde uno es una versión simplificada del otro (por ejemplo, el modelo de nacimiento-muerte puro vs. un modelo con cambios en la tasa).\nSe calcula con la siguiente fórmula:\n\\(LR = 2 * (\\mathcal{L}_{modelo más simple} - \\mathcal{L}_{modelo más complejo})\\)\nDonde: - Un p-valor menor a 0.05 indica que el modelo más complejo es significativamente mejor que el más simple.\nObtener las Verosimilitudes de cada modelo\n\n## Verosimilitud birth-death\nresbd[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death un cambio\nresoneshift[[2]][[1]][1]\n\n[1] 70.02138\n\n## Verosimilitud birth-death dos cambios\nrestwoshift[[2]][[1]][1]\n\n[1] 69.84598\n\n\nComparación BD vs BD un cambio\n\nChiSq1 = 2 * (resbd[[2]][[1]][1] - resoneshift[[2]][[1]][1])\nChiSq1\n\n[1] 0\n\npchiSq1 &lt;- pchisq(ChiSq1, df=3)\npchiSq1\n\n[1] 0\n\n\nResultados:\n\n\\(LR = 0\\) → No hay diferencia en la verosimilitud entre el modelo BD y BD con un cambio.\n\\(p_{valor} = 0\\) → Indica que no hay mejora significativa en el modelo con un cambio en la tasa.\n\nComparación BD un cambio vs BD dos cambios\n\nChiSq2 = 2 * (resoneshift[[2]][[1]][1] - restwoshift[[2]][[1]][1])\nChiSq2\n\n[1] 0.3508041\n\npchiSq2 &lt;- pchisq(ChiSq2, df=3)\npchiSq2\n\n[1] 0.04979325\n\n\nResultados:\n\n\\(LR = 0.3508\\) → Hay una pequeña diferencia en la verosimilitud entre el modelo BD con un cambio y el modelo BD con dos cambios.\n\\(p_{valor} = 0.0498\\) → Justo en el límite del umbral de significancia \\((0.05)\\), lo que indica que el modelo con dos cambios podría ser significativamente mejor.\n\nGenerar el gráfico con bd.shifts.plot()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#introducción-1",
    "href": "chapters/u1_intro_diversification_2.html#introducción-1",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Introducción",
    "text": "Introducción\nEl modelo de nacimiento-muerte epísodico es un proceso en el cual las tasas de diversificación varían epísodicamente a lo largo del tiempo y se modelan como tasas constantes por intervalos de tiempo (Stadler 2011; Höhna 2015). Siguiendo el tutorial oficial Episodic Diversification Rate Estimation.\nAsumimos que las tasas transformadas logarítmicamente siguen una distribución previa de campo aleatorio de Markov en forma de herradura (Horseshoe Markov random field, HSMRF) según Magee et al. (2020).\n\nTasas transformadas logarítmicamente:\n\nEn muchos modelos evolutivos, las tasas de diversificación y extinción pueden variar en órdenes de magnitud.\nPara modelar mejor estos cambios, se toma el logaritmo de las tasas en lugar de usarlas directamente.\nEsto ayuda a evitar valores negativos y hace que la distribución de las tasas sea más manejable.\n\nDistribución previa (prior) de campo aleatorio de Markov en forma de herradura (HSMRF):\n\nDistribución previa (prior): En un enfoque bayesiano, los parámetros desconocidos (como las tasas de especiación/extinción) tienen distribuciones previas que reflejan nuestras creencias antes de ver los datos.\nCampo aleatorio de Markov (Markov Random Field, MRF): Este término indica que las tasas en un intervalo de tiempo dependen de las tasas en el intervalo anterior. En otras palabras, las tasas están autocorrelacionadas temporalmente.\nForma de herradura (Horseshoe): Es un tipo de distribución previa diseñada para manejar datos donde algunos valores pueden ser cercanos a cero (relativamente constantes), pero también permite valores extremos (cambios bruscos en las tasas).\n¿Por qué se usa? El HSMRF permite capturar patrones donde las tasas cambian lentamente la mayor parte del tiempo, pero ocasionalmente pueden dar saltos grandes, lo cual es biológicamente realista en muchos sistemas evolutivos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#lectura-del-árbol",
    "href": "chapters/u1_intro_diversification_2.html#lectura-del-árbol",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Lectura del árbol",
    "text": "Lectura del árbol\nComenzamos cargando el árbol filogenético previamente filtrado.\n# Cargar el árbol filogenético desde un archivo en formato NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Extraer la información taxonómica del árbol\n taxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "href": "chapters/u1_intro_diversification_2.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definir-el-número-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificación.",
    "href": "chapters/u1_intro_diversification_2.html#definir-el-número-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificación.",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Definir el número de intervalos en los que dividiremos el tiempo para modelar la diversificación.",
    "text": "Definir el número de intervalos en los que dividiremos el tiempo para modelar la diversificación.\nNUM_INTERVALS = 10  # Número total de intervalos de tiempo\nNUM_BREAKS := NUM_INTERVALS - 1  # Número de puntos de cambio entre intervalos",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definimos-distribuciones-previas-sobre-las-tasas-dentro-del-modelo-hsmrf-de-nacimiento-muerte.-parámetros-globales-de-escala",
    "href": "chapters/u1_intro_diversification_2.html#definimos-distribuciones-previas-sobre-las-tasas-dentro-del-modelo-hsmrf-de-nacimiento-muerte.-parámetros-globales-de-escala",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Definimos distribuciones previas sobre las tasas dentro del modelo HSMRF de nacimiento-muerte. Parámetros globales de escala",
    "text": "Definimos distribuciones previas sobre las tasas dentro del modelo HSMRF de nacimiento-muerte. Parámetros globales de escala\n# Hiperprior para controlar la variabilidad global de las tasas de diversificación y extinción\nspeciation_global_scale_hyperprior &lt;- 0.044\nextinction_global_scale_hyperprior &lt;- 0.044\nEstos hiperpriors controlan la variabilidad global de las tasas de diversificación y extinción:\n\nUn valor mayor permite más cambios abruptos entre intervalos.\nUn valor menor suaviza las tasas a lo largo del tiempo.\n\nFunción setMRFGlobalScaleHyperpriorNShifts() del paquete RevGadgets en R para calcular el hiperprior automáticamente.\n\n### Ejecutar en R, no agregar a RevBayes!!!\n### Calcula el hiperprior que utilizaremos en RevBayes\nlibrary(RevGadgets)\n## 10 numero intervalos\n## \"HSMRF\" Horseshoe Markov random field \nsetMRFGlobalScaleHyperpriorNShifts(10, \"HSMRF\")\n\n[1] 0.04446432",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#asignar-distribuciones-previas-half-cauchy-dnhalfcauchy01",
    "href": "chapters/u1_intro_diversification_2.html#asignar-distribuciones-previas-half-cauchy-dnhalfcauchy01",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Asignar distribuciones previas Half-Cauchy (dnHalfCauchy(0,1))",
    "text": "Asignar distribuciones previas Half-Cauchy (dnHalfCauchy(0,1))\nSe asignan a los parámetros de escala global, esto permite valores pequeños pero también acepta valores más grandes ocasionalmente.\n# Distribuciones previas de Cauchy truncadas para los parámetros de escala global\nspeciation_global_scale ~ dnHalfCauchy(0,1)\nextinction_global_scale ~ dnHalfCauchy(0,1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#definir-las-tasas-iniciales-de-diversificación-y-extinción-en-el-modelo-hsmrf.",
    "href": "chapters/u1_intro_diversification_2.html#definir-las-tasas-iniciales-de-diversificación-y-extinción-en-el-modelo-hsmrf.",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Definir las tasas iniciales de diversificación y extinción en el modelo HSMRF.",
    "text": "Definir las tasas iniciales de diversificación y extinción en el modelo HSMRF.\nEn este enfoque, comenzamos con la tasa de diversificación y extinción en el presente y luego modelamos cómo cambian hacia el pasado.\n# Definir tasas iniciales de diversificación y extinción en el presente\nlog_speciation_at_present ~ dnUniform(-10.0,10.0)\nlog_speciation_at_present.setValue(0.0)\nlog_extinction_at_present ~ dnUniform(-10.0,10.0)\nlog_extinction_at_present.setValue(-1.0)\n¿Por qué se usa dnUniform(-10.0,10.0)?\nSe establece una distribución uniforme como prior para las tasas iniciales de diversificación y extinción.\n\nComo estamos modelando las tasas en escala logarítmica, esto implica que los valores de especiación/extinción reales estarán entre:\n\n(e^{-10}) (casi 0, evolución extremadamente lenta)\n(e^{10}) (tasa de diversificación muy rápida)\n\nPermitir este rango amplio cubre la mayoría de los valores posibles sin asumir un conocimiento previo específico sobre la tasa de diversificación en el presente.\n\n¿Por qué los valores iniciales 0.0 y -1.0?\n\nlog_speciation_at_present.setValue(0.0): Equivale a establecer la tasa inicial de diversificación en (\\(e^0 = 1.0\\)), lo cual es un punto razonable para comenzar.\nlog_extinction_at_present.setValue(-1.0): Equivale a una tasa inicial de extinción de (\\(e^{-1} \\approx 0.37\\)), lo que implica que la extinción es menor que la diversificación en el punto de partida.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#movimientos-eficientes-en-mcmc-para-explorar-estas-tasas",
    "href": "chapters/u1_intro_diversification_2.html#movimientos-eficientes-en-mcmc-para-explorar-estas-tasas",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Movimientos eficientes en MCMC para explorar estas tasas",
    "text": "Movimientos eficientes en MCMC para explorar estas tasas\nmoves.append( mvScaleBactrian(log_speciation_at_present,weight=5))\nmoves.append( mvScaleBactrian(log_extinction_at_present,weight=5))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#modelar-la-diversificación-episódica",
    "href": "chapters/u1_intro_diversification_2.html#modelar-la-diversificación-episódica",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Modelar la diversificación episódica",
    "text": "Modelar la diversificación episódica\nEn el código de RevBayes para modelar la diversificación episódica, se utiliza un bucle for para definir los cambios en las tasas de diversificación y extinción en cada intervalo de tiempo.\nfor (i in 1:NUM_BREAKS) {\n  # Variabilidad local en cada intervalo\n  sigma_speciation[i] ~ dnHalfCauchy(0,1)\n  sigma_extinction[i] ~ dnHalfCauchy(0,1)\n\n  # Se inicializan valores aleatorios en un rango de 0.005 a 0.1, para evitar valores extremos en el inicio del MCMC\n  sigma_speciation[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_extinction[i].setValue(runif(1,0.005,0.1)[1])\n\n  # Especificar los cambios en log-diversificación y log-extinción mediante una distribución normal\n  delta_log_speciation[i] ~ dnNormal( mean=0, sd=sigma_speciation[i]*speciation_global_scale*speciation_global_scale_hyperprior )\n  delta_log_extinction[i] ~ dnNormal( mean=0, sd=sigma_extinction[i]*extinction_global_scale*extinction_global_scale_hyperprior )\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#calcular-las-tasas-de-diversificación-y-extinción",
    "href": "chapters/u1_intro_diversification_2.html#calcular-las-tasas-de-diversificación-y-extinción",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Calcular las tasas de diversificación y extinción",
    "text": "Calcular las tasas de diversificación y extinción\nspeciation := fnassembleContinuousMRF(log_speciation_at_present, delta_log_speciation, initialValueIsLogScale=TRUE, order=1)\nextinction := fnassembleContinuousMRF(log_extinction_at_present, delta_log_extinction, initialValueIsLogScale=TRUE, order=1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#movimientos-de-mcmc-para-el-modelo-hsmrf",
    "href": "chapters/u1_intro_diversification_2.html#movimientos-de-mcmc-para-el-modelo-hsmrf",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Movimientos de MCMC para el Modelo HSMRF",
    "text": "Movimientos de MCMC para el Modelo HSMRF\n# Movimiento para los cambios en log-escala de diversificación y extinción\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_speciation, weight=5, tune=FALSE))\nmoves.append(mvEllipticalSliceSamplingSimple(delta_log_extinction, weight=5, tune=FALSE))\n\n# Movimiento Gibbs para los hiperparámetros globales y locales\nmoves.append(mvHSRFHyperpriorsGibbs(speciation_global_scale, sigma_speciation , delta_log_speciation , speciation_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\nmoves.append(mvHSRFHyperpriorsGibbs(extinction_global_scale, sigma_extinction , delta_log_extinction , extinction_global_scale_hyperprior, propGlobalOnly=0.75, weight=10))\n\n# Movimiento de intercambio entre intervalos adyacentes\nmoves.append(mvHSRFIntervalSwap(delta_log_speciation, sigma_speciation, weight=5))\nmoves.append(mvHSRFIntervalSwap(delta_log_extinction, sigma_extinction, weight=5))\nSe utilizan tres tipos principales de movimientos en este código:\n\nMuestreo Elíptico Slice (mvEllipticalSliceSamplingSimple)\n\nOptimiza la exploración de los cambios en log-escala de las tasas de diversificación y extinción.\nFunciona bien en modelos con alta correlación entre parámetros.\n\nMuestreo Gibbs (mvHSRFHyperpriorsGibbs)\n\nSe usa para actualizar los hiperparámetros globales y locales del modelo.\nPermite ajustes eficientes en la escala de variabilidad de las tasas.\n\nIntercambio de intervalos (mvHSRFIntervalSwap)\n\nIntercambia valores entre intervalos de tiempo adyacentes.\nAyuda a evitar que la cadena de MCMC se quede atrapada en un estado subóptimo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuración-de-los-intervalos-de-tiempo",
    "href": "chapters/u1_intro_diversification_2.html#configuración-de-los-intervalos-de-tiempo",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Configuración de los Intervalos de Tiempo",
    "text": "Configuración de los Intervalos de Tiempo\ninterval_times &lt;- abs(T.rootAge() * seq(1, NUM_BREAKS, 1)/NUM_INTERVALS)\n\nT.rootAge() → Obtiene la edad de la raíz del árbol filogenético (es decir, el tiempo en el pasado en que el linaje común más reciente existió).\nseq(1, NUM_BREAKS, 1) → Genera una secuencia de números del 1 al NUM_BREAKS (el número de puntos de cambio entre intervalos).\nMultiplica la raíz del árbol T.rootAge() por esta secuencia para escalar los intervalos al tiempo evolutivo real.\nDivide entre NUM_INTERVALS para normalizar y hacer que los intervalos sean de igual tamaño.\nabs(...) → Convierte los valores a positivos porque las edades van en dirección del presente al pasado.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#corrección-por-muestreo-incompleto",
    "href": "chapters/u1_intro_diversification_2.html#corrección-por-muestreo-incompleto",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Corrección por Muestreo Incompleto",
    "text": "Corrección por Muestreo Incompleto\nrho &lt;- T.ntips()/26",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#inicializando-el-nodo-estocástico-del-árbol-de-tiempos",
    "href": "chapters/u1_intro_diversification_2.html#inicializando-el-nodo-estocástico-del-árbol-de-tiempos",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Inicializando el Nodo Estocástico del Árbol de Tiempos",
    "text": "Inicializando el Nodo Estocástico del Árbol de Tiempos\ntimetree ~ dnEpisodicBirthDeath(rootAge=T.rootAge(), lambdaRates=speciation, lambdaTimes=interval_times, muRates=extinction, muTimes=interval_times, rho=rho, samplingStrategy=\"uniform\", condition=\"survival\", taxa=taxa)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#asignando-datos-observados-al-árbol",
    "href": "chapters/u1_intro_diversification_2.html#asignando-datos-observados-al-árbol",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Asignando Datos Observados al Árbol",
    "text": "Asignando Datos Observados al Árbol\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#creando-el-modelo-completo",
    "href": "chapters/u1_intro_diversification_2.html#creando-el-modelo-completo",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Creando el Modelo Completo",
    "text": "Creando el Modelo Completo\nEncuentra todas las conexiones en la red bayesiana y las agrupa en un solo objeto model()\nmymodel = model(rho)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuración-de-los-monitores",
    "href": "chapters/u1_intro_diversification_2.html#configuración-de-los-monitores",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Configuración de los Monitores",
    "text": "Configuración de los Monitores\nmonitors.append(mnModel(filename=\"../output/Eupomphini_EBD.log\", printgen=10, separator = TAB))\nCrea un monitor (mnModel) que guarda los valores de todos los parámetros del modelo.\n✔ Guarda los resultados en el archivo \"output/primates_EBD.log\".\n✔ printgen=10 → Especifica que se guardará un estado cada 10 generaciones.\n✔ separator=TAB → Usa tabulaciones para separar los valores en el archivo de salida.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#creación-de-monitores-para-las-tasas-de-diversificación-y-extinción",
    "href": "chapters/u1_intro_diversification_2.html#creación-de-monitores-para-las-tasas-de-diversificación-y-extinción",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Creación de Monitores para las Tasas de diversificación y Extinción",
    "text": "Creación de Monitores para las Tasas de diversificación y Extinción\n# Tasas de especiación\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_rates.log\", printgen=10, separator = TAB, speciation))\n\n# Intervalos de tiempo de especiación\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_speciation_times.log\", printgen=10, separator = TAB, interval_times))\n\n# Tasas de extinción\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_rates.log\", printgen=10, separator = TAB, extinction))\n\n#Intervalos de tiempo de extinción\nmonitors.append(mnFile(filename=\"../output/Eupomphini_EBD_extinction_times.log\", printgen=10, separator = TAB, interval_times))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#creación-de-un-monitor-en-pantalla",
    "href": "chapters/u1_intro_diversification_2.html#creación-de-un-monitor-en-pantalla",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Creación de un Monitor en Pantalla",
    "text": "Creación de un Monitor en Pantalla\nmonitors.append(mnScreen(printgen=1000, extinction_global_scale, speciation_global_scale))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#configuración-del-mcmc",
    "href": "chapters/u1_intro_diversification_2.html#configuración-del-mcmc",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Configuración del MCMC",
    "text": "Configuración del MCMC\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\nCrea el objeto MCMC mymcmc que utilizará:\n\nmymodel → El modelo definido anteriormente.\nmonitors → Los monitores configurados.\nmoves → Los movimientos de MCMC definidos antes.\nnruns=2 → Ejecuta dos cadenas independientes de MCMC.\ncombine=\"mixed\" → Mezcla las cadenas al final del proceso para mejorar la estimación de parámetros.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_2.html#ejecutar-el-mcmc",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=50000, tuningInterval=200)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_2.html#visualización-de-las-tasas-de-diversificación",
    "href": "chapters/u1_intro_diversification_2.html#visualización-de-las-tasas-de-diversificación",
    "title": "Modelos con cambios en las tasas de diversificación",
    "section": "Visualización de las tasas de diversificación",
    "text": "Visualización de las tasas de diversificación\nFinalmente, generamos un gráfico que muestra cómo las tasas de diversificación y extinción han cambiado a lo largo del tiempo.\n\nlibrary(RevGadgets)\n\n# Especificar la ruta de los archivos de salida \nspeciation_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_times.log\"\nspeciation_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_speciation_rates.log\"\nextinction_time_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_times.log\"\nextinction_rate_file &lt;- \"../docs/u1_PatDiv/output/div_epi/Eupomphini_EBD_extinction_rates.log\"\n\n# Leer y procesar los datos\nrates &lt;- processDivRates(speciation_time_log = speciation_time_file,\n                         speciation_rate_log = speciation_rate_file,\n                         extinction_time_log = extinction_time_file,\n                         extinction_rate_log = extinction_rate_file,\n                         burnin = 0.25, # Se descarta el 25% inicial de las iteraciones como burn-in\n                         summary = \"median\")  # Se toman las tasas medianas como resumen\n\n# Graficar las tasas atravez del tiempo\np &lt;- plotDivRates(rates = rates) +\n  xlab(\"Millions of years ago\") +\n  ylab(\"Rate per million years\")\n\np",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Modelos con cambios en las tasas de diversificación</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html",
    "href": "chapters/u1_intro_diversification_3.html",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "",
    "text": "Presentación: Estimación de Eventos de Extinción Masiva\nHaz clic en la imagen para ver el PDF de la presentación",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#cargar-librerías-y-el-árbol-filogenético",
    "href": "chapters/u1_intro_diversification_3.html#cargar-librerías-y-el-árbol-filogenético",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Cargar librerías y el árbol filogenético",
    "text": "Cargar librerías y el árbol filogenético\n\n# Cargar las librerías necesarias\nlibrary(ape)       \nlibrary(TreePar)\nlibrary(tidyverse)\nlibrary(ggtree)\n\n# Cargar el árbol desde un archivo Nexus\ntree &lt;- read.nexus(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")\n\n# Visualizar el árbol\nggtree(tree) + theme_tree()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#obtención-de-los-tiempos-de-diversificación",
    "href": "chapters/u1_intro_diversification_3.html#obtención-de-los-tiempos-de-diversificación",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Obtención de los tiempos de diversificación",
    "text": "Obtención de los tiempos de diversificación\nExtraeremos y ordenaremos los tiempos de diversificación (tiempos de ramificación) del árbol:\n\n# Obtener y ordenar los tiempos de especiación\n# La función getx() extrae los tiempos de ramificación del árbol.\ntimes &lt;- sort(getx(tree), decreasing = TRUE) # sort () rdena los tiempos en orden descendente.\ntimes &lt;- unname(times) # elimina los nombres de los elementos del vector para simplificar su manipulación.\nprint(times)\n\n [1] 19.5829128 18.1869690 16.7465168 15.4799329 15.4702670 15.2568969\n [7] 14.8167040 13.6855239 12.2625233 11.9306405 11.3703192  9.3733686\n[13]  9.0410043  8.7813081  8.2912126  7.7803338  7.2101697  6.3883760\n[19]  6.2512423  1.9309798  0.9252293",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#configuración-de-parámetros-para-el-análisis",
    "href": "chapters/u1_intro_diversification_3.html#configuración-de-parámetros-para-el-análisis",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Configuración de Parámetros para el Análisis",
    "text": "Configuración de Parámetros para el Análisis\nDefiniremos los parámetros necesarios para el análisis de cambios en las tasas de diversificación:\n\nrho &lt;- 22/26  # Proporción de especies muestreadas (22 de 26 especies)\ngrid &lt;- 0.2   # Tamaño de la grilla de búsqueda de cambios de tasa (en millones de años)\nstart &lt;- min(times)   # Tiempo inicial para la búsqueda de cambios de tasa\nend &lt;- max(times)     # Tiempo final para la búsqueda de cambios de tasa",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#modelo-con-un-evento-de-extinción-masiva",
    "href": "chapters/u1_intro_diversification_3.html#modelo-con-un-evento-de-extinción-masiva",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Modelo con un Evento de Extinción Masiva",
    "text": "Modelo con un Evento de Extinción Masiva\n\n# Ejecutar la optimización con detección de extinción masiva\nres_MEE &lt;- bd.shifts.optim(times, c(rho, 1), grid, start, end, ME = TRUE, survival = 1) # Activar detección de extinciones masivas\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.817460e+01 1.195857e-07 1.246163e-01 3.649862e-01 9.252293e-01\n\n\nInterpretación\n\n\n\n\n\n\n\n\nÍndice\nParámetro estimado\nDescripción\n\n\n\n\n1\n68.1746\nVerosimilitud (log-likelihood)\n\n\n2\n1.195857e-07\nTurnover (\\(\\epsilon\\))\n\n\n3\n0.1246163\nDiversificación (\\(r\\))\n\n\n4\n0.3649862\nEspecies muestreadas antes del evento (\\(\\rho_0\\))\n\n\n5\n0.925229\nTiempo antes del evento (\\(t_0\\))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#modelo-con-dos-eventos-de-extinción-masiva",
    "href": "chapters/u1_intro_diversification_3.html#modelo-con-dos-eventos-de-extinción-masiva",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Modelo con dos Eventos de Extinción Masiva",
    "text": "Modelo con dos Eventos de Extinción Masiva\n\n# Ejecutar la optimización con detección de extinción masiva\nres_MEE2 &lt;- bd.shifts.optim(times, c(rho, 1, 1), grid, start, end, ME = TRUE, survival = 1) # Activar detección de extinciones masivas\n\n\n\n[[1]]\n[1] 7.002138e+01 3.102841e-07 8.909817e-02\n\n[[2]]\n[1] 6.817460e+01 1.195857e-07 1.246163e-01 3.649862e-01 9.252293e-01\n\n[[3]]\n[1] 6.603778e+01 6.878473e-08 2.676687e-01 7.137593e-02 7.086373e-01\n[6] 9.252293e-01 9.525229e+00\n\n\nInterpretación\n\n\n\n\n\n\n\n\nÍndice\nParámetro estimado\nDescripción\n\n\n\n\n1\n66.03778\nVerosimilitud (log-likelihood)\n\n\n2\n6.878473e-08\nTurnover (\\(\\epsilon\\))\n\n\n3\n0.2676687\nDiversificación (\\(r\\))\n\n\n4\n0.07137593\nEspecies muestreadas antes del evento (\\(\\rho_0\\))\n\n\n5\n0.7086373\nEspecies muestreadas después del evento (\\(\\rho_1\\))\n\n\n6\n0.9252293\nTiempo antes del evento (\\(t_0\\))\n\n\n7\n9.525229\nTiempo después del evento (\\(t_1\\))\n\n\n\nComparación MEE un evento vs MEE dos cambio\n\n## Verosimilitud MEE un evento\nres_MEE[[2]][[2]][1]\n\n[1] 68.1746\n\n## Verosimilitud MEE dos eventos\nres_MEE2[[2]][[3]][1]\n\n[1] 66.03778\n\n\n\nChiSq1 = 2 * (res_MEE[[2]][[2]][1] - res_MEE2[[2]][[3]][1])\nChiSq1\n\n[1] 4.273639\n\ndgf &lt;- 6 - 4\npchiSq1 &lt;- pchisq(ChiSq1, df=dgf)\npchiSq1\n\n[1] 0.8819704\n\n\nInterpretación de los resultados\n\nChi-cuadrado (ChiSq1) = 4.273639\n\nEsto representa cuánto mejor se ajusta el modelo con 2 eventos en comparación con el modelo con 1 evento.\n\nGrados de libertad = 2\n\nSe obtiene de la diferencia en el número de parámetros entre ambos modelos (6 - 4 = 2).\n\np-value = 0.8819704\n\nEl p-valor es alto (\\(&gt;0.05\\)), lo que indica que NO hay evidencia suficiente para preferir el modelo con 2 eventos de extinción sobre el modelo con 1 evento.\nEsto sugiere que el modelo con 1 evento de extinción es suficiente para explicar los datos, y agregar un segundo evento no mejora significativamente el ajuste del modelo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#introducción",
    "href": "chapters/u1_intro_diversification_3.html#introducción",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Introducción",
    "text": "Introducción\nEn este tutorial, aprenderemos a inferir eventos de extinción masiva utilizando un modelo Episodic Fossilized Birth-Death (EFBD) en RevBayes. Siguiendo el tutorial oficial Mass Extinction Estimation.\n\n¿Qué es el modelo de diversificación episódico?\nEl modelo episodic birth-death es un proceso en el que las tasas de especiación, extinción y fosilización son constantes dentro de intervalos de tiempo, pero pueden cambiar entre ellos. En ciertos momentos, este modelo incorpora la posibilidad de que ocurra una extinción masiva, en la que un gran porcentaje de linajes desaparece de manera instantánea con una probabilidad \\(M_i\\).\n\n\nRelación con otros modelos de diversificación\nEste modelo es una extensión del modelo de diversificación con tasas variables en el tiempo, tratado en el tutorial Episodic Diversification Rate Estimation. Además, dado que permite la incorporación de fósiles en la filogenia, es útil revisar los tutoriales de Combined-Evidence Analysis y Fossilized Birth-Death Process for Analysis of Extant Taxa and Fossil Specimens.\n\n\nConsideraciones clave\nPara evitar confundir cambios en las tasas de diversificación con eventos de extinción masiva, este modelo incorpora un Horseshoe Markov Random Field (MRF), el cual permite detectar correctamente los cambios en especiación, extinción y fosilización sin interpretaciones erróneas.\nEste enfoque está basado en la implementación presentada en Magee y Höhna (2021) y nos permitirá explorar cómo la diversidad ha cambiado a lo largo del tiempo y si existen eventos de extinción masiva en nuestra filogenia.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#cálculo-de-valores-necesarios-para-el-análisis",
    "href": "chapters/u1_intro_diversification_3.html#cálculo-de-valores-necesarios-para-el-análisis",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Cálculo de Valores Necesarios para el Análisis",
    "text": "Cálculo de Valores Necesarios para el Análisis\nAntes de definir los priors en nuestro modelo de estimación de extinciones masivas, es importante calcular valores iniciales para las tasas de especiación, extinción y fosilización. Para ello, ejecutaremos un modelo de tasa constante usando el enfoque Fossilized Birth-Death Process (FBDP) en RevBayes.\nEste script permite estimar los valores base para los priors en las tasas de diversificación.\n\nPasos clave del script\n\nLeer los datos filogenéticos desde el archivo subarbol_ingroup.nex.\nDefinir priors iniciales para las tasas de especiación, extinción y fosilización usando una distribución Half-Cauchy(0,0.1).\nConfigurar movimientos del MCMC para optimizar la exploración del espacio de parámetros.\nDefinir el modelo FBDP, donde:\n\nlambda = tasa de especiación\nmu = tasa de extinción\nphi = tasa de fosilización\nPhi = probabilidad de muestreo de especies extantes\n\nEjecutar la inferencia bayesiana (MCMC) para estimar los parámetros.\n\n**Guarda este script como mcmc_CRFBD.Rev y ejecútalo en RevBayes:**\n#######################\n# Lectura de los Datos #\n#######################\n\n# Leer el árbol filogenético \"observado\"\nT &lt;- readTrees(\"../data/subarbol_ingroup.nex\")[1]\n\n# Extraer taxones del árbol\ntaxa &lt;- T.taxa()\n\n# Inicializar vectores de movimientos y monitores\nmoves    = VectorMoves()\nmonitors = VectorMonitors()\n\n##########\n# Priors #\n##########\n\n# Definir priors iniciales con distribución Half-Cauchy(0,0.1)\nspeciation_rate ~ dnHalfCauchy(0.0,0.1)\nmoves.append( mvScaleBactrian(speciation_rate, weight=7.5) )\nmoves.append( mvRandomDive(speciation_rate, weight=2.5) )\n\nextinction_rate ~ dnHalfCauchy(0.0,0.1)\nmoves.append( mvScaleBactrian(extinction_rate, weight=7.5) )\nmoves.append( mvRandomDive(extinction_rate, weight=2.5) )\n\nfossilization_rate ~ dnHalfCauchy(0.0,0.1)\nmoves.append( mvScaleBactrian(fossilization_rate, weight=7.5) )\nmoves.append( mvRandomDive(fossilization_rate, weight=2.5) )\n\n# Agregar un movimiento conjunto para explorar múltiples parámetros simultáneamente\njoint_move = mvAVMVN(weight=10.0)\njoint_move.addVariable(speciation_rate)\njoint_move.addVariable(extinction_rate)\njoint_move.addVariable(fossilization_rate)\nmoves.append( joint_move )\n\n### Probabilidad de muestreo de especies extantes\n# Se fija en 22/26, ya que hay ~26 especies descritas de Eupomphini y se han muestreado 22.\nsampling_at_present &lt;- 22/26\n\n##############\n# Definir el Modelo #\n##############\n\ntimetree ~ dnFBDP(rootAge = T.rootAge(),\n                  lambda = speciation_rate,\n                  mu = extinction_rate,\n                  phi = fossilization_rate,\n                  Phi = sampling_at_present,\n                  condition = \"time\",\n                  taxa = taxa,\n                  initialTre = T)\n\n# Restringir el modelo con el árbol observado\ntimetree.clamp(T)\n\n# Envolver el modelo en un workspace\nmymodel = model(sampling_at_present)\n\n#############\n# Monitores #\n#############\n\n# Guardar los valores de los parámetros en un archivo de salida\nmonitors.append( mnModel(filename=\"../out/eupomphini_CRFBD.log\", printgen=10, separator = TAB) )\nmonitors.append( mnScreen(printgen=1000) )\n\n################\n# Ejecutar el MCMC #\n################\n\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")\n\n# Ejecutar la cadena MCMC con 50,000 generaciones\nmymcmc.run(generations=50000, tuningInterval=200)\n\n# Salir de RevBayes\nq()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#ejecutar-en-r-cálculo-de-priors-y-hiperprior-para-revbayes-con-revgadgets",
    "href": "chapters/u1_intro_diversification_3.html#ejecutar-en-r-cálculo-de-priors-y-hiperprior-para-revbayes-con-revgadgets",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Ejecutar en R: Cálculo de Priors y Hiperprior para RevBayes con RevGadgets",
    "text": "Ejecutar en R: Cálculo de Priors y Hiperprior para RevBayes con RevGadgets\n\n# Cargar la librería RevGadgets\nlibrary(RevGadgets)\n\n# Leer las tasas de diversificación desde el archivo de salida de RevBayes\ndiversification_rates &lt;- readTrace(\"../docs/u1_PatDiv/output/CRFBD/eupomphini_CRFBD.log\", burnin = 0.25)[[1]]\n\n# Ajustar una distribución Gamma a las tasas inferidas\nspeciation_prior &lt;- posteriorSamplesToParametricPrior(diversification_rates$speciation_rate, \"gamma\")\nextinction_prior &lt;- posteriorSamplesToParametricPrior(diversification_rates$extinction_rate, \"gamma\")\nfossilization_prior &lt;- posteriorSamplesToParametricPrior(diversification_rates$fossilization_rate, \"gamma\")\n\n# Imprimir los valores de los parámetros de la distribución Gamma\nprint(speciation_prior)  # [1] -&gt; alpha, [2] -&gt; beta\n\ngamma.shape  gamma.rate \n   10.31672   104.25685 \n\nprint(extinction_prior)  # [1] -&gt; alpha, [2] -&gt; beta\n\ngamma.shape  gamma.rate \n  0.5185615  32.6386155 \n\nprint(fossilization_prior)  # [1] -&gt; alpha, [2] -&gt; beta\n\ngamma.shape  gamma.rate \n  0.5099949 146.6218854 \n\n# Calcular el hiperprior para RevBayes usando HSMRF con 10 intervalos\nhyperprior_value &lt;- setMRFGlobalScaleHyperpriorNShifts(10, \"HSMRF\")\n\n# Imprimir el valor del hiperprior\nprint(hyperprior_value)\n\n[1] 0.04446432",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#código-en-revbayes-para-estimación-de-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#código-en-revbayes-para-estimación-de-extinciones-masivas",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Código en RevBayes para Estimación de Extinciones Masivas",
    "text": "Código en RevBayes para Estimación de Extinciones Masivas\nGuarda este script como mcmc_EFBD_ME.Rev y ejecútalo en RevBayes:",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#lectura-del-árbol",
    "href": "chapters/u1_intro_diversification_3.html#lectura-del-árbol",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Lectura del árbol",
    "text": "Lectura del árbol\nComenzamos cargando el árbol filogenético previamente filtrado.\n# Cargar el árbol filogenético desde un archivo en formato NEXUS\nT &lt;- readTrees(\"../docs/u1_PatDiv/subarbol_ingroup.nex\")[1]\n\n# Extraer la información taxonómica del árbol\n taxa &lt;- T.taxa()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "href": "chapters/u1_intro_diversification_3.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-el-número-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificación.",
    "href": "chapters/u1_intro_diversification_3.html#definir-el-número-de-intervalos-en-los-que-dividiremos-el-tiempo-para-modelar-la-diversificación.",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Definir el número de intervalos en los que dividiremos el tiempo para modelar la diversificación.",
    "text": "Definir el número de intervalos en los que dividiremos el tiempo para modelar la diversificación.\nNUM_INTERVALS = 10  # Número total de intervalos de tiempo\nNUM_BREAKS := NUM_INTERVALS - 1  # Número de puntos de cambio entre intervalos",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#configuración-de-los-intervalos-de-tiempo",
    "href": "chapters/u1_intro_diversification_3.html#configuración-de-los-intervalos-de-tiempo",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Configuración de los Intervalos de Tiempo",
    "text": "Configuración de los Intervalos de Tiempo\nEl modelo Episodic Fossilized Birth-Death asume que los puntos en el tiempo están distribuidos equidistantemente. Para ello, creamos un vector de tiempos que servirá para definir las tasas de especiación, extinción y fosilización, así como para modelar las extinciones masivas.\ninterval_times &lt;- abs(T.rootAge() * seq(1, NUM_BREAKS, 1) / NUM_INTERVALS)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#priors-en-las-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#priors-en-las-extinciones-masivas",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Priors en las Extinciones Masivas",
    "text": "Priors en las Extinciones Masivas\nEl modelo utiliza una mezcla de saltos reversibles (reversible jump mixture model), lo que significa que la inferencia de extinciones masivas se realiza en dos partes:\n\nProbabilidad de que ocurra una extinción masiva en un intervalo de tiempo determinado.\nProbabilidad de que un linaje se extinga en caso de que haya una extinción masiva.\n\nPara establecer un número esperado de extinciones masivas, podemos definir un valor conservador como 1.0:\nexpected_number_of_mass_extinctions &lt;- 1.0\nComo hay NUM_BREAKS posibles puntos de extinción, calculamos la probabilidad de que no ocurra una extinción masiva en un intervalo dado:\n mix_p &lt;- Probability(1.0 - expected_number_of_mass_extinctions / NUM_BREAKS)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-un-prior-para-la-mortalidad-en-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#definir-un-prior-para-la-mortalidad-en-extinciones-masivas",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Definir un Prior para la Mortalidad en Extinciones Masivas",
    "text": "Definir un Prior para la Mortalidad en Extinciones Masivas\nDado que las extinciones masivas suelen eliminar la mayoría de los linajes, utilizamos una distribución Beta(18,2) como prior. Esta distribución tiene:\n\nMedia de 0.9, lo que implica que, en promedio, el 90% de los linajes mueren en una extinción masiva.\nIntervalo de confianza del 95% entre [0.74, 0.987], asegurando que la mayoría de los linajes se extinguen cuando ocurre una extinción masiva.\n\nAhora configuramos el prior para todas las NUM_BREAKS posibles extinciones masivas:\nfor (i in 1:NUM_BREAKS) {\n    mass_extinction_probabilities[i] ~ dnReversibleJumpMixture(0.0, dnBeta(18.0, 2.0), mix_p)\n    moves.append(mvRJSwitch(mass_extinction_probabilities[i]))\n    moves.append(mvSlideBactrian(mass_extinction_probabilities[i]))\n}\n\n¿Qué hace este código?\n✅ dnReversibleJumpMixture(0.0, dnBeta(18.0, 2.0), mix_p)\n\nDefine un modelo en el que cada intervalo de tiempo tiene una probabilidad de albergar una extinción masiva.\nSi hay una extinción masiva, se modela con dnBeta(18.0, 2.0).\nSi no hay extinción, se asigna un valor de 0.0.\n\n✅ Movimientos del MCMC\nPara explorar correctamente los parámetros de extinciones masivas en el análisis MCMC, agregamos:\n\nmvRJSwitch → Determina si hay o no una extinción masiva en un intervalo.\nmvSlideBactrian → Ajusta la probabilidad de muerte en caso de extinción.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#priors-sobre-la-variabilidad-de-las-tasas",
    "href": "chapters/u1_intro_diversification_3.html#priors-sobre-la-variabilidad-de-las-tasas",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Priors sobre la Variabilidad de las Tasas",
    "text": "Priors sobre la Variabilidad de las Tasas\n\nVariabilidad en las Tasas de Especiación, Extinción y Fosilización\nPara modelar la variación en las tasas de diversificación a lo largo del tiempo, utilizamos el Horseshoe Markov Random Field (HSMRF) Birth-Death Model (Magee et al. 2020).\nEste modelo:\n\nPermite que las tasas de diversificación cambien a lo largo del tiempo.\nUsa una distribución Horseshoe (Carvalho et al. 2010) para modelar los cambios en la escala logarítmica.\nAsume que la mayoría de los cambios son pequeños, pero permite saltos grandes en las tasas.\n\n\n\nEscala Global de Variabilidad\nPara controlar la variabilidad general de las tasas de especiación, extinción y fosilización desde el presente hasta el pasado, usamos un parámetro de escala global.\nTambién debemos definir un hiperprior para la escala global, que ayuda a determinar la variabilidad esperada en las tasas. En este caso, usamos el valor 0.044 cuando trabajamos con 10 intervalos de tasa.\nspeciation_rate_global_scale_hyperprior &lt;- 0.044\nextinction_rate_global_scale_hyperprior &lt;- 0.044\nfossilization_rate_global_scale_hyperprior &lt;- 0.044\nNota: Si se usa un número diferente de intervalos, se puede calcular el hiperprior con la función de RevGadgets: setMRFGlobalScaleHyperpriorNShifts(NUM_INTERVALS).\n\n\nDefinir los Priors para las Tasas de Especiación, Extinción y Fosilización\nCada parámetro de escala global se modela con una distribución Half-Cauchy centrada en 0 con parámetro de dispersión 1.\nspeciation_rate_global_scale ~ dnHalfCauchy(0,1)\nextinction_rate_global_scale ~ dnHalfCauchy(0,1)\nfossilization_rate_global_scale ~ dnHalfCauchy(0,1)\n¿Por qué usamos una distribución Half-Cauchy?\n\nFlexible: Permite modelar valores grandes sin restringir excesivamente la variabilidad.\nEvita sesgos: No impone límites arbitrarios a los cambios de tasa.\nAsegura que las tasas sean positivas, ya que la distribución Half-Cauchy solo tiene valores positivos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#especificación-de-las-tasas-episódicas",
    "href": "chapters/u1_intro_diversification_3.html#especificación-de-las-tasas-episódicas",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Especificación de las Tasas Episódicas",
    "text": "Especificación de las Tasas Episódicas\n\nModelado de las Tasas en el Tiempo\nPara modelar las tasas de especiación, extinción y fosilización a lo largo del tiempo, utilizamos distribuciones Horseshoe Markov Random Field (HSMRF) en su escala logarítmica.\nSin embargo, la tasa en el presente debe modelarse de manera distinta porque:\n\nNo está correlacionada con ninguna tasa anterior.\nSe modela hacia atrás en el tiempo en lugar de hacia adelante.\nEsto permite que, si conocemos algún evento que afectó la diversificación en un momento específico (ej. hace 25 millones de años), podamos incorporarlo en el análisis.\n\n\n\nPriorización de la Primera Tasa (Tasa en el Presente)\nDado que el modelo contiene muchos parámetros, utilizamos un enfoque empírico bayesiano (Empirical Bayes Strategy).\n\nPrimero, se ajusta un modelo FBD de tasa constante (Constant-Rate Fossilized Birth-Death).\nLuego, se extrae la distribución posterior de esas tasas y se ajusta un prior Gamma para la tasa en el presente.\nEsto nos permite definir priors más realistas y adaptados a los datos.\n\nEl archivo mcmc_CRFBD.Rev puede ejecutarse para estimar estas distribuciones, y la función de RevGadgets posteriorSamplesToParametricPrior() permite ajustar una distribución a las muestras posteriores.\nspeciation_rate_hyperprior_alpha &lt;- 10.31672 \nspeciation_rate_hyperprior_beta &lt;- 104.25685\nextinction_rate_hyperprior_alpha &lt;- 0.5185615\nextinction_rate_hyperprior_beta &lt;- 32.6386155\nfossilization_rate_hyperprior_alpha &lt;- 0.5099949\nfossilization_rate_hyperprior_beta &lt;- 146.6218854\n\nspeciation_rate_at_present ~ dnGamma(speciation_rate_hyperprior_alpha,speciation_rate_hyperprior_beta)\nextinction_rate_at_present ~ dnGamma(extinction_rate_hyperprior_alpha,extinction_rate_hyperprior_beta)\nfossilization_rate_at_present ~ dnGamma(fossilization_rate_hyperprior_alpha,fossilization_rate_hyperprior_beta)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-movimientos-para-las-tasas-en-el-presente",
    "href": "chapters/u1_intro_diversification_3.html#definir-movimientos-para-las-tasas-en-el-presente",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Definir Movimientos para las Tasas en el Presente",
    "text": "Definir Movimientos para las Tasas en el Presente\nEn este paso, aplicamos una variedad de movimientos para explorar eficientemente los valores para cada tasa en el presente (speciation_rate_at_present, extinction_rate_at_present, fossilization_rate_at_present), aplicamos diferentes tipos de movimientos:\nmoves.append( mvScaleBactrian(speciation_rate_at_present, weight=5) )\nmoves.append( mvScaleBactrian(extinction_rate_at_present, weight=5) )\nmoves.append( mvScaleBactrian(fossilization_rate_at_present, weight=5) )\n\nmoves.append( mvMirrorMultiplier(speciation_rate_at_present, weight=5) )\nmoves.append( mvMirrorMultiplier(extinction_rate_at_present, weight=5) )\nmoves.append( mvMirrorMultiplier(fossilization_rate_at_present, weight=5) )\n\nmoves.append( mvRandomDive(speciation_rate_at_present, weight=5) )\nmoves.append( mvRandomDive(extinction_rate_at_present, weight=5) )\nmoves.append( mvRandomDive(fossilization_rate_at_present, weight=5) )\n\nAplicar Movimientos Conjuntos\nLos parámetros de especiación, extinción y fosilización están correlacionados, por lo que debemos aplicar movimientos conjuntos para evitar sesgos en la inferencia.\navmvn_rates_at_present = mvAVMVN(weight=50)\navmvn_rates_at_present.addVariable(speciation_rate_at_present)\navmvn_rates_at_present.addVariable(extinction_rate_at_present)\navmvn_rates_at_present.addVariable(fossilization_rate_at_present)\nmoves.append( avmvn_rates_at_present )\n\n\nAplicar un Movimiento de Escalado Dependiente (Up-Down Scale)\nPara mantener una relación coherente entre las tasas de especiación y extinción, aplicamos el movimiento de escalado Up-Down:\nup_down_move = mvUpDownScale(weight=5.0)\nup_down_move.addVariable(speciation_rate_at_present, TRUE)\nup_down_move.addVariable(extinction_rate_at_present, TRUE)\nmoves.append( up_down_move )\nResumen\n✅ Se aplican movimientos individuales para explorar cada parámetro por separado.\n✅ Se usan movimientos conjuntos (mvAVMVN) para capturar correlaciones entre tasas.\n✅ Se aplica mvUpDownScale para mantener relaciones biológicamente realistas entre las tasas.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#parametrización-no-centralizada-para-hsmrf",
    "href": "chapters/u1_intro_diversification_3.html#parametrización-no-centralizada-para-hsmrf",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Parametrización No Centralizada para HSMRF",
    "text": "Parametrización No Centralizada para HSMRF\nPara hacer posible el MCMC en el modelo HSMRF, utilizamos una parametrización no centralizada. Esto significa que:\n\nPrimero definimos los cambios en la escala logarítmica de las tasas entre intervalos.\nLuego ensamblamos el vector de tasas, utilizando una combinación de parámetros globales y locales.\nImplementamos adaptabilidad local, permitiendo que algunas tasas varíen rápidamente y otras sean más estables.\n\n\nAsignación de Parámetros de Escala Local\nCada intervalo de tiempo necesita una varianza específica para la distribución Horseshoe, lo que nos permite modelar la adaptabilidad local.\nfor (i in 1:NUM_BREAKS) {\n   # Escala variable para cada intervalo de tiempo\n  sigma_speciation_rate[i] ~ dnHalfCauchy(0,1)\n  sigma_extinction_rate[i] ~ dnHalfCauchy(0,1)\n  sigma_fossilization_rate[i] ~ dnHalfCauchy(0,1)\n\n  # Escala variable para cada intervalo de tiempo\n  sigma_speciation_rate[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_extinction_rate[i].setValue(runif(1,0.005,0.1)[1])\n  sigma_fossilization_rate[i].setValue(runif(1,0.005,0.1)[1])\n\n   # Movimientos para los valores individuales de sigma\n  moves.append( mvScaleBactrian(sigma_speciation_rate[i], weight=5) )\n  moves.append( mvScaleBactrian(sigma_extinction_rate[i], weight=5) )\n  moves.append( mvScaleBactrian(sigma_fossilization_rate[i], weight=5) )\n\n  # Parametrización no centralizada del modelo HSMRF\n  delta_log_speciation_rate[i] ~ dnNormal( mean=0, sd=sigma_speciation_rate[i]*speciation_rate_global_scale*speciation_rate_global_scale_hyperprior )\n  delta_log_extinction_rate[i] ~ dnNormal( mean=0, sd=sigma_extinction_rate[i]*extinction_rate_global_scale*extinction_rate_global_scale_hyperprior )\n  delta_log_fossilization_rate[i] ~ dnNormal( mean=0, sd=sigma_fossilization_rate[i]*fossilization_rate_global_scale*fossilization_rate_global_scale_hyperprior )\n\n  # Inicialización con valores aleatorios entre -0.1 y 0.1\n  delta_log_speciation_rate[i].setValue(runif(1,-0.1,0.1)[1])\n  delta_log_extinction_rate[i].setValue(runif(1,-0.1,0.1)[1])\n  delta_log_fossilization_rate[i].setValue(runif(1,-0.1,0.1)[1])\n \n  # Movimientos para Mejorar la Mezcla en MCMC\n  moves.append( mvSlideBactrian(delta_log_speciation_rate[i], weight=5) )\n  moves.append( mvSlideBactrian(delta_log_extinction_rate[i], weight=5) )\n  moves.append( mvSlideBactrian(delta_log_fossilization_rate[i], weight=5) )\n\n  # aplicamos movimientos de tipo Up-Down para mantener la correlación entre los cambios de tasas\n  delta_up_down_move[i] = mvUpDownSlide(weight=5.0)\n  delta_up_down_move[i].addVariable(delta_log_speciation_rate[i],TRUE)\n  delta_up_down_move[i].addVariable(delta_log_extinction_rate[i],TRUE)\n  moves.append( delta_up_down_move[i] )\n}\nResumen\n✅ Se modelan los cambios en las tasas en la escala logarítmica usando una parametrización no centralizada.\n✅ Se definen parámetros de escala local (sigma), permitiendo que algunas tasas cambien más rápido que otras.\n✅ Se agregan movimientos (moves) para mejorar la mezcla de MCMC y evitar estancamientos en valores subóptimos.\n✅ Se aplican movimientos Up-Down para correlacionar los cambios en especiación y extinción.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#ensamblar-las-tasas-en-el-tiempo",
    "href": "chapters/u1_intro_diversification_3.html#ensamblar-las-tasas-en-el-tiempo",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Ensamblar las Tasas en el Tiempo",
    "text": "Ensamblar las Tasas en el Tiempo\nHasta ahora, hemos definido:\n✅ Tasa en el presente (speciation_rate_at_present, etc.).\n✅ Cambios en la escala logarítmica (delta_log_speciation_rate, etc.).\n✅ Parámetros de escala local y global (sigma_speciation_rate, etc.).\nAhora, ensamblamos estos elementos en vectores de tasas continuas con la función fnassembleContinuousMRF.\nspeciation_rate := fnassembleContinuousMRF(speciation_rate_at_present, delta_log_speciation_rate, initialValueIsLogScale=FALSE, order=1)\nextinction_rate := fnassembleContinuousMRF(extinction_rate_at_present, delta_log_extinction_rate, initialValueIsLogScale=FALSE, order=1)\nfossilization_rate := fnassembleContinuousMRF(fossilization_rate_at_present, delta_log_fossilization_rate, initialValueIsLogScale=FALSE, order=1)\n¿Qué hace fnassembleContinuousMRF?\n\nConvierte la serie de cambios logarítmicos en una tasa continua a lo largo del tiempo.\nUsa la tasa en el presente como punto de partida.\ninitialValueIsLogScale=FALSE → Significa que el primer valor NO está en escala logarítmica.\norder=1 → Indica que las tasas cambian en función de una serie de incrementos.\n\n\nAplicar el Elliptical Slice Sampler\nEl Elliptical Slice Sampling (ESS) es un método eficiente para actualizar parámetros en distribuciones Gaussianas sin rechazos.\n# Aplicar Elliptical Slice Sampling a los cambios logarítmicos\nmoves.append( mvEllipticalSliceSamplingSimple(delta_log_speciation_rate, weight=5, tune=FALSE) )\nmoves.append( mvEllipticalSliceSamplingSimple(delta_log_extinction_rate, weight=5, tune=FALSE) )\nmoves.append( mvEllipticalSliceSamplingSimple(delta_log_fossilization_rate, weight=5, tune=FALSE) )\n\n\nAplicar Gibbs Sampling para Hiperparámetros\nLos hiperparámetros de escala global y local requieren un método de muestreo Gibbs, que permite actualizar grupos de parámetros en función de distribuciones condicionales.\n# Gibbs sampler para las escalas globales y locales\nmoves.append( mvHSRFHyperpriorsGibbs(speciation_rate_global_scale, sigma_speciation_rate, delta_log_speciation_rate, speciation_rate_global_scale_hyperprior, propGlobalOnly=0.75, weight=10) )\nmoves.append( mvHSRFHyperpriorsGibbs(extinction_rate_global_scale, sigma_extinction_rate, delta_log_extinction_rate, extinction_rate_global_scale_hyperprior, propGlobalOnly=0.75, weight=10) )\nmoves.append( mvHSRFHyperpriorsGibbs(fossilization_rate_global_scale, sigma_fossilization_rate, delta_log_fossilization_rate, fossilization_rate_global_scale_hyperprior, propGlobalOnly=0.75, weight=10) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#aplicar-movimientos-de-intercambio-swap-moves",
    "href": "chapters/u1_intro_diversification_3.html#aplicar-movimientos-de-intercambio-swap-moves",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Aplicar Movimientos de Intercambio (Swap Moves)",
    "text": "Aplicar Movimientos de Intercambio (Swap Moves)\nPara mejorar la mezcla del MCMC, permitimos intercambiar valores de delta_log y sigma entre intervalos de tiempo adyacentes.\n# Intercambio de intervalos adyacentes en los cambios logarítmicos y escalas locales\nmoves.append( mvHSRFIntervalSwap(delta_log_speciation_rate, sigma_speciation_rate, weight=5) )\nmoves.append( mvHSRFIntervalSwap(delta_log_extinction_rate, sigma_extinction_rate, weight=5) )\nmoves.append( mvHSRFIntervalSwap(delta_log_fossilization_rate, sigma_fossilization_rate, weight=5) )\nResumen\n✅ Se ensamblan las tasas de diversificación utilizando fnassembleContinuousMRF.\n✅ Se aplica Elliptical Slice Sampling para actualizar los cambios en la escala logarítmica.\n✅ Se usa muestreo Gibbs para mejorar la estimación de los hiperparámetros.\n✅ Se aplican movimientos de intercambio (swap moves) para mejorar la mezcla en MCMC.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#muestreo-incompleto-de-taxones",
    "href": "chapters/u1_intro_diversification_3.html#muestreo-incompleto-de-taxones",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Muestreo Incompleto de Taxones",
    "text": "Muestreo Incompleto de Taxones\nEn estudios de diversificación, es importante considerar el sesgo de muestreo, ya que en muchos casos solo se ha muestreado una parte de las especies vivientes.\nPara este análisis, sabemos que hemos muestreado 22 de 26 especies de Eupomphini vivientes. Por lo tanto, definimos un nodo constante que representa esta proporción:\nsampling_at_present &lt;- 22/26",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-la-edad-de-la-raíz",
    "href": "chapters/u1_intro_diversification_3.html#definir-la-edad-de-la-raíz",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Definir la Edad de la Raíz",
    "text": "Definir la Edad de la Raíz\nEl modelo Fossilized Birth-Death Process (FBDP) necesita un parámetro de edad de la raíz (rootAge).\nDado que usamos un árbol fijo, podemos extraer directamente la edad de la raíz desde el árbol cargado:\nroot_time &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#especificar-el-árbol-temporal",
    "href": "chapters/u1_intro_diversification_3.html#especificar-el-árbol-temporal",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Especificar el Árbol Temporal",
    "text": "Especificar el Árbol Temporal\nCon todos los parámetros listos, podemos definir el nodo estocástico que representa el árbol temporal usando el modelo Episodic Fossilized Birth-Death (dnFBDP):\ntimetree ~ dnFBDP(rootAge = T.rootAge(), timeline = interval_times, lambda = speciation_rate, mu = extinction_rate, phi = fossilization_rate, Mu = mass_extinction_probabilities, Phi = sampling_at_present, condition = \"time\", taxa = taxa, initialTree = T)\n🔹 ¿Qué representa cada parámetro?\n\n\n\n\n\n\n\nParámetro\nDescripción\n\n\n\n\nrootAge\nEdad de la raíz del árbol.\n\n\ntimeline\nDivisión del tiempo en intervalos.\n\n\nlambda\nTasa de especiación (cambiante en el tiempo).\n\n\nmu\nTasa de extinción (cambiante en el tiempo).\n\n\nphi\nTasa de fosilización.\n\n\nMu\nProbabilidad de que ocurra una extinción masiva en cada intervalo.\n\n\nPhi\nProporción de especies muestreadas.\n\n\ncondition=\"time\"\nSe asume que el proceso ocurre en el tiempo (puede cambiarse si queremos condicionar en el muestreo de la raíz).\n\n\ntaxa\nLista de taxones en el análisis.\n\n\ninitialTree\nÁrbol inicial para comenzar la inferencia.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#fijarlo-a-los-datos-observados",
    "href": "chapters/u1_intro_diversification_3.html#fijarlo-a-los-datos-observados",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Fijarlo a los datos observados",
    "text": "Fijarlo a los datos observados\nUna vez que hemos definido el árbol temporal (timetree), debemos fijarlo a los datos observados. Esto significa que no estamos infiriendo la filogenia, sino que usamos un árbol previamente estimado.\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#definir-el-modelo-completo",
    "href": "chapters/u1_intro_diversification_3.html#definir-el-modelo-completo",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Definir el Modelo Completo",
    "text": "Definir el Modelo Completo\nAhora encapsulamos todo el modelo dentro de un objeto de workspace, lo que permite a RevBayes reconocer todas las variables y relaciones definidas.\nmymodel = model(speciation_rate)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#configurar-los-monitores",
    "href": "chapters/u1_intro_diversification_3.html#configurar-los-monitores",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Configurar los Monitores",
    "text": "Configurar los Monitores\nLos monitores en RevBayes permiten registrar el estado de los parámetros durante la ejecución del MCMC.\nDefinimos varios tipos de monitores:\n1️⃣ Monitor principal (mnModel): Guarda el estado de todos los parámetros del modelo.\n2️⃣ Monitores de archivo (mnFile): Almacenan parámetros específicos en archivos separados para facilitar el análisis posterior.\n3️⃣ Monitor de pantalla (mnScreen): Muestra valores clave en la consola durante la ejecución.\n\nMonitor Principal\nEste monitor guarda todas las variables del modelo en un solo archivo. Se ejecutará cada 10 generaciones.\nmonitors.append( mnModel(filename=\"output/eupomphini_EFBDME.log\", printgen=10, separator=TAB) )\n\n\nMonitores de Archivo para Parámetros Específicos\nPara visualizar mejor los resultados, registramos las tasas de especiación, extinción, fosilización y extinción masiva en archivos separados.\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_speciation_rates.log\", printgen=10, separator=TAB, speciation_rate) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_speciation_rate_times.log\", printgen=10, separator=TAB, interval_times) )\n\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_extinction_rates.log\", printgen=10, separator=TAB, extinction_rate) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_extinction_rate_times.log\", printgen=10, separator=TAB, interval_times) )\n\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_fossilization_rates.log\", printgen=10, separator=TAB, fossilization_rate) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_fossilization_rate_times.log\", printgen=10, separator=TAB, interval_times) )\n\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_mass_extinction_probabilities.log\", printgen=10, separator=TAB, mass_extinction_probabilities) )\nmonitors.append( mnFile(filename=\"output/eupomphini_EFBDME_mass_extinction_times.log\", printgen=10, separator=TAB, interval_times) )\n\n\nMonitor de Consola\nEste monitor muestra valores clave en pantalla cada 1000 generaciones, permitiendo hacer un seguimiento del MCMC en tiempo real.\nmonitors.append( mnScreen(printgen=1000, speciation_rate_global_scale, extinction_rate_global_scale, fossilization_rate_global_scale) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#inicializar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_3.html#inicializar-y-ejecutar-el-mcmc",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Inicializar y Ejecutar el MCMC",
    "text": "Inicializar y Ejecutar el MCMC\nCon el modelo y los monitores listos, creamos el objeto MCMC e iniciamos la simulación.\nmymcmc = mcmc(mymodel, monitors, moves, nruns=2, combine=\"mixed\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_3.html#ejecutar-el-mcmc",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=30000, tuningInterval=200)\n¿Qué significa esto?\n\nCorre 30,000 generaciones, con más generaciones puede tomar varias horas dependiendo del hardware.\ntuningInterval=200 ajusta los movimientos cada 200 iteraciones para mejorar la eficiencia.\nSi el MCMC tarda demasiado, puedes probar con menos generaciones (100,000 o 50,000) y revisar si los parámetros convergen antes de ejecutar una corrida más larga.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#evaluar-el-soporte-para-extinciones-masivas",
    "href": "chapters/u1_intro_diversification_3.html#evaluar-el-soporte-para-extinciones-masivas",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "Evaluar el Soporte para Extinciones Masivas",
    "text": "Evaluar el Soporte para Extinciones Masivas\nUna vez finalizada la ejecución del MCMC, los archivos de salida contienen las muestras de la distribución posterior.\n📌 Objetivo: Evaluar qué tan fuertemente respaldada está la hipótesis de que ocurrieron eventos de extinción masivaen ciertos intervalos de tiempo.\n🔹 ¿Cómo lo hacemos?\n\nExaminamos la probabilidad posterior de cada evento de extinción masiva.\nCalculamos factores de Bayes para determinar si hay soporte significativo.\nVisualizamos los resultados con RevGadgets en R.\n\nAnálisis en R con RevGadgets\nEjecuta este código en R:\n\n# Cargar la librería\nlibrary(RevGadgets)\n\n# Leer las probabilidades de extinción masiva desde el archivo de salida\nmass_extinction_probabilities &lt;- readTrace(\"../docs/u1_PatDiv/output/CRFBD/eupomphini_EFBDME_mass_extinction_probabilities.log\", burnin = 0.25)\n\n# Establecer la probabilidad a priori de una extinción masiva en cualquier tiempo\nprior_n_expected &lt;- 0.1  # Número esperado de eventos de extinción masiva\nn_intervals &lt;- 10       # Número de intervalos de tiempo en el modelo\nprior_prob &lt;- prior_n_expected / (n_intervals - 1)\n\n# Definir los tiempos en los que se permitieron eventos de extinción masiva\ntree_age &lt;- 19.5829128  # Edad del árbol en millones de años\ninterval_times &lt;- tree_age * seq(1/n_intervals, (n_intervals-1)/n_intervals, 1/n_intervals)\n\n# Graficar los resultados\np &lt;- plotMassExtinctions(\n  mass_extinction_trace = mass_extinction_probabilities,\n  mass_extinction_times = interval_times,\n  mass_extinction_name = \"mass_extinction_probabilities\",\n  prior_prob = prior_prob\n)\n\np",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_3.html#qué-significa-el-factor-de-bayes",
    "href": "chapters/u1_intro_diversification_3.html#qué-significa-el-factor-de-bayes",
    "title": "Estimación de Eventos de Extinción Masiva",
    "section": "¿Qué significa el Factor de Bayes?",
    "text": "¿Qué significa el Factor de Bayes?\nEl Factor de Bayes (BF) compara dos modelos:\n\nHipótesis Nula (H₀): No hubo un evento de extinción masiva en un intervalo de tiempo.\nHipótesis Alternativa (H₁): Sí hubo un evento de extinción masiva en ese intervalo.\n\nEl log(Bayes Factor) se calcula como:\n\\(2log(BF)\\) = \\(2(logP(D|H_1)- logP(D|H_0))\\)\nDonde:\n\n\\(P(D|H_1)\\) es la probabilidad de los datos asumiendo que hubo una extinción masiva.\n\\(P(D|H_0)\\) es la probabilidad de los datos asumiendo que no hubo una extinción masiva.\n\nUn 2 log BF ≥ 10 indica fuerte evidencia a favor de una extinción masiva en ese tiempo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Estimación de Eventos de Extinción Masiva</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html",
    "href": "chapters/u1_intro_diversification_4.html",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "",
    "text": "Presentación: Introducción a modelos State Speciaction-Extinción (SSE)\nHaz clic en la imagen para ver el PDF de la presentación\nAnalizaremos si las tasas de diversificación están asociadas al tipo de hospedero en los escarabajos meloidos (Meloidae). Las subfamilias Nemognathinae y Meloinae presentan un ciclo de vida complejo, caracterizado por múltiples metamorfosis y estrategias de parasitoidismo. La mayoría de los géneros y tribus dentro de estas subfamilias son parasitoides de abejas, incluyendo especies foréticas y no foréticas. Sin embargo, dos tribus han adoptado una estrategia distinta, alimentándose de huevos de saltamontes. Estas diferencias en las estrategias de vida están asociadas con marcadas variaciones en la riqueza de especies entre clados (López-Estrada et al., 2019).",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#descarga-del-árbol-filogenético-y-la-matriz-codificada",
    "href": "chapters/u1_intro_diversification_4.html#descarga-del-árbol-filogenético-y-la-matriz-codificada",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Descarga del Árbol Filogenético y la matriz codificada",
    "text": "Descarga del Árbol Filogenético y la matriz codificada\n📥 Puedes descargar el archivo .tre con el árbol en el siguiente enlace:\n📥 Descargar Árbol Filogenético\n📥 Puedes descargar el archivo .nex con la matriz codificada en el siguiente enlace:\n📥 Descargar Matriz Codificada\nGuarda los archivos en la carpeta correspondiente y verifica su ubicación antes de continuar.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos",
    "href": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Carga de la filogenia y los datos",
    "text": "Carga de la filogenia y los datos\nCrea un script .Rev y copia el codigo de la siguiente sección:\n# Leer el arbol\nT &lt;- readTrees(\"../data/ConLyttini.tre\")[1]\n\n# Leer la matriz de caracteres\ndatos &lt;- readCharacterData(\"../data/Traits_conLyttini_01.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-número-de-estados-en-los-modelos-bisse",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-número-de-estados-en-los-modelos-bisse",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir el número de estados en los modelos BISSE",
    "text": "Definir el número de estados en los modelos BISSE\nNUM_STATES = 2",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "href": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#valores-de-la-log-normal",
    "href": "chapters/u1_intro_diversification_4.html#valores-de-la-log-normal",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Valores de la log-normal",
    "text": "Valores de la log-normal\nDe acuerdo con Nee et al. (1994) el número esperado de linajes en la corona de un clado con n taxones bajo un proceso de nacimiento y muerte en el tiempo t es:\n\\((\\lambda - \\mu) = \\frac{In(n)/2}{t}\\)\nEn donde: n = es el número de especies y t = es la edad de la filogenia\n# Definimos una a priori log normal\nrate_mean &lt;- ln(ln(3000.0/2.0) / T.rootAge())\n\n# Con una varianza que es amplia\nrate_sd &lt;- 0.587405\n\nfor (i in 1:NUM_STATES) {\n# lognormales de las especiaciones\n  log_speciation[i] ~ dnNormal(mean=rate_mean, sd=rate_sd) \n  speciation[i] := exp(log_speciation[i])\n  moves.append(mvSlide(log_speciation[i], delta=0.20, tune=true, weight=3.0))\n\n# lognormales de las extinciones\n  log_extinction[i] ~ dnNormal(mean=rate_mean, sd=rate_sd)  \n  extinction[i] := exp(log_extinction[i])\n  moves.append(mvSlide(log_extinction[i], delta=0.20, tune=true, weight=3.0))\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-tasas-de-transición-entre-los-estados-del-carácter",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-tasas-de-transición-entre-los-estados-del-carácter",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la matriz de tasas de transición entre los estados del carácter",
    "text": "Definir la matriz de tasas de transición entre los estados del carácter\n# Calcula la suma de todas las longitudes de las ramas del árbol filogenético\n# Dividido por 10: Esto asume que en promedio ocurren 10 cambios de estado a lo largo del árbol\nrate_pr := T.treeLength() / 10",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definición-de-las-tasas-de-transición",
    "href": "chapters/u1_intro_diversification_4.html#definición-de-las-tasas-de-transición",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definición de las tasas de transición",
    "text": "Definición de las tasas de transición\n# Tasa de transición de estado 1 → estado 2 \nrate_12 ~ dnExp(rate_pr)\n\n# Tasa de transición de estado 2 → estado 1 \nrate_21 ~ dnExp(rate_pr)\n\n# Definición de movimientos \nmoves.append(mvScale(rate_12, weight=2))\nmoves.append(mvScale(rate_21, weight=2))\n¿Por qué usar una exponencial?\n\nLa distribución exponencial es adecuada para modelar tasas de transición porque impone la condición de que siempre sean positivas.\nTambién asigna mayor probabilidad a valores pequeños, lo que significa que los cambios de estado no ocurren demasiado rápido.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#creación-de-la-matriz-de-tasas-de-transición",
    "href": "chapters/u1_intro_diversification_4.html#creación-de-la-matriz-de-tasas-de-transición",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Creación de la matriz de tasas de transición",
    "text": "Creación de la matriz de tasas de transición\nrate_matrix := fnFreeBinary([rate_12, rate_21 ], rescaled=false)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#frecuencias-del-estado-en-la-raíz",
    "href": "chapters/u1_intro_diversification_4.html#frecuencias-del-estado-en-la-raíz",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Frecuencias del estado en la raíz",
    "text": "Frecuencias del estado en la raíz\nrate_category_prior ~ dnDirichlet(rep(1,NUM_STATES))\nmoves.append(mvDirichletSimplex(rate_category_prior, tune=true, weight=2))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#fijar-la-edad-de-la-raíz",
    "href": "chapters/u1_intro_diversification_4.html#fijar-la-edad-de-la-raíz",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Fijar la edad de la raíz",
    "text": "Fijar la edad de la raíz\nroot &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-rho-proporción-de-especies-muestreadas",
    "href": "chapters/u1_intro_diversification_4.html#definir-rho-proporción-de-especies-muestreadas",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir \\(\\rho\\) : Proporción de especies muestreadas",
    "text": "Definir \\(\\rho\\) : Proporción de especies muestreadas\nrho &lt;- T.ntips()/3000",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#construcción-del-árbol-evolutivo-generado-a-partir-de-un-proceso-de-nacimiento-y-muerte-dependiente-del-carácter",
    "href": "chapters/u1_intro_diversification_4.html#construcción-del-árbol-evolutivo-generado-a-partir-de-un-proceso-de-nacimiento-y-muerte-dependiente-del-carácter",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Construcción del árbol evolutivo generado a partir de un proceso de nacimiento y muerte dependiente del carácter",
    "text": "Construcción del árbol evolutivo generado a partir de un proceso de nacimiento y muerte dependiente del carácter\ntimetree ~ dnCDBDP(rootAge = root, speciationRates = speciation, extinctionRates = extinction, Q = rate_matrix, pi = rate_category_prior, delta = 1.0, rho = rho, condition = \"time\")\n🔹 Parámetros del proceso de nacimiento y muerte (dnCDBDP):\n\nrootAge = root → Se fija la edad de la raíz usando root = T.rootAge().\nspeciationRates = speciation → Se usa la tasa de especiación (λ).\nextinctionRates = extinction → Se usa la tasa de extinción (μ).\nQ = rate_matrix → Usa la matriz de tasas de transición de caracteres (rate_12, rate_21).\npi = rate_category_prior → Usa la distribución a priori de los estados en la raíz.\ndelta = 1.0 → Parámetro de ajuste para la distribución de tiempos de especiación/extinción.\nrho = rho → Probabilidad de muestreo de especies (rho = T.ntips()/3000).\ncondition = \"time\" → Condiciona el proceso a un tiempo de raíz fijo.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#fijar-clamp-los-datos-observados",
    "href": "chapters/u1_intro_diversification_4.html#fijar-clamp-los-datos-observados",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Fijar (clamp) los datos observados",
    "text": "Fijar (clamp) los datos observados\ntimetree.clamp(T)\ntimetree.clampCharData(datos)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#creación-del-modelo",
    "href": "chapters/u1_intro_diversification_4.html#creación-del-modelo",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Creación del modelo",
    "text": "Creación del modelo\n### workspace model wrapper ###\nmymodel = model(rate_matrix)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#configuración-de-los-monitores",
    "href": "chapters/u1_intro_diversification_4.html#configuración-de-los-monitores",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Configuración de los monitores",
    "text": "Configuración de los monitores\nLos monitores guardan los resultados en archivos o los imprimen en pantalla.\nmonitors.append(mnModel(filename=\"../out/Bisse/mitos_BiSSE_clyttini.log\", printgen=1))\nmonitors.append(mnJointConditionalAncestralState(tree=timetree, cdbdp=timetree, type=\"Standard\", printgen=1, withTips=true, withStartStates=false, filename=\"../out/Bisse/anc_states_MITOS_BiSSE_clyttini.log\"))\nmonitors.append(mnStochasticCharacterMap(cdbdp=timetree, printgen=10, filename=\".../out/Bisse/SCHM_BiSSE_clyttini.log\"))\nmonitors.append(mnScreen(printgen=10, rate_12, rate_21, speciation, extinction))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#inicializar-y-ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#inicializar-y-ejecutar-el-mcmc",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Inicializar y Ejecutar el MCMC",
    "text": "Inicializar y Ejecutar el MCMC\nCon el modelo y los monitores listos, creamos el objeto MCMC e iniciamos la simulación.\nmymcmc = mcmc(mymodel, monitors, moves, nruns=1, moveschedule=\"random\")\n\nmymodel: hace referencia al modelo que estás analizando.\nmonitors: son las variables que se registrarán en el archivo de salida.\nmoves: operadores MCMC que proponen cambios en los parámetros del modelo.\nnruns=1: solo una cadena MCMC (puedes usar más si deseas una inferencia más robusta).\nmoveschedule=\"random\": ejecuta los operadores en orden aleatorio para evitar sesgos en la exploración del espacio de parámetros.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=40000)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#generar-un-árbol-anotado-con-los-estados-ancestrales-map",
    "href": "chapters/u1_intro_diversification_4.html#generar-un-árbol-anotado-con-los-estados-ancestrales-map",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Generar un árbol anotado con los estados ancestrales (MAP)",
    "text": "Generar un árbol anotado con los estados ancestrales (MAP)\nanc_states = readAncestralStateTrace(\"../out/Bisse/anc_states_MITOS_BiSSE_clyttini.log\")\n\nanc_tree = ancestralStateTree(tree=T, ancestral_state_trace_vector=anc_states, include_start_states=false, file=\"../out/Bisse/mitos_bisse_anc_states_results.tree\", burnin=0.2, summary_statistic=\"MAP\", site=1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#generar-un-mapeo-estocástico-de-caracteres-stochastic-character-mapping",
    "href": "chapters/u1_intro_diversification_4.html#generar-un-mapeo-estocástico-de-caracteres-stochastic-character-mapping",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Generar un mapeo estocástico de caracteres (Stochastic Character Mapping)",
    "text": "Generar un mapeo estocástico de caracteres (Stochastic Character Mapping)\nanc_state_trace = readAncestralStateTrace(\"../out/Bisse/SCHM_BiSSE_clyttini.log\")\n\ncharacterMapTree(tree=T, ancestral_state_trace_vector=anc_state_trace, character_file=\"../out/Bisse/mitos_bisse_stoch_map_character.tree\", posterior_file=\"../out/Bisse/mitos_bisse_stoch_map_posterior.tree\", burnin=0.2, reconstruction=\"marginal\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#visualización-en-r-con-revgadgets",
    "href": "chapters/u1_intro_diversification_4.html#visualización-en-r-con-revgadgets",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Visualización en R con RevGadgets",
    "text": "Visualización en R con RevGadgets\n\nlibrary(tidyverse)\nlibrary(RevGadgets)\n\n# Cargar el archivo de estados ancestrales\nbisse_file &lt;- paste0(\"../docs/u1_PatDiv/output/bisse/mitos_bisse_anc_states_results.tree\")\np_anc &lt;- processAncStates(bisse_file)\n\n\n  |                                              \n  |                                        |   0%\n  |                                              \n  |========================================| 100%\n\n# Definir paleta de colores personalizada\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\")  # Rojo para estado 0, azul para estado 1\n\n# Generar el gráfico con estados ancestrales\nplot &lt;- plotAncStatesMAP(p_anc,\n        tree_layout = \"rect\",\n        tip_labels_size = 1) +\n        # Aplicar la paleta de colores\n        scale_color_manual(values = traitcols) +\n        scale_fill_manual(values = traitcols) +\n        # Modificar leyenda y otros elementos de ggplot2\n        theme(legend.position = c(0.1, 0.85),\n              legend.key.size = unit(0.3, 'cm'), # Tamaño de la clave de la leyenda\n              legend.title = element_text(size = 6), # Tamaño del título de la leyenda\n              legend.text = element_text(size = 4))  # Tamaño del texto de la leyenda\n\n# Mostrar el gráfico\nplot",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-transición",
    "href": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-transición",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar las tasas de transición",
    "text": "Graficar las tasas de transición\n\nlibrary(tidyverse)\n\n# Leer el archivo de salida de RevBayes\nbisse &lt;- read.table(\"../docs/u1_PatDiv/output/bisse/mitos_BiSSE_clyttini.log\", header = TRUE)\n\n# Definir colores para los estados 0 y 1\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\")  \n\n# Crear un dataframe con solo las tasas de transición\ntransition_rates &lt;- data.frame(\n  dens = c(bisse$rate_12, bisse$rate_21), \n  rate = rep(c(\"0\", \"1\"), each = length(bisse$rate_12))\n)\n\n# Crear un gráfico de violín para las tasas de transición\nviolin_transitions &lt;- ggplot(transition_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Transición\", x = \"Estado\", y = \"Tasa\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_transitions",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificación-neta",
    "href": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificación-neta",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar las tasas de diversificación neta",
    "text": "Graficar las tasas de diversificación neta\n\n# Calcular la tasa de diversificación neta: especiación - extinción\nnetdiversification_rates &lt;- data.frame(\n  dens = c(bisse$speciation.1. - bisse$extinction.1.,\n           bisse$speciation.2. - bisse$extinction.2.),\n  rate = rep(c(\"0\", \"1\"), each = length(bisse$speciation.1.))\n)\n\n# Convertir la variable de estado en factor\nnetdiversification_rates$rate &lt;- factor(netdiversification_rates$rate, levels = c(\"0\", \"1\"))\n\n# Crear el gráfico de violín para tasas de diversificación neta\nviolin_diversification &lt;- ggplot(netdiversification_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Diversificación Neta\", x = \"Estado\", y = \"Tasa\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_diversification",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiación",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiación",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar tasas de especiación",
    "text": "Graficar tasas de especiación\n\n# Crear un dataframe con tasas de especiación para cada estado\nspeciation_rates &lt;- data.frame(\n  dens = c(bisse$speciation.1.,  bisse$speciation.2.), \n  rate = rep(c(\"0\", \"1\"), each = length(bisse$speciation.1.))\n)\n\n# Crear gráfico de violín para las tasas de especiación\nviolin_speciation &lt;- ggplot(speciation_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Especiación\", x = \"Estado\", y = \"Tasa de Especiación\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_speciation",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinción",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinción",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar tasas de extinción",
    "text": "Graficar tasas de extinción\n\n# Crear un dataframe con tasas de extinción para cada estado\nextinction_rates &lt;- data.frame(\n  dens = c(bisse$extinction.1., bisse$extinction.2.), \n  rate = rep(c(\"0\", \"1\"), each = length(bisse$extinction.1.))\n)\n\n# Crear gráfico de violín para tasas de extinción\nviolin_extinction &lt;- ggplot(extinction_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Extinción\", x = \"Estado\", y = \"Tasa de Extinción\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_extinction",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos-1",
    "href": "chapters/u1_intro_diversification_4.html#carga-de-la-filogenia-y-los-datos-1",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Carga de la filogenia y los datos",
    "text": "Carga de la filogenia y los datos\nCrea un script .Rev y copia el codigo de la siguiente sección:\n# Leer el arbol\nT &lt;- readTrees(\"../data/ConLyttini.tre\")[1]\n\n# Leer la matriz de caracteres\ndatos &lt;- readCharacterData(\"../data/Traits_conLyttini_01.nex\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-número-de-estados-en-los-modelos-hisse-y-paremetros-globales",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-número-de-estados-en-los-modelos-hisse-y-paremetros-globales",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir el número de estados en los modelos HISSE y paremetros globales",
    "text": "Definir el número de estados en los modelos HISSE y paremetros globales\nNUM_TOTAL_SPECIES     = 3000.0\nNUM_STATES            = 2\nNUM_HIDDEN            = 2\nNUM_RATES             = NUM_STATES * NUM_HIDDEN\nH                     = 0.587405\n# Expansión de los Datos para Incluir Estados Ocultos \ndata_exp &lt;- datos.expandCharacters(NUM_HIDDEN)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.-1",
    "href": "chapters/u1_intro_diversification_4.html#definir-vectores-para-almacenar-los-movimientos-de-mcmc-y-los-monitores-de-resultados.-1",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.",
    "text": "Definir vectores para almacenar los movimientos de MCMC y los monitores de resultados.\nmoves    = VectorMoves()\nmonitors = VectorMonitors()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#extraer-información-del-árbol-filogenético",
    "href": "chapters/u1_intro_diversification_4.html#extraer-información-del-árbol-filogenético",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Extraer información del árbol filogenético",
    "text": "Extraer información del árbol filogenético\ntaxa &lt;- T.taxa()\ntree_length &lt;- T.treeLength()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-media-de-las-tasas-de-especiación-y-extinción",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-media-de-las-tasas-de-especiación-y-extinción",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Media de las Tasas de Especiación y Extinción",
    "text": "Definir la Media de las Tasas de Especiación y Extinción\nrate_mean &lt;- (NUM_TOTAL_SPECIES - 2) / tree_length\n✅ Calcula la media esperada de las tasas de especiación y extinción basada en el número total de especies y la longitud del árbol.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#especiación-y-extinción-oculta-hidden-speciation-rates",
    "href": "chapters/u1_intro_diversification_4.html#especiación-y-extinción-oculta-hidden-speciation-rates",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Especiación y Extinción Oculta (Hidden Speciation Rates)",
    "text": "Especiación y Extinción Oculta (Hidden Speciation Rates)\nln_speciation_hidden_mean &lt;- ln(1.0)\nln_extinction_hidden_mean &lt;- ln(1.0)\n✅ Define la media logarítmica de las tasas ocultas de especiación como 1.0 en una escala relativa. ✔️ Esto significa que los valores generados serán proporcionales, y no absolutos.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#variación-en-las-tasas-ocultas-de-especiación-y-extinción",
    "href": "chapters/u1_intro_diversification_4.html#variación-en-las-tasas-ocultas-de-especiación-y-extinción",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Variación en las Tasas Ocultas de Especiación y Extinción",
    "text": "Variación en las Tasas Ocultas de Especiación y Extinción\nspeciation_hidden_sd ~ dnExponential(1.0 / H)\nextinction_hidden_sd ~ dnExponential(1.0 / H)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#movimiento-mcmc-para-optimizar-la-desviación-estándar",
    "href": "chapters/u1_intro_diversification_4.html#movimiento-mcmc-para-optimizar-la-desviación-estándar",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Movimiento MCMC para Optimizar la Desviación Estándar",
    "text": "Movimiento MCMC para Optimizar la Desviación Estándar\nmoves.append(mvScale(speciation_hidden_sd, lambda=1, tune=true, weight=2.0))\nmoves.append(mvScale(extinction_hidden_sd, lambda=1, tune=true, weight=2.0))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-distribución-de-las-tasas-ocultas",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-distribución-de-las-tasas-ocultas",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Distribución de las Tasas Ocultas",
    "text": "Definir la Distribución de las Tasas Ocultas\nspeciation_hidden_unormalized := fnDiscretizeDistribution(dnLognormal(ln_speciation_hidden_mean, speciation_hidden_sd), NUM_HIDDEN)\nextinction_hidden_unormalized := fnDiscretizeDistribution(dnLognormal(ln_extinction_hidden_mean, extinction_hidden_sd), NUM_HIDDEN)\n✅ Se genera un conjunto de tasas ocultas de especiación a partir de una distribución lognormal.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#normalización-de-las-tasas-ocultas",
    "href": "chapters/u1_intro_diversification_4.html#normalización-de-las-tasas-ocultas",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Normalización de las Tasas Ocultas",
    "text": "Normalización de las Tasas Ocultas\nspeciation_hidden := speciation_hidden_unormalized / mean(speciation_hidden_unormalized)\nextinction_hidden := extinction_hidden_unormalized / mean(extinction_hidden_unormalized)\n✅ Se normalizan las tasas ocultas dividiéndolas por su media, para que el promedio sea 1.0. ✔️ Esto garantiza que los valores sean relativos y comparables entre estados.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-tasas-de-especiación-para-estados-observables",
    "href": "chapters/u1_intro_diversification_4.html#definir-tasas-de-especiación-para-estados-observables",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir Tasas de Especiación para Estados Observables",
    "text": "Definir Tasas de Especiación para Estados Observables\nfor (i in 1:NUM_STATES) {\n    speciation_observed[i] ~ dnLoguniform( 1E-6, 1E2)\n    speciation_observed[i].setValue( (NUM_TOTAL_SPECIES-2) / tree_length )\n    moves.append( mvScale(speciation_observed[i], lambda=1.0, tune=true, weight=3.0) )\n        ### Create a loguniform distributed variable for the extinction rate\n    extinction_observed[i] ~ dnLoguniform( 1E-6, 1E2)\n    extinction_observed[i].setValue( speciation_observed[i] / 10.0 )\n    moves.append( mvScale(extinction_observed[i], lambda=1.0, tune=true, weight=3.0) )\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#cálculo-de-las-tasas-combinadas",
    "href": "chapters/u1_intro_diversification_4.html#cálculo-de-las-tasas-combinadas",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Cálculo de las Tasas Combinadas",
    "text": "Cálculo de las Tasas Combinadas\nfor (j in 1:NUM_HIDDEN) {\n    for (i in 1:NUM_STATES) {\n        index = i+(j*NUM_STATES)-NUM_STATES\n        speciation[index] := speciation_observed[i] * speciation_hidden[j]\n        extinction[index] := extinction_observed[i] * extinction_hidden[j]\n    }\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transición-entre-estados-observables",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transición-entre-estados-observables",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Matriz de Transición entre Estados Observables",
    "text": "Definir la Matriz de Transición entre Estados Observables\nrate_pr := T.treeLength() / 10\nfor ( i in 1:(NUM_STATES*(NUM_STATES-1)) ) {\n    transition_rates[i] ~ dnExp(rate_pr)\n    moves.append( mvScale(transition_rates[i], lambda=0.50, tune=true, weight=3.0) )\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transición-entre-estados-ocultos",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-matriz-de-transición-entre-estados-ocultos",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Matriz de Transición entre Estados Ocultos",
    "text": "Definir la Matriz de Transición entre Estados Ocultos\nhidden_rate ~ dnExponential(rate_pr)\nmoves.append( mvScale(hidden_rate, lambda=0.5, tune=true, weight=5) )\nfor (i in 1:(NUM_HIDDEN * (NUM_HIDDEN - 1))) {\n    R[i] := hidden_rate\n}",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#crear-la-matriz-de-transición-q-combinada",
    "href": "chapters/u1_intro_diversification_4.html#crear-la-matriz-de-transición-q-combinada",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Crear la Matriz de Transición Q Combinada",
    "text": "Crear la Matriz de Transición Q Combinada\nrate_matrix := fnHiddenStateRateMatrix(transition_rates, R, rescaled=false)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-distribución-de-los-estados-en-la-raíz",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-distribución-de-los-estados-en-la-raíz",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Distribución de los Estados en la Raíz",
    "text": "Definir la Distribución de los Estados en la Raíz\nrate_category_prior ~ dnDirichlet( rep(1,NUM_RATES) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#optimización-con-movimientos-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#optimización-con-movimientos-mcmc",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Optimización con Movimientos MCMC",
    "text": "Optimización con Movimientos MCMC\nmoves.append( mvBetaSimplex(rate_category_prior, tune=true, weight=2) )\nmoves.append( mvDirichletSimplex(rate_category_prior, tune=true, weight=2) )",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-edad-de-la-raíz-del-árbol",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-edad-de-la-raíz-del-árbol",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Edad de la Raíz del Árbol",
    "text": "Definir la Edad de la Raíz del Árbol\nroot &lt;- T.rootAge()",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-la-probabilidad-de-muestreo-de-especies-rho",
    "href": "chapters/u1_intro_diversification_4.html#definir-la-probabilidad-de-muestreo-de-especies-rho",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir la Probabilidad de Muestreo de Especies (\\(\\rho\\))",
    "text": "Definir la Probabilidad de Muestreo de Especies (\\(\\rho\\))\nrho &lt;- T.ntips()/3000.0",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-árbol-bajo-un-proceso-de-diversificación-dependiente-del-estado",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-árbol-bajo-un-proceso-de-diversificación-dependiente-del-estado",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir el Árbol Bajo un Proceso de Diversificación Dependiente del Estado",
    "text": "Definir el Árbol Bajo un Proceso de Diversificación Dependiente del Estado\ntimetree ~ dnCDBDP( rootAge = root, speciationRates = speciation, extinctionRates = extinction, Q = rate_matrix, delta = 1.0, pi = rate_category_prior, rho = rho, condition = \"survival\")\n✔️ Parámetros clave:\n\nrootAge = root → La edad de la raíz se fija a la edad del árbol observado.\nspeciationRates = speciation → Tasas de especiación combinadas (λ), que incluyen efectos de los estados ocultos.\nextinctionRates = extinction → Tasas de extinción combinadas (μ), modeladas de la misma manera.\nQ = rate_matrix → Matriz de tasas de transición entre estados (0A ↔︎ 1A, 0B ↔︎ 1B, etc.).\ndelta = 1.0 → Modelo estándar en el que las tasas de diversificación dependen completamente del estado.\npi = rate_category_prior → Prior de las probabilidades de estado en la raíz.\nrho = rho → Ajuste por sesgo de muestreo de especies.\ncondition = \"survival\" → Se modela solo en árboles que han sobrevivido hasta el presente.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-la-filogenia-observada",
    "href": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-la-filogenia-observada",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Ajustar el Modelo a la Filogenia Observada",
    "text": "Ajustar el Modelo a la Filogenia Observada\ntimetree.clamp(T)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-los-datos-de-caracteres",
    "href": "chapters/u1_intro_diversification_4.html#ajustar-el-modelo-a-los-datos-de-caracteres",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Ajustar el Modelo a los Datos de Caracteres",
    "text": "Ajustar el Modelo a los Datos de Caracteres\ntimetree.clampCharData(data_exp)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-el-modelo-en-revbayes",
    "href": "chapters/u1_intro_diversification_4.html#definir-el-modelo-en-revbayes",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir el Modelo en RevBayes",
    "text": "Definir el Modelo en RevBayes\nmymodel = model(rate_matrix)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#configurar-monitores-para-guardar-resultados",
    "href": "chapters/u1_intro_diversification_4.html#configurar-monitores-para-guardar-resultados",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Configurar Monitores para Guardar Resultados",
    "text": "Configurar Monitores para Guardar Resultados\n# Monitor Principal del Modelo\nmonitors.append( mnModel(filename=\"../out/Hisse/mitos_HiSSE_clyttini_TUTscript.log\", printgen=1) )\n\n# Monitor de Estados Ancestrales\nmonitors.append(mnJointConditionalAncestralState(tree=timetree, cdbdp=timetree, type=\"NaturalNumbers\", printgen=1, withTips=true, withStartStates=false, filename=\"../out/Hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.log\"))\n\n# Monitor de Mapeo Estocástico de Caracteres\nmonitors.append(mnStochasticCharacterMap(cdbdp=timetree, printgen=10, filename=\"../out/Hisse/stoch_char_map_mitos_HiSSE_clyttini_TUTscript.log\", include_simmap=true))\n\n# Monitor en Pantalla\nmonitors.append(mnScreen(printgen=10, speciation_observed, extinction_observed))",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#configurar-el-algoritmo-mcmc",
    "href": "chapters/u1_intro_diversification_4.html#configurar-el-algoritmo-mcmc",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Configurar el Algoritmo MCMC",
    "text": "Configurar el Algoritmo MCMC\n### workspace mcmc\nmymcmc = mcmc(mymodel, monitors, moves, nruns=1, moveschedule=\"random\", combine=\"mixed\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc-1",
    "href": "chapters/u1_intro_diversification_4.html#ejecutar-el-mcmc-1",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Ejecutar el MCMC",
    "text": "Ejecutar el MCMC\nmymcmc.run(generations=400)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#cargar-la-trazabilidad-de-los-estados-ancestrales",
    "href": "chapters/u1_intro_diversification_4.html#cargar-la-trazabilidad-de-los-estados-ancestrales",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Cargar la Trazabilidad de los Estados Ancestrales",
    "text": "Cargar la Trazabilidad de los Estados Ancestrales\nanc_states2 = readAncestralStateTrace(\"../out/Hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.log\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#construcción-del-árbol-con-estados-ancestrales",
    "href": "chapters/u1_intro_diversification_4.html#construcción-del-árbol-con-estados-ancestrales",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Construcción del Árbol con Estados Ancestrales",
    "text": "Construcción del Árbol con Estados Ancestrales\nanc_tree = ancestralStateTree(tree=T, ancestral_state_trace_vector = anc_states2, include_start_states=false, file = \"../out/Hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.tree\", burnin = 2, summary_statistic = \"MAP\", site=1)",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#definir-parámetros-para-la-resumir-estados-ancestrales",
    "href": "chapters/u1_intro_diversification_4.html#definir-parámetros-para-la-resumir-estados-ancestrales",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Definir Parámetros para la Resumir Estados Ancestrales",
    "text": "Definir Parámetros para la Resumir Estados Ancestrales\nburnin=10\nn_time_slices = 500\n✅ burnin = 25 → Descarta las primeras 25 iteraciones del MCMC antes de hacer el resumen.\n✅ n_time_slices = 500 → Divide el árbol en 500 segmentos de tiempo para interpolar los cambios de estado.",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#leer-la-historia-del-carácter-inferida-por-mapeo-estocástico",
    "href": "chapters/u1_intro_diversification_4.html#leer-la-historia-del-carácter-inferida-por-mapeo-estocástico",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Leer la Historia del Carácter Inferida por Mapeo Estocástico",
    "text": "Leer la Historia del Carácter Inferida por Mapeo Estocástico\nanc_states_SCHM = readAncestralStateTrace(\"../out/Hisse/stoch_char_map_mitos_HiSSE_clyttini_TUTscript.log\")",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#crear-el-árbol-de-mapeo-estocástico-de-caracteres",
    "href": "chapters/u1_intro_diversification_4.html#crear-el-árbol-de-mapeo-estocástico-de-caracteres",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Crear el Árbol de Mapeo Estocástico de Caracteres",
    "text": "Crear el Árbol de Mapeo Estocástico de Caracteres\nchar_map_tree = characterMapTree(tree=T, \n                 ancestral_state_trace_vector=anc_states_SCHM, \n                 character_file=\"../out/Hisse/stoch_mitos_HiSSE_clyttini_TUTscriptmarginal_char.tree\", \n                 posterior_file=\"../out/Hisse/stoch_mitos_HiSSE_clyttini_TUTscriptmarginal_post.tree\", \n                 burnin=burnin, \n                 num_time_slices=n_time_slices)\n\n# Cargar el archivo de estados ancestrales\nhisse_file &lt;- paste0(\"../docs/u1_PatDiv/output/hisse/anc_states_mitos_HiSSE_clyttini_TUTscript.tree\")\n\np_anc_hisse &lt;- processAncStates(hisse_file)\n\n\n  |                                              \n  |                                        |   0%\n  |                                              \n  |========================================| 100%\n\n# Definir paleta de colores personalizada\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\", \"red\", \"blue\")  # Rojo para estado 0, azul para estado 1\n\n# Generar el gráfico con estados ancestrales\nplot_hisse &lt;- plotAncStatesMAP(p_anc_hisse,\n        tree_layout = \"rect\",\n        tip_labels_size = 1) +\n        # Aplicar la paleta de colores\n        scale_color_manual(values = traitcols) +\n        scale_fill_manual(values = traitcols) +\n        # Modificar leyenda y otros elementos de ggplot2\n        theme(legend.position = c(0.1, 0.85),\n              legend.key.size = unit(0.3, 'cm'), # Tamaño de la clave de la leyenda\n              legend.title = element_text(size = 6), # Tamaño del título de la leyenda\n              legend.text = element_text(size = 4))  # Tamaño del texto de la leyenda\n\n# Mostrar el gráfico\nplot_hisse",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificación-neta-1",
    "href": "chapters/u1_intro_diversification_4.html#graficar-las-tasas-de-diversificación-neta-1",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar las tasas de diversificación neta",
    "text": "Graficar las tasas de diversificación neta\n\n# Leer el archivo de salida de RevBayes\nhisse &lt;- read.table(\"../docs/u1_PatDiv/output/hisse/mitos_HiSSE_clyttini_TUTscript.log\", header = TRUE)\n\n# Definir paleta de colores personalizada\ntraitcols &lt;- c(\"#F29494\", \"#5FD9D9\", \"red\", \"blue\")  # Rojo para estado 0, azul para estado 1\n\n# Calcular la tasa de diversificación neta: especiación - extinción\nnetdiversification_rates &lt;- data.frame(\n  dens = c(hisse$speciation_observed.1. - hisse$extinction_observed.1.,\n           hisse$speciation_observed.2. - hisse$extinction_observed.2.,\n           hisse$speciation_hidden.1. - hisse$extinction_hidden.1.,\n           hisse$speciation_hidden.2. - hisse$extinction_hidden.2.),\n  rate = rep(c(\"0A\", \"1A\", \"0B\", \"1B\"), each = length(hisse$speciation_observed.1.))\n  )\n\n# Convertir la variable de estado en factor\nnetdiversification_rates$rate &lt;- factor(netdiversification_rates$rate, levels = c(\"0A\", \"1A\", \"0B\", \"1B\"))\n\n# Crear el gráfico de violín para tasas de diversificación neta\nviolin_diversification &lt;- ggplot(netdiversification_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Diversificación Neta\", x = \"Estado\", y = \"Tasa\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_diversification",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiación-1",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-especiación-1",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar tasas de especiación",
    "text": "Graficar tasas de especiación\n\n# Crear un dataframe con tasas de especiación para cada estado\nspeciation_rates &lt;- data.frame(\n  dens = c(hisse$speciation_observed.1.,  hisse$speciation_observed.2.,\n           hisse$speciation_hidden.1., hisse$speciation_hidden.2.), \n  rate = rep(c(\"0A\", \"1A\", \"0B\", \"1B\"), each = length(hisse$speciation_observed.1.))\n)\n\n# Crear gráfico de violín para las tasas de especiación\nviolin_speciation &lt;- ggplot(speciation_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Especiación\", x = \"Estado\", y = \"Tasa de Especiación\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_speciation",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  },
  {
    "objectID": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinción-1",
    "href": "chapters/u1_intro_diversification_4.html#graficar-tasas-de-extinción-1",
    "title": "Introducción a modelos State Speciaction-Extinción (SSE)",
    "section": "Graficar tasas de extinción",
    "text": "Graficar tasas de extinción\n\n# Crear un dataframe con tasas de extinción para cada estado\nextinction_rates &lt;- data.frame(\n  dens = c(hisse$extinction_observed.1., hisse$extinction_observed.2.,\n           hisse$extinction_hidden.1., hisse$extinction_hidden.2.), \n  rate = rep(c(\"0A\", \"1A\", \"0B\", \"1B\"), each = length(hisse$extinction_observed.1.))\n)\n\n# Crear gráfico de violín para tasas de extinción\nviolin_extinction &lt;- ggplot(extinction_rates, aes(x = rate, y = dens, fill = rate)) +\n  geom_violin(trim = FALSE) +\n  labs(title = \"Tasas de Extinción\", x = \"Estado\", y = \"Tasa de Extinción\") +\n  scale_fill_manual(name = \"Estado\", values = traitcols) +\n  theme_classic()\n\n# Mostrar la gráfica\nviolin_extinction",
    "crumbs": [
      "Unidad 1: Patrones de diversificación",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Introducción a modelos State Speciaction-Extinción (SSE)</span>"
    ]
  }
]